text,label
This file extracts credentials from LSASS similar to Mimikatz.,T1003.001
"It calls OpenProcess on lsass.exe with access flag set to VM_READ, and looks for the modules wdigest.dll and lsasrv.dll loaded in the lsass.exe process.",T1003.001
SMB copy and remote execution,T1570
This thread is then used to execute the SMB copy and remote execution,T1570
SMB copy and remote execution,T1570
SMB Copy and Remote Execution,T1570
The malware decompresses its resource named,T1140
The malware decompresses a resource,T1140
This is used as an integrity check for the decryption process.,T1140
"decrypt the MFT,",T1140
the code attempts to decrypt the contents,T1140
"Once the sector is decrypted,",T1140
and the same key is used to decrypt the MFT.,T1140
"is also decoded, and placed back",T1140
its resource section are decompressed and written to disk,T1140
The malware is a DLL that is launched using rundll32.exe:,T1218.011
being invoked by rundll32.exe.,T1218.011
Command Line Execution,T1059.003
Once the command line arguments are generated,T1059.003
The malware also spawns cmd.exe to execute the following command,T1059.003
that hashes each running process on the system,T1057
Process Hashes and Process Privilege Checks,T1057
to track which of the 3 processes are running on the system.,T1057
compares each hash with 3 hardcoded hashes: 0x6403527E → avp.exe associated with Kaspersky AV 0x23214B44 → ns.exe associated with Norton Security 0x651B3005 → ccSvcHst.exe associated with Symantec,T1518.001
using the API NtRaiseHardError,T1106
invokes the following API’s:,T1106
GetExtendedTcpTable to retrieve a list of TCP endpoints GetIpNetTable to retrieve,T1106
NetServerEnum to get a list,T1106
NetServerGetInfoto retrieve the current configuration,T1106
CreateFile and WriteFile are used,T1106
"CreateProcessAsUser or CreateProcess is executed,",T1106
Calls CryptEncrypt,T1106
it also invokes the API NTRaiseHardError.,T1106
undocumented Windows API that causes,T1106
"If the API fails to execute, the malware calls InitiateSystemShutdownExW",T1106
NetServerGetInfoto retrieve the current configuration for the local server,T1082
Obtains the IP address from the ClientIpAddress field,T1016
There are two approaches to using valid credentials to copy and execute the malware to a remote host:,T1078
is used to connect to a server using the default credentials,T1078
WMIC,T1047
C:\Windows\system32\wbem\wmic.exe /node,T1047
encodes it using XOR encoding with key,T1027
contains the original MBR that was encoded by XORing,T1027
which were previously encrypted,T1027
the original encoded MBR,T1027
"obtain keystrokes, and status of keyboard buffer",T1056.001
The malware only targets fixed drives on the system.,T1083
The malware will first start enumerating files in the directory it is being executed from.,T1083
the scheduled task is set to trigger 60 minutes after the malware execution by default.,T1053.005
the scheduled task will trigger 30 minutes after the malware execution.,T1053.005
Explanation of schtask parameters,T1053.005
taskrun. Path and filename of the task to be run,T1053.005
"For instance, immediately after execution, it loads itself in memory, and deletes itself from the disk.",T1027
delete important files,T1070.004
the configuration file will be deleted,T1070.004
threat actors use Themida packer to obfuscate the signature used for detection.,T1027
packed by noted tools,T1027
Themida-packed,T1027
upload/download file,T1105
remote she will functions.,T1059.003
"It supports proxy (Socks5),",T1090
with SOCKS v5 server,T1090
used to dump information from the victim’s Oracle database.,T1005
an information stealer used to harvest internal information.,T1005
Obfuscated PowerShell script,T1027
multi-layer obfuscation,T1027
to obfuscate their tools,T1027
have adopted more obfuscation techniques,T1027
Heavily obfuscated PowerShell script,T1027
the encrypted payload,T1027
the encrypted payload,T1027
to obfuscate control flow of program.,T1027
Heavy obfuscation in a simple but useful anti-analysis approach makes it difficult for security products to detect their scripts.,T1027
threat actors use multi-layered AES encryption and base64 encoding to obfuscate,T1027
obfuscate the execution flow of the program,T1027
the decryption algorithm,T1140
decrypted with RC4 algorithm,T1140
usage of a highly similar decryption algorithm,T1140
to decrypt the payload,T1140
decrypt it,T1140
the decryption function into RC4,T1140
they always have used DLL sideloading as their major technique to launch their malware.,T1574.002
adopted DLL sideloading techniques to run their malware.,T1574.002
used DLL sideloading to launch their malware,T1574.002
"The malicious DLL “gtn.dll”, which we named as “ShellFang”, loads when a legitimate executable is launched.",T1574.002
including API hashing and execution flow obfuscation through exception mechanism,T1027
Windows APIs are obfuscated via a hashing function and dynamically resolved in the run-time.,T1027
Necessary APIs will be dynamically resolved during execution.,T1027
"API obfuscation, and execution flow obfuscation",T1027
abusing exception mechanisms to obfuscate the execution flow of programs and Windows API hashing.,T1027
the final payload is an HTTPs Cobalt Strike beacon.,T1071.001
by creating immediate tasks through GPO.,T1484.001
abused group policy objects (GPO) to install loaders,T1484.001
Propagation through GPO,T1484.001
they will submit immediate tasks to the hosts in the domain through GPO,T1484.001
As the hosts receive the task through GPO,T1484.001
"usually compile all necessary libraries in a single binary, making malware classification more difficult for analysts and resulting in a large binary",T1027
"Once the victim opens the document,",T1204.002
injecting the shellcode into rundll32.exe,T1055
Shellcode which is used for code injection,T1055
proxy,T1090
create scheduled tasks for persistence.,T1053.005
to create a ImmediateTask,T1053.005
Windows API,T1106
Windows APIs,T1106
backdoor is a basic remote she will,T1059.003
C:\Windows\System32\cmd.exe /c,T1059.003
forcing its component SmadAVprotect32.exe to side-load their malicious DLL.,T1574.002
the malware starts a function called bypassSMADAV,T1106
with the API function IsWindowVisible.,T1106
by IsWindowVisible function,T1106
calling the RegisterClass function prior to calling CreateWindow.,T1106
"Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.",T1106
the malware creates 2 scheduled tasks,T1053.005
schtasks /Create /TN test /SC MINUTE /MO 15 /TR,T1053.005
"the malware creates a scheduled task to execute its copy from this randomized path: schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\users\public\8NaZrCq3pGeDRXKF.zip\8NaZr.exe"" /f",T1053.005
"The final payload returned is a lightweight PowerShell backdoor,",T1105
It then picks one random C&C URL out of the three available and constructs a GET request,T1071.001
sends them back to the server in POST request:,T1071.001
After the validation of the JSON and Base64 decoding,T1140
used by various actors to disable endpoint protection tools.,T1562.001
techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.,T1055
The current system username,T1033
The current username home folder,T1033
"The system’s network interfaces (name, MacAddress, description)",T1082
was deployed using DLL side-loading,T1574.002
"due to DLL side-loading, the loader/injector winutils.dll is loaded into memory and runs in the context",T1574.002
abused to side-load,T1574.002
Packed Rorschach loader and injector,T1027
the initial loader/injector winutils.dll is protected with UPX-style packing,T1027
"After unpacking, the sample loads",T1027
decrypted and injected,T1140
and decrypts config,T1140
"injected into notepad.exe, where the ransomware logic begins.",T1055
is injected into notepad.exe,T1055
"Disable the Windows firewall, using netsh.exe",T1562.001
"When executed on a Windows Domain Controller (DC), the ransomware automatically creates a Group Policy, spreading itself to other machines within the domain.",T1484.001
creates a group policy,T1484.001
creates another group policy,T1484.001
creates another group policy,T1484.001
deletes them from the original location.,T1070.004
creating a schedule task,T1053.005
"that registers a scheduled task which runs immediately and upon user logon,",T1053.005
"finds the relevant syscall numbers for NT APIs,",T1106
with the syscall instruction,T1106
the malware first creates a syscall table for NT APIs,T1106
Creation of syscall table for certain NT APIs.,T1106
It makes direct system calls using the “syscall” instruction.,T1106
Example use of direct syscall.,T1106
It uses GetSystemDefaultUILanguage and GetUserDefaultUILanguage to,T1106
The WinAPI CryptGenRandom is utilized,T1106
"is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation,",T1106
Command Line Arguments,T1059.003
the list of processes,T1057
code is protected and obfuscated,T1027
This obfuscated process,T1027
"reusing multiple code chunks from DEP-allowed memory pages, called ROP gadgets.",T1055
"ROP-based attacks execute “RET” instructions without a prior “CALL” instruction, the running thread’s stack and the shadow stack values mismatch",T1055
"call other vfgadgets that are responsible for executing specific operations, like Argument LoadersInvokers and Collectors.",T1055
"Collectors are gadgets that retrieve a value already present in a register, and save it back into the attacker’s counterfeit object",T1055
leaked the stack pointer and retrieved the this pointer as a static offset from the stack.,T1055
"vfgadget address,",T1055
prepare the address of the Windows API we want to invoke along with its arguments.,T1106
the Windows API address and its arguments.,T1106
"invoke any API we like,",T1106
"began sending spam emails, mailing new malicious attachments to continue spreading.",T1566.001
discover commands using the Windows utilities systeminfo,T1082
systeminfo,T1082
systeminfo,T1082
ipconfig,T1016
ipconfig /all,T1016
ipconfig /all,T1016
"Remote access tools were used for command and control, such as Tactical RMM and Anydesk.",T1219
"the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.",T1219
the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.,T1219
the threat actors proceeded to deploy several remote management tools across the environment.,T1219
Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.,T1219
"the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.",T1219
used by the threat actor for the remote management of Tactical RMM Agent.,T1219
Using this RMM agent they proceeded to install AnyDesk on the host.,T1219
Tactical RMM Agent was installed by the threat actor on a server to ensure remote access,T1219
"The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands",T1204.002
"The Powershell script, when double clicked (executed),",T1204.002
they also used tasklist,T1057
"Next, they proceeded to transfer a beacon executable over SMB to the remote host’s ProgramData directory.",T1570
"The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers",T1570
rasomware deployment to all hosts over SMB.,T1570
files transferred via SMB as SYSTEM on remote hosts.,T1570
an executable Cobalt Strike beacon was copied via SMB to a target machine,T1570
This beacon was then successfully executed via WMI,T1047
then executed via WMI.,T1047
wmic,T1047
setup a Registry Run Key to maintain persistence on the beachhead host.,T1547.001
established persistence via a run key.,T1547.001
commands to download an Emotet DLL onto the computer.,T1105
the threat actors dropped Powertool64.exe and dontsleep.exe in preparation for their final actions.,T1105
the threat actors then dropped SoftPerfect’s Network Scanner,T1105
dropped and executed on the server,T1105
"Windows net commands were run,",T1059.003
threat actors proceeded to run the net commands,T1059.003
"the threat actors conducted further discovery tasks running find.bat and p.bat,",T1059.003
and a batch file 1.bat were dropped on the host and the batch file was executed,T1059.003
two batch files were run.,T1059.003
The first find.bat was used to run,T1059.003
C:\Windows\System32\cmd.exe /c,T1059.003
cmd.exe /c start,T1059.003
the threat actor executed a batch script,T1059.003
They then proceeded to dump credentials from the LSASS process on the host.,T1003.001
the ‘mimikatz’ string in the Netlogon event that is used by the Mimikatz Zerologon implementation.,T1003.001
"Process access to LSASS was observed, likely to dump credentials",T1003.001
The Granted Access level matches know indicators for Mimikatz,T1003.001
"request access level of 0x0040 (64) to LSASS, as well indicating other credential access tools may have been in use by the threat actor.",T1003.001
With some further process injection,T1055
The threat actor was observed process injecting into legitimate process,T1055
from a process that was injected with Cobalt Strike.,T1055
Injected Process Name,T1055
the processes used for injection,T1055
"The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread",T1055
from an injected process,T1055
A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.,T1078
"After choosing a new server and connecting via RDP,",T1021.001
"From there, the threat actors began connecting to other hosts via RDP, including the a backup server.",T1021.001
did RDP to a few other servers,T1021.001
traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement,T1021.001
They started by connecting to a new server via RDP,T1021.001
"Once establishing the RDP connection, they deployed Powertool64.exe,",T1021.001
The threat actor kept the remote desktop session alive,T1021.001
to execute encoded scripts.,T1027
The script will decode itself,T1140
The decoded base 64 content,T1140
is a Base64 encoded script with various components split into different variables for obfuscation purposes.,T1027
A service was also created for the agent.,T1543.003
service was installed in the system,T1543.003
svcService Type: user mode serviceService Start Type: auto startService Account: LocalSystem,T1543.003
a separate service was created for that agent.,T1543.003
service was installed in the system,T1543.003
service was installed in the system,T1543.003
--serviceService Type: user mode serviceService Start Type: auto startService Account: LocalSystem,T1543.003
Service Type: user mode serviceService Start Type: auto startService Account: LocalSystem,T1543.003
The threat actor was observed creating remote services,T1543.003
"This occurred from rundll32.exe, which was previously used to execute and run Cobalt Strike.",T1218.011
"C:\Windows\System32\cmd.exe /c rundll32.exe C:\ProgramData\x86.dll, StartA",T1218.011
delete its process file,T1070.004
delete the driver files.,T1070.004
removing files from the system.,T1070.004
The threat actor was observed deleting files that had been dropped to disk,T1027
whoami /groups,T1033
The threat actor was observed creating remote services in order to execute beacon DLL files,T1569.002
the threat actors began to review sensitive documents,T1005
Both HTTP and HTTPS were observed to be used.,T1071.001
Infected email attachments,T1566.001
"obtaining relevant device data, such as OS version and architecture, hardware ID, CPU, RAM, screen resolution, system language, etc.",T1082
"collects information, primarily system information",T1082
can take away system,T1082
exfiltrate files and extract data from specific applications.,T1005
"acquire browsing histories, Internet cookies, usernames/passwords, personally identifiable details, credit card numbers, and other highly sensitive information from browsers.",T1005
target stored browser data,T1005
collects sensitive information from the victim’s machine,T1005
"collects cookie information, search histories, and key inputs from browsers",T1005
collect inside of the “Web Data” SQLite file,T1005
sensitive data from the victim’s machine.,T1005
"usernames/passwords,",T1078
include saved credentials,T1078
run under the name “tmp.exe” by unpacking itself to the “C:\Users\admin\AppData\Local\Temp\” file path.,T1036.005
Registry Key Sets,T1112
transmits information as a zip file,T1041
sends this information to its C2 server,T1041
C2 is transmitted as a zip file during the POST request.,T1041
transferred to the C2 server as a zip file.,T1041
transfers them to the C2 address,T1041
"many obfuscated strings that are being covered by a random string, “edx765“, to evade detection.",T1027
"obfuscated information,",T1027
passes the obfuscated string to a function that strips the arbitrary string and delivers the original string,T1140
passes the obfuscated string to a function that strips the arbitrary string and delivers the original string.,T1027
"Making a ‘POST’ request,",T1071.001
multiple POST requests to the “c2/sock” address,T1071.001
accessed C2 while visiting port 80,T1071.001
they are instructed to click “Confirm” to view a message from “Express.”,T1204.002
"The user is also asked to permit push notifications in the browser,",T1204.002
"Once decrypted, the configuration file reveals several parameters,",T1140
Decryption exclusion list,T1140
decrypted using the RC4 algorithm with a hard-coded key in the resource.,T1140
send the decryption program,T1140
and decrypted,T1140
decrypted using the RC4 algorithm with a hardcoded key in the resource.,T1140
the hardcoded key to decrypt the configuration file.,T1140
to decrypt the configuration file.,T1140
Get configuration file and decrypt it,T1140
Decryptor download,T1140
The decryptor is delivered in a zip archive containing the decryptor executable,T1140
the decryptor to clean up their environment.,T1140
"At the end of the decryption process, the program indicates the number of decrypted files",T1140
Decryptor has finished the decryption process,T1140
Decryptor execution,T1140
"The decryptor program appears unique and is linked to one victim specifically. In our example, it only decrypts the files",T1140
"one to get information about the machine, such as the operating system version,",T1082
one to get processes,T1057
"reflective DLL loading, to inject a DLL from memory.",T1055
Use Windows API functions to inject DLL,T1055
a regular Bitmap (open matrix image format used by Windows) that can be used by malware to execute code or as a payload dropper,T1027
The image’s pixels are an actual binary representation of the payload.,T1027
This process can be summarized as Exe -> Resources -> BMP with embedded data in pixels fetched,T1027
The unpacked malware,T1027
the configuration file encrypted.,T1027
PowerShell Script uses Base64 and hexadecimal encoding and XOR-encryption,T1027
". The malware will try first to write in the registry-hive “HKEY_LOCAL_MACHINE” but if it cannot create it, it will use the registry-hive “HKEY_CURRENT_USER”:",T1112
Write in the registry,T1112
After the writing in the registry has been completed,T1112
write in the registry information,T1112
Create its own registry key in \SOFTWARE\<uniquename>,T1112
using the functions “SHGetFolderPathlW” and “CreateFileW”,T1106
with the function “WriteFile”.,T1106
Use Windows API functions,T1106
The batch script will delete the malware sample with its path using the command “del” and finally delete the bat file with the command “del %0%”.,T1070.004
the malware uses the “del” command,T1070.004
the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers,T1070.004
deletes the ransom note,T1070.004
The batch script,T1059.003
The download is done directly from the NetWalker Tor site,T1105
they will be able to download the decryptor,T1105
Place a value on RunOnce key,T1547.001
"performing password spray,",T1110
Activity from a password-spray associated IP address.,T1110
an IP address that had been identified as participating in password spray,T1110
credential stuffing attacks,T1110
is distributed through exposed Remote Desktop Protocol (RDP) setups,T1021.001
a heavy emphasis on Remote Desktop Protocols.,T1021.001
by brute-forcing them,T1110
"using other known vulnerabilities for initial access, i.e. vulnerabilities in Citrix gateway devices",T1190
"uses other tools to gather credentials that include Mimikatz, LaZagne, and NirSoft’s NetPass.",T1003.001
It uses bat files,T1059.003
A batch file to stop services,T1059.003
the stolen credentials are used to reach high-value machines like servers,T1078
WMIC /node,T1047
reg add HKLM\software\Microsoft\Windows\CurrentVersion\Policies\System,T1112
makes use of API GetTickCount / QueryPerformanceCounter,T1106
the help of ShellExecute API,T1106
delete itself from the target systems after infection,T1027
It also drops and installs,T1105
sets the following registry entry to open the downloaded PDF file every time the computer boots,T1547.001
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\iXqrVo,T1547.001
taking command line arguments,T1059.003
command line argument,T1059.003
to download and execute a remote “note.hta”:,T1105
to download another remote file,T1105
the download and execution,T1105
uses PowerShell to pull and run,T1105
downloading and executing,T1105
downloads and runs,T1105
downloads and executes,T1105
downloads and executes,T1105
downloads and executes,T1105
downloads and executes,T1105
downloads and executes,T1105
the download of wed.hta,T1105
"disables AMSI by hijacking the COM server, changing it from ""%windir%\system32\amsi.dll"" to ""C:\IDontExist.dll"".",T1562.001
performs the following actions to alter Windows Defender settings,T1562.001
Adds the following exclusions to Windows DefenderExtensions,T1562.001
Allows known Windows Defender Threat IDs to execute,T1562.001
Disables Windows Defender Attack Surface Reduction (ASR) rules,T1562.001
Disables the following Windows Defender features:Intrusion Prevention System IO AV Protection (does not scan downloaded files and attachments) Realtime monitoring Script scanning Controlled folder access protection PUA protection Scheduled scan,T1562.001
Sets Network Protection to audit mode in Windows Defender,T1562.001
Disables MAPS (Microsoft Active Protection Service) reporting,T1562.001
Allows severe/high/moderate/low-level threats to execute,T1562.001
"Disables the ""administrator in Admin Approval Mode"" user type (disables UAC prompts)",T1562.001
Stops the WinDefend service (Windows Defender),T1562.001
Disables the startup of the WinDefend service,T1562.001
Deletes the WinDefend service,T1562.001
Stops the Microsoft Defender Antivirus Network Inspection Service (WdNisSvc),T1562.001
designed to hamper Windows Defender,T1562.001
to fool potential victims into opening them.,T1204.002
users still need to manually mount them and run the fake PDFs to trigger the infection chain,T1204.002
Manually executing the lnk file triggers,T1204.002
Manual interactions are required,T1204.002
a lot of junk code,T1027
keylogging,T1056.001
taking screenshots,T1113
to load a binary into memory that injects,T1055
can modify group policy for privilege escalation and defense evasion,T1484.001
can modify group policy for privilege escalation and defense evasion.,T1484.001
Attempts to delete malicious batch files.,T1070.004
makes modifications to the Registry.,T1112
"adds a custom icon to the registry,",T1112
modifies the registry,T1112
creating a registry key HKCU\Control Panel\Desktop,T1112
Disables Windows Defender with batch scripts,T1562.001
with batch scripts,T1059.003
Uses batch scripts,T1059.003
the command line argument,T1059.003
uses Mimikatz to dump passwords.,T1003.001
Uses GetComputerName to query the computer name.,T1082
has used RDP for lateral movement.,T1021.001
has installed and used legitimate tools such as TeamViewer and AnyConnect on targeted systems.,T1219
"iterate through the entire file system,",T1083
Victims receive spear phishing emails with attached malicious zip files,T1566.001
encoded PowerShell scripts,T1027
scripts to download additional scripts.,T1105
Creates benign-looking services for the ransomware binary.,T1543.003
Creates benign-looking services for the ransomware binary.,T1543.003
Lists internal IP addresses,T1016
has installed and used PsExec to execute payloads on remote hosts.,T1569.002
Malicious actors typically gain entry to organizations’ Microsoft 365 environments by abusing either stolen account credentials,T1078
malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.,T1078
Actor signs in to a Microsoft 365 account from an endpoint,T1078
malicious actor signing in to a Microsoft 365 account,T1078
which the actor took after logging in to a user’s Microsoft 365 account,T1078
a malicious actor was observed signing in to a Microsoft 365 account,T1078
began with an actor signing into an internal user’s Microsoft 365 account from a VPN,T1078
a spoof of the legitimate ‘PerfectData’ software designed to masquerade a malicious application as legitimate,T1036.005
brute-force activity,T1110
The emails included an attachment named ‘Credit Transfer Copy.html’,T1566.001
"capable of modifying Windows UAC prompt, disabling Windows Defender notifications, disabling Task Manager, disabling command prompt, preventing users from accessing Windows registry tools, disabling the Run command, and modifying the display timeout",T1562.001
performing antivirus tampering,T1562.001
the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts,T1562.001
"Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout",T1562.001
threat actor(s) made sure to add more paths and folders to Windows Defender exclusion including %TEMP% and C:\Windows\* as well as adding .ps1 (PowerShell) extension to the exclusion list.,T1562.001
"Disabling Windows Defender notifications, Task Manager and Command Prompt",T1562.001
recursively removes the implementation of Windows Defender IOfficeAntiVirus,T1562.001
It then adds the extensions such as exe and DLL as exclusions to Windows Defender.,T1562.001
performs the antivirus checks,T1518.001
The script checks the host against the list of antiviruses,T1518.001
antivirus check script,T1518.001
to download the malicious update.bat file from the C2 domain,T1105
has the capability of sending additional payloads to the hosts,T1105
pulling additional BatLoader payloads and scripts from C2,T1105
retrieves the same files from the C2,T1105
"executing scripts and commands retrieved from C2 such as ps1, bat, vbs, and exe",T1105
the script retrieves the Cobalt Strike payload,T1105
retrieves and executes the runanddelete.bat and scripttodo.ps1 scripts from the C2,T1105
then the full set of malware is retrieved from C2,T1105
retrieving malware from C2,T1105
The batch file was executed,T1059.003
the batch file to run,T1059.003
the batch file,T1059.003
The batch file,T1059.003
The batch script,T1059.003
cmd /C,T1059.003
cmd /c,T1059.003
cmd /c,T1059.003
the username,T1033
using the username,T1033
username,T1033
"obtains all entries within the IPs starting with 192., 10., and .172 in the ARP cache table",T1016
it then checks the amount of IPs found in the ARP table,T1016
ARP table,T1016
the GPG-encrypted files:,T1027
the encrypted data,T1027
the encrypted strings reside within the function,T1027
The data stored in the BSS section is encoded,T1027
the encoded data in the BSS section,T1027
on the API calls QueryPerformanceFrequency and QueryPerformanceCounter,T1106
from API call GetSystemTimeAsFileTime,T1106
using the API,T1106
The traffic beaconing contains the following pattern that will be encrypted with the AES key extracted from the compressed blob,T1573.001
the encrypted with AES-128 beacon,T1573.001
OS version and system type,T1082
computer name,T1082
computer name,T1082
screenshot,T1113
"then collects the credentials, host information, files,",T1005
Syncro RMM is a Remote Monitoring and Management tool used to control and manage devices remotely.,T1219
tool can be used as a persistence mechanism and remote accessing,T1219
Syncro RMM can also be used as a persistence mechanism,T1219
leverages SOCKS5,T1095
leverages SOCKS5 proxies to hide malicious traffic,T1090
task scheduling,T1053.005
it proceeds with scheduled task creation,T1053.005
run the scheduled task every 2 minutes is start.,T1053.005
the scheduled task,T1053.005
creates the registry key,T1112
creating the registry key,T1112
These words are used to build the registry value names.,T1112
recursively removes the implementation of Windows Defender IOfficeAntiVirus under HKLM:\SOFTWARE\Microsoft\AMSI\Providers\{2781761E-28E0-4109-99FE-B9D127C57AFE}.,T1112
enables the data transfer with URL syntax for protocols such as HTTP/HTTPS,T1071.001
runs it via rundll32.exe,T1218.011
injects itself into explorer.exe,T1055
injecting itself into a running explorer.exe process.,T1055
injecting itself into a running explorer.exe process,T1055
"The script performs process injection using the API such as OpenThread (to create a handle to an existing process), VirtualAlloc (memory allocation in the chosen process), and QueueUserAPC, the thread that the APC (Asynchronous Procedure Calls) is queued to has to enter an alertable state",T1055
"accessing browser credentials and cookies, Thunderbird and Outlook profiles",T1552.001
malware creates the persistence via Registry Run Keys.,T1547.001
creates a persistence via Registry Run Keys under HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run,T1547.001
it stores three embedded binaries within the unpacked payload.,T1027
the embedded compressed binaries,T1027
compressed binary,T1027
unpacked payload,T1027
The binaries are compressed using APLib compression algorithm.,T1027
The unpacked sample is approximately 540 KB,T1027
The unpacked sample is approximately 540 KB,T1027
decompress data blobs,T1140
decompress them,T1140
The decompression function,T1140
Decrypted strings,T1140
Decompiled decryption function,T1140
Decryption function in Python,T1140
The decryption function,T1140
The decryption function,T1140
Decryption function,T1140
the decryption function,T1140
APLib decompression function,T1140
decrypts them,T1140
"The decryption function is shown below, the decryption function can be represented as the following pseudocode:",T1140
The GPG decryption routine,T1140
GPG decryption,T1140
wmic,T1047
reg.exe query,T1012
that pulls the written data from the registry under HKEY_CURRENT_USER\Software\AppDataLow\Software\Microsoft\<registry_value>>,T1012
the Tor communication capability,T1090
Configured for WMI persistence,T1047
WMI Persistence,T1047
"As tasklist uses WMI “under the hood,",T1047
the malicious authentications into victim O365 tenants had originated from within the victim’s own network.,T1078
the threat actor was making authentications to O365,T1078
Log in to O365 as a user with privileged access to cloud resources.,T1078
the threat actor succeeded in authenticating into victim O365 tenants,T1078
This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments,T1078
the threat actor connected to the victim’s O365 tenant,T1078
the user account used to connect to the victim’s O365 tenant,T1078
the threat actor managed to continue to access the victim’s cloud environment,T1078
the accounts that were used to authenticate to the cloud.,T1078
the threat actor used a compromised O365 administrator account,T1078
The threat actor created new O365 Service Principals to maintain access to victim’s environments,T1078
The threat actor used accounts with Delegated Administrator rights to access other O365 tenants,T1078
the threat actor leveraged different credentials for each step while moving laterally through the victim’s network,T1078
using privileged accounts and then accessed the wiki using a different set of credentials.,T1078
the threat actor began attempting to connect into the environment via VPN,T1078
The threat actor attempted to log in to the VPN using several user accounts,T1078
threat actor had knowledge of these accounts and used them on the correct systems,T1078
the threat actor connected into the victim’s environment via a VPN,T1078
The Threat actor also used valid accounts to create persistence within the environment,T1078
to establish a Remote Desktop Protocol (RDP) session to an internal server,T1021.001
establish another RDP session to a different internal server,T1021.001
the threat actor connected via RDP to a user’s workstation,T1021.001
the threat actor’s RDP session.,T1021.001
The threat actor established RDP sessions to internal servers,T1021.001
The threat actor connected via Remote Desktop,T1021.001
the user the threat actor used to RDP,T1021.001
the threat actor connected via Remote Desktop to a Domain Controller,T1021.001
"The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system",T1021.001
using a domain service account.,T1078
using a domain administrator’s account.,T1078
the threat actor could have easily used a second domain administrator account,T1078
The threat actor accomplished this by using administrative accounts,T1078
a given user account was also authenticating to Active Directory from a given source IP address two years prior,T1078
the user account was known to have recently been abused by the threat actor,T1078
the threat actor accessing the wiki as users who would be considered “non-privileged”,T1078
A local account was used by the Threat Actor,T1078
"to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.",T1570
the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.,T1570
the threat actor must first decrypt them,T1140
they decrypted the cookies file using the user’s DPAPI key.,T1140
The decryption of the cookies,T1140
deleted the specific history items related to threat actor activity,T1070.004
Attempted to blend in with a file name that matched the system name it resided on,T1036.005
Attempted to blend in with a file name that matched the system name it resided on,T1036.005
With the binary named to masquerade as a legitimate file on the system,T1036.005
AdFind was renamed to masquerade as a legitimate Windows binary,T1036.005
"The threat actor renamed their utilities to masquerade as legitimate system binaries (AdFind as svchost.exe), match the system’s role (GoldMax), or appear legitimate (TrailBlazer as an apparent Adobe utility).",T1036.005
the threat actor renamed their systems prior to connecting to victim’s VPNs to match the victim’s system naming convention,T1036.005
Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests,T1071.001
directories with random names of a consistent length were navigated to by the same user that ran the tool.,T1083
ListUsers,T1033
The threat actor attempted to remotely list running processes on systems using tasklist.exe,T1057
process listing,T1057
This remote process listing,T1057
the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.,T1057
The threat actor regularly interrogated other systems using tasklist.exe,T1057
the use of a PowerShell script to execute Mimikatz in-memory,T1003.001
to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory,T1003.001
the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.,T1027
used a heavily obfuscated PowerShell script,T1027
enumerating current directory,T1083
tries to enumerate the current directory,T1083
crawl the filesystem,T1083
The decrypted payload,T1140
Decrypted payload,T1140
The decrypted payload,T1140
try to decrypt it using the RC4 encryption scheme with the key,T1140
then decrypts and communicates to,T1140
decodes the embedded shellcode,T1140
the encrypted payload,T1027
contain encrypted C2 strings,T1027
encrypted payload,T1027
Embedded encrypted payload,T1027
DLL has an encrypted payload embedded in it.,T1027
The embedded DLL,T1027
side loading “ffmpeg.dll”.,T1574.002
that have Base64 and AES encrypted C2’s appended to them,T1573.001
using NetWkstaGetInfo() API.,T1106
"domain name, Hostname and OS Version",T1082
The info stealer also collects information on infected hosts,T1005
Manipulates registry,T1112
decrypting and executing the shellcode,T1140
decrypt the payload,T1140
The decrypted payload,T1140
decrypts a shellcode,T1140
performed through the CryptUnprotectData API function,T1106
an encrypted shellcode payload.,T1027
Encrypts a provided payload,T1027
DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded,T1574.002
"collects system information and browser history, then sends it to the C2 server.",T1041
downloads an infostealer and starts it.,T1105
Performs payload injections through syscalls via mapping a shellcode to a remote process and creating a remote thread.,T1055
The driver collects information about installed AV filters,T1518.001
Connects to a given host via a socket and waits for the server to send data.,T1095
"Manipulates (creates, lists, starts, stops and deletes) services.",T1543.003
attackers placed,T1105
attackers placed,T1105
administrator credentials,T1078
compromised administrative [T1078.001] accounts,T1078
user,T1078
Access to valid,T1078
locate high value assets in order to exfiltrate data,T1005
Spearphishing emails with malicious attachments,T1566.001
attached to spearphishing emails,T1566.001
exploitation of public-facing applications,T1190
User execution [T1204] of malicious files,T1204.002
steganography [T1027.003] to hide stolen data inside other files stored on GitHub,T1027
multi-hop proxies,T1090
stage collected data locally,T1074.001
Exfiltration over C2 channel,T1041
encryption,T1027
24 different IP addresses in use,T1090
compromised devices that act as proxies for their C&C servers,T1090
"use some victims as proxies, or some vulnerable devices to forward communication to their real C&C servers.",T1090
phishing emails have similar topics and pretend to come from some of the same entities,T1566.001
"attachments used for phishing emails,",T1566.001
emails have a PDF document attached,T1566.001
PDF file attached,T1566.001
used emails with PDF or RTF files attached that contain a link to download malware,T1566.001
user must click to download the malware,T1204.002
manually extract the file and execute it,T1204.002
have attempted to get users to execute malicious files masquerading as documents,T1204.002
regular RAR archives that have an executable file inside.,T1027
contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious,T1027
reads a string (or binary data) from its resource section,T1027
reads data from its own resource section and decrypts a payload.,T1027
is read from an encrypted resource,T1027
two shellcodes contained in the compiled AutoIt script,T1027
"Read a binary from its resource section, write it to disk and execute it",T1027
variety of packers used for these executables,T1027
different variants of a packer,T1027
is packed with CyaX,T1027
is gzip-decompressed and executed,T1027
.NET packer known as CyaX,T1027
used an AutoIt packer that comes heavily obfuscated.,T1027
have used various layers of packers for obfuscating their droppers.,T1027
decrypting the payload,T1140
decrypting,T1140
decrypt,T1140
decrypts it,T1140
decrypts another executable,T1140
a string that will be decrypted,T1140
"decrypts the array by doing a single-byte XOR operation, cycling through the key",T1140
decryption of the payload is based on XOR operations,T1140
decrypt the payload,T1140
a single-byte XOR algorithm.,T1140
decrypt the payload,T1140
have used various encryption algorithms in their droppers to hide strings and payloads,T1140
injecting it into legitimate processes.,T1055
be injected into a new process or loaded in the same process space,T1055
"injected into a different process,",T1055
injection of the payload,T1055
performs the injection and execution of the payload,T1055
inject it into some process,T1055
shellcode with RunPE code is used to perform the injection,T1055
RAR archive is downloaded,T1027
compressed archives,T1027
"layers of encryption, obfuscation or anti-analysis",T1027
"was hiding in non-malicious code,",T1027
encrypted resource and XORed with a hardcoded password,T1027
encrypted with this same XOR-based algorithm,T1027
DLL is run with rundll32,T1218.011
uses steganography,T1027
reads pixels from an image contained in the first binary,T1027
"stores every pixel as three numbers according to its red, green and blue components",T1027
have used packers that read pixel data from images contained in PE files’ resource sections and build the next layer of execution from the data,T1027
DLL that will be loaded and called in the same address space,T1055
performs the injection is contained in an array and is dynamically loaded.,T1055
disabling Windows Defender,T1562.001
"have used CyaX packer, which can disable Windows Defender.",T1562.001
checking for security products,T1518.001
used droppers that check for security software present in a victim’s computer,T1518.001
loaded with VirtualAlloc and executed,T1106
"used API calls in their droppers, such as CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory",T1106
created in the Startup folder to execute the script.,T1547.001
used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder,T1547.001
Delete the dropper executable,T1070.004
have used malware that deletes itself from the system,T1070.004
Download and execute files,T1105
ability to download and execute other malware,T1105
uploading and downloading files,T1105
keylogging,T1056.001
keylogging,T1056.001
"keylogging,",T1056.001
used various RATs that have keylogging capabilities,T1056.001
screen capture,T1113
taking screenshots,T1113
used various RATs that can capture screenshots of victim machines,T1113
exfiltration of files,T1041
used various RATs that exfiltrate data over the same channel used for C&C,T1041
used RATs that can launch a command she will for executing commands.,T1059.003
have used scheduled tasks in their droppers and payloads to achieve persistence,T1053.005
used RATs that implement UAC bypassing.,T1548.002
"have used RATs that allow full access to the Registry,",T1112
have used droppers that inject the payload into legitimate processes,T1055
used various RATs that can browse file systems,T1083
used various RATs with modules that show running processes,T1057
used various RATs that can read the Registry.,T1012
used various RATs that gather system information such as computer name and operating system during the initial infection,T1082
used various RATs that can collect the IP address of the victim machine,T1016
used various RATs that retrieve the current username during initial infection,T1033
used various RATs that can perform remote desktop access.,T1021.001
"used various RATs that can access the local file system and upload, download or delete files",T1005
"used Remcos RAT, which uses RC4 for encrypting C&C communications",T1573.001
used various RATs that use TCP for C&C communications,T1095
data exfiltration of sensitive information,T1005
move through the victim environment via RDP,T1021.001
"mass deletion of virtual machines, storage, and configurations",T1070.004
to identify any credentials which may be stored in technical documentation,T1552.001
extraction of sensitive API Keys,T1552.001
Access to local password managers and databases to obtain further credentials,T1552.001
Using compromised credentials to access corporate VPNs.,T1078
victim controlled hostnames were revealed,T1082
runs a scheduled task,T1053.005
decryption of credentials,T1140
decrypted using DPAPI,T1140
These credentials are generated and stored in the memory of the LSASS process,T1003.001
Attackers may attempt to access LSASS process memory to extract credentials as it stores a variety of credentials.,T1003.001
"LSASS process memory is one of the prime targets for attackers, as well as malware armed with lateral movement capabilities since it caches a variety of credentials",T1003.001
Credential extraction from the LSASS process,T1003.001
credential-based deception is to stage the deceptive credentials in LSASS process memory.,T1003.001
credentials are extracted with Mimikatz.,T1003.001
credential extraction tool Mimikatz,T1003.001
uses the CreateProcessWithLogonW Windows API,T1106
calling the API,T1106
recon for interesting hostnames,T1082
public facing systems is compromised,T1190
be injected with deceptive credentials at multiple places like LSASS process memory,T1055
Injecting NETONLY credentials into LSASS process memory,T1055
Injecting credentials into LSASS memory,T1055
credentials being picked up and used to pivot to decoy systems in the network,T1078
keyloggers,T1056.001
flood a remote DNS server with false traffic.,T1071.001
"send traffic simultaneously to one server,",T1071.001
using the default factory credentials.,T1078
exfiltrating data from the target device,T1041
covert channel that can be used to exfiltrate data from the victim device,T1041
"deliver more malware,",T1105
extract data and files from endpoint devices.,T1005
a version of the malware that was injected into a victim’s system,T1055
"It usually pretends to be a legitimate file, such as an Adobe PDF or Dropbox file,",T1036.005
The phishing email with the malicious attachment,T1566.001
file is a Python program packaged by PyInstaller.,T1027
is an obfuscating tool for Python script that makes the malware harder to be analyzed and detected.,T1027
It contains Base64-encoded data,T1027
Python programs that are obfuscated using PyArmor,T1027
"After decrypting the pyc file,",T1140
it uses the following command to delete the data in PSReadline,T1070.004
It also checks the victim’s hostname,T1082
collects browser history and passwords from the following browsers,T1552.001
It also uses the command “CopyFromScreen” to capture a screenshot.,T1113
Downloading files and getting a screenshot,T1113
Download components for the Keylogger,T1056.001
It is a key logger that saves data in the “KeyLogs” folder.,T1056.001
downloads three components from,T1105
can be executed via scheduled tasks.,T1053.005
"It was quite common to see scheduled tasks used to create persistence for the ransomware executable,",T1053.005
The threat actors also expressed interest in other access methods such as RDP,T1021.001
Credentials that have either been reused across multiple platforms or have previously been exposed,T1078
this includes VPN accounts,T1078
Compromised accounts may be used to maintain access to the network.,T1078
local accounts.,T1078
domain and local accounts,T1078
Affiliates have been seen brute forcing,T1110
Exploit Public-Facing Applications,T1190
is typically executed via command line arguments,T1059.003
some defense evasion batch scripts.,T1059.003
a batch script or a specially crafted command line script.,T1059.003
has utilized a UAC bypass tool.,T1548.002
"Indicators, such as logs in Windows Event Logs or malicious files, are typically removed using wevtutil, a batch script, or CCleaner.",T1027
"Windows Defender, other anti-malware solutions and monitoring tools are disabled utilizing a process explorer tool,",T1562.001
Firewall rules have occasionally been seen being disabled as well.,T1562.001
"During the defense evasion phase, anti-malware and monitoring software is often disabled.",T1562.001
Mimikatz is a key player in dumping credentials but LockBit 2.0 has been occasionally seen utilizing MiniDump as well.,T1003.001
has been seen using the PowerShell module InvokeGPUpdate to update the group policy.,T1484.001
Most PowerShell scripts involved in LockBit 2.0 cases are Base64 encoded.,T1027
"enumerates system information such as hostname, shares, and domain information.",T1082
has been known to self-propagate via SMB.,T1570
a method of lateral movement and a tool for downloading/executing files.,T1570
"AnyDesk has been the most common legitimate desktop software used to establish an interactive command and control channel, with ConnectWise seen slightly less frequently.",T1219
Operates as a file grabber,T1105
the UPX packed sample,T1027
which unpacks,T1027
brute forcing post-infection to automate local and global spreading attempts.,T1110
brute forcing,T1110
"multiple levels of encoded commands,",T1027
The multiple levels of Base64 encoding,T1027
use of three base64 encoded echo commands,T1027
encoded payload,T1027
downloading itself from malicious servers,T1105
attacker began adding the lwp-download command as a failover for wget and curl to enable downloading commands,T1105
"download, and configure",T1105
process of downloading and setting persistence of some other file.,T1105
downloading a specific payload,T1105
decoded into a new script,T1140
The payload contains two additional base64 encoded scripts,T1027
operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network.,T1078
exploits known vulnerabilities in internet-facing applications,T1190
"MiniDump, “a C# implementation of mimikatz/pypykatz minidump functionality to get credentials from LSASS dumps”",T1003.001
Usernames,T1033
and hostnames collected,T1082
"It is used to connect to systems in the same network via SMB, to write a batch file to disk",T1570
to push batch files over SMB to other systems within an internal network.,T1570
"write a batch file to disk that executes the Fantasy wiper, and then run that batch file via PsExec with this command line string",T1059.003
writing the batch file to disk and executing.,T1059.003
The batch file,T1059.003
The batch file,T1059.003
a batch file,T1059.003
"creates another batch file, system.bat,",T1059.003
writes another batch file,T1059.003
"the batch file in Figure 7, which Sandals creates on remote systems to launch",T1059.003
both use batch files that run via the Windows command she will.,T1059.003
ease of batch file execution.,T1059.003
write the batch file on the remote system.,T1059.003
it writes a batch file,T1059.003
lists the command line arguments accepted,T1059.003
deletes all files written to disk in the current working directory,T1070.004
then deletes the file.,T1070.004
deletes the directory with the files causing the errors,T1070.004
recursively deletes all files,T1070.004
the file deletion functions,T1070.004
File deletion functions,T1070.004
File deletion functions,T1070.004
then deletes the files.,T1070.004
the decoded command line parameter,T1140
The base64 string,T1027
base64-encoded argument,T1027
a base64 encoded argument,T1027
It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.,T1083
Then it enters a for loop iterating over the drive list to build a recursive directory listing,T1083
shows that the directory listing function,T1083
Directory listing functions,T1083
", the GetSubDirectoryFileListRecursive function",T1083
Recursive directory listing functions,T1083
and then self-deletes.,T1027
bat deletes itself,T1027
"attempts to clear file system cache memory, and self-deletes",T1027
that deletes the Fantasy wiper from disk and then deletes itself.,T1027
creates a batch file in %WINDOWS%\Temp called registry.bat.,T1112
deletes the following registry keys: HKCR\.EXE HKCR\.dll HKCR\*,T1112
Then it runs the following to attempt to clear file system cache memory: %windir%\system32\rundll32.exe,T1218.011
GetSubDirectoryFileListRecursive function,T1106
uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs,T1106
operators attempted to capture cached credentials and then use them for lateral movement.,T1078
The actors used built-in Windows user account DefaultAccount.,T1078
and the built-in Windows user account [T1078.001] to move laterally,T1078
HTTPS activity from IP address to the organization’s VMware server.,T1071.001
"Following HTTPS activity,",T1071.001
outgoing HTTPS port 443 connections to and (the prior domain in reverse).,T1071.001
encoded payload,T1027
"to download next stage and execute it""",T1105
"The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok.",T1105
"The exclusion rule allowlisted the entire , enabling threat actors to download tools to the without virus scans.",T1562.001
that added an exclusion rule to Windows Defender,T1562.001
the actors manually disabled Windows Defender via the Graphical User Interface (GUI),T1562.001
The actors added an exclusion rule to Windows Defender.,T1562.001
"The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\drive.",T1562.001
The actors manually disabled Windows Defender via the GUI.,T1562.001
"The threat actors also moved laterally to the domain controller, compromised credentials,",T1078
the actors gained access to a VMware service account with administrator and system level access,T1078
"In February 2022, the threat actors exploited Log4Shell [T1190] for initial access",T1190
The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server.,T1190
The exploit payload created a Scheduled Task,T1053.005
The Scheduled Task was named to masquerade as a legitimate Windows task.,T1053.005
"The actors’ exploit payload created Scheduled Task RuntimeBrokerService.exe, which executed RuntimeBroker.exe daily as SYSTEM.",T1053.005
the actors used RDP,T1021.001
the actors leveraged RDP to propagate to several hosts within the network.,T1021.001
"The actors were able to proxy [T1090] RDP sessions,",T1021.001
The actors used RDP to move laterally to multiple hosts on the network.,T1021.001
used Ngrok to proxy RDP connections and to perform command and control.,T1021.001
a reverse proxy tool for proxying an internal service,T1090
Mimikatz – a credential theft tool.,T1003.001
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials,T1003.001
"Additionally, the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process",T1003.001
The actors used Mimikatz,T1003.001
The actors were observed trying to dump LSASS process.,T1003.001
The actors used Mimikatz to harvest credentials.,T1003.001
The actors were able to proxy,T1090
The actors used Ngrok to proxy,T1090
The actors removed malicious file mde.ps1 from the dis.,T1027
"When executed, mde.ps1 downloaded from and removed from the disk",T1027
send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.,T1566.001
sending additional phishing emails to the victim’s contacts,T1566.001
phishing email,T1566.001
"starts with an income tax-themed phishing email written in Spanish, disguising itself as a tax receipt notification",T1566.001
disseminate additional phishing emails to the victim’s contacts.,T1566.001
send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.,T1566.001
constructs an email with a hardcoded subject and body and attaches the HTML file from the “fb” folder.,T1566.001
collect the victim’s login credentials for various online accounts,T1078
login credentials,T1078
targets victim’s login credentials,T1078
credentials,T1078
attempt to compromise the victim’s login credentials for webmail services,T1078
keystrokes,T1056.001
"keylogging,",T1056.001
logs keystrokes,T1056.001
logging keystrokes via polling and application hooks,T1056.001
logging keystrokes,T1056.001
operating system information,T1082
"system information,",T1082
"performs surveillance on the victim’s machine by collecting system information such as hostnames, IPv4 address, operating system version, disk volume information, disk size and anti-virus software information, and gets the system’s default language.",T1082
"using multiple hosts, including an Amazon Web Services (AWS) Elastic Compute Cloud (EC2) instance, accessed through its public URL, to host the malicious files.",T1071.001
requests a data stream from the C2 server through the URL,T1071.001
hosted the PowerShell downloader script,T1105
hosted the ZIP file containing the payloads,T1105
downloads a RAR file.,T1105
downloads the PowerShell downloader script from an attacker-controlled server,T1105
download a ZIP file,T1105
downloading,T1105
download the payloads,T1105
downloads a malicious ZIP file,T1105
drops the DLL,T1105
download the PowerShell downloader script from the attacker-controlled server,T1105
download and run the Horabot “au” using the URL,T1105
downloading files from a URL,T1105
downloads the contents of an HTML file stored in an attacker-controlled server,T1105
a virtual private server (VPS) behind which the attacker has parked the actual command and control (C2) server,T1090
"domain name also resembled the legitimate Mexican Tax Agency domain, a tactic the attacker likely adopted to disguise malicious traffic.",T1036.005
is a legitimate AutoIt interpreter.,T1036.005
uses PowerShell downloader,T1059.003
leads to payload delivery through the execution of a PowerShell downloader script,T1059.003
RAR file contains a batch file with a CMD extension,T1059.003
executes it through the PowerShell commands.,T1059.003
downloading and executing two other PowerShell scripts from a different attacker-controlled server.,T1059.003
"PowerShell downloader script, which the attacker attempts to execute to re-infect the victim’s machine,",T1059.003
batch file downloads the PowerShell downloaderThe,T1059.003
a malicious batch file with a .cmd extension is downloaded to the user’s machine.,T1059.003
executes an embedded PowerShell command to download the next-stage PowerShell script from the server and execute it on the victim’s machine.,T1059.003
creates two other malicious batch scripts with the extension .cmd in the folder “/Users/Public.”,T1059.003
executes one of the dropped batch files,T1059.003
executes an embedded PowerShell command,T1059.003
"executes another dropped batch file,",T1059.003
executes a PowerShell command,T1059.003
contains the payload DLLs and a few legitimate executables and DLLs,T1055
DLL sideloadingThis,T1574.002
sideloading to legitimate executables,T1574.002
run the payloads by sideloading them to the legitimate executables,T1574.002
sideload a malicious DLL,T1574.002
sideload the DLL,T1574.002
sideloads the DLL to the AutoIt interpreter process,T1574.002
enticing users to open the attached malicious HTML file,T1204.002
lures them to click an embedded malicious hyperlink which,T1204.002
executed when the victim opens the contents of the file,T1204.002
"user opens the CMD file,",T1204.002
"an embedded URL is launched in the victim’s browser,",T1027
has an embedded malicious URL,T1027
redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance.,T1090
configured to run the payloads in the startup folder of the victim’s machine,T1547.001
creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.,T1547.001
"creates three more Windows shortcut files in the victim’s machine startup folder,",T1547.001
files dropped in the Windows startup folder are run,T1547.001
launches several processes,T1543.003
heavily obfuscated with random symbols that substitute the instructions during the run-time and base64-encoded strings.,T1027
uses alphanumeric characters and the special character “_” to generate a random name and creates a folder with the random name in the root directory of the victim’s machine.,T1027
executes the compiled AutoIt script,T1027
evade detection,T1027
encodes the email addresses in the “.Outlook” file to a data stream,T1027
decodes the base64-encoded strings and initializes them,T1140
decrypts the encrypted,T1140
decrypt,T1140
decryption function decrypts the URL pointing to the attacker-controlled server,T1140
the malicious ZIP file is deleted.,T1070.004
deleting the “fb” folder to cover its paths and avoid detection,T1070.004
"writes the path of the executable file, “_upyqta2_Ji7.exe”, to the class’s registry key “HKEY_CURRENT_USER\software\Classes\ms-settings\she will\open\command”",T1112
screenshot capturing,T1113
"capturing screenshots,",T1113
capturing screenshots,T1113
anti-virus software information,T1518.001
"Checks for the existence of the anti-virus products such as AVERAGE and Avast by checking for the DLLs avghookx.dll, avghooka.dll and snxhk.dll",T1518.001
exfiltrated to the attacker-controlled server through an HTTP POST request to the URL,T1041
exfiltrates the email address to the C2 server using an HTTP POST request,T1041
exfiltrate contacts’ email addresses,T1041
encoded email addresses are exfiltrated,T1041
"checking if a file on the victim’s filesystem exists and gets the file’s attributes, collecting size and version information,",T1083
looks for the Outlook data files from the victim profile’s Outlook application data folder.,T1083
enumerates all folders and emails in the victim’s Outlook data file,T1083
collect login data from the Google Chrome user profile folders,T1005
"extracts email addresses from the emails’ sender, recipients, CC and BCC fields.",T1005
creating SQL queries to produce the database tables to store the stolen data,T1074.001
added to the email address collection array.,T1074.001
writes the extracted email addresses from the array to a file called “.Outlook” created by the script in the roaming user profile’s Microsoft application data folder.,T1074.001
"Checks the registry keys to detect virtual environments such as VMWare, Virtual Box, Wine, Microsoft Hyper-V or Windows Virtual PC.",T1012
the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.,T1047
examples of the command line syntax used for the performance of this activity,T1059.003
adversary using Windows Batch files,T1059.003
cmd /c,T1059.003
cmd /c,T1059.003
performed via the following command-line syntax,T1059.003
the command-line syntax used,T1059.003
command-line syntax was observed being used,T1059.003
the Windows Command Processor was used,T1059.003
"attacker also used the ""proxychains"" utility, which is often employed to redirect network traffic",T1090
use of utilities such as proxychains,T1090
adversary leveraging a Windows Service to execute PowerShell to stay persistent in the environment.,T1569.002
The Windows service was configured with the following options:Service Type: user mode service Service Start Type,T1543.003
the PowerShell being executed was Base64 encoded,T1027
The decoded PowerShell instructions,T1140
"decrypting,",T1140
Disabling PowerShell logging,T1562.001
Disabling this security control,T1562.001
to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities,T1562.001
attacker disabling Windows Defender,T1562.001
"Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server",T1105
the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment.,T1021.001
attacker also attempted to execute PowerShell scripts on remote systems in the environment while moving system-to-system,T1570
adversaries copied and executed the aforementioned PowerShell script on multiple systems across the environment,T1570
Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data,T1003.001
"invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process",T1003.001
utilizing comsvcs.dll,T1003.001
"invoking comsvcs.dll with rundll32.exe,",T1218.011
adversary was also observed remotely modifying the Windows Registry on remote systems,T1112
by modifying the Windows Registry on compromised systems.,T1112
the adversary attempting to exfiltrate sensitive information over SMB (TCP/445) directly from a compromised domain controller.,T1041
screen capture,T1113
keylogging,T1056.001
Microsoft SharePoint vulnerability CVE-2019-0604 was used to deliver web shells,T1190
exploited the Microsoft SharePoint vulnerability CVE-2019-0604 to install web shells,T1190
"running native Windows commands on compromised servers,",T1059.003
The operators made a consistent effort to delete these tools and remove any residual forensic artifacts from compromised systems.,T1027
consistently cleaned up evidence of their intrusion after gaining access to a system,T1027
moved laterally and deployed their signature malware,T1570
used this access to deploy and remotely execute FOCUSFJORD on their primary target.,T1570
The operators deleted tools used for credential harvesting and internal reconnaissance,T1070.004
"to delete any remaining FOCUSFJORD forensic evidence, including files on disk, configuration data encrypted in the registry, and related services and registry keys used for persistence.",T1070.004
writes its encrypted C2 configuration into the system’s registry,T1112
"writes its configuration to registry, this value is set to “default” and is later manually changed by the actor",T1112
the operators were able to access their primary target via RDP connections,T1021.001
operators were able to access their primary target via RDP connections from a trusted third party using stolen credentials,T1078
configured to proxy C2 traffic,T1090
configured to proxy C2 traffic,T1090
"used other victim networks to proxy their C2 instructions, likely to minimize the risk of detection and blend in with normal network traffic.",T1090
acting as proxies to relay communications to their C2 servers.,T1090
usually to the victim’s domain name,T1082
to read and decrypt those registry key values for proper execution.,T1140
the malware needs to read and decrypt those registry key values,T1012
to obfuscate the source of the activity.,T1027
a tool called “anti.exe” to stop Windows Update service and terminate EDR and Antivirus related services.,T1562.001
leverages spear-phishing and tries to trick the victims into opening malicious documents,T1566.001
They used multiple malicious PDFs and MS Office documents during the campaign.,T1566.001
they use tools such as Mimikatz to dump credentials.,T1003.001
"and remote monitoring software such as ScreenConnect, Remote Utilities, and eHorus.",T1219
"they added a new tool for remote access, Syncro, to their arsenal.",T1219
It disguises itself as a legitimate Google Update executable.,T1036.005
It collects the victim’s username,T1033
computer name,T1082
and IP address,T1016
Domain fronting is another method for concealing communication between the endpoint and the command and control servers.,T1090
purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host,T1090
masks your traffic to a certain website by masquerading it as a different domain.,T1090
Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic,T1090
attackers have started using this technique to hide their malicious infrastructure behind legitimate domains,T1090
domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles,T1090
Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.,T1090
Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.,T1090
Setup a profile to facilitate domain fronting,T1090
the legitimate website will forward the traffic through the CDN to the original destination according to the host header.,T1090
domain fronting,T1090
domain fronting,T1090
domain fronting,T1090
domain fronting,T1090
malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs,T1090
domain fronting,T1090
domain fronting,T1090
domain fronting,T1090
domain fronting appears to be used by threat actors.,T1090
Attackers can use legitimate domains that are registered under the same CDN provider.,T1090
HTTP/HTTPS C2 traffic,T1071.001
HTTP communication between the Beacon and the Cobalt Strike server,T1071.001
other compromised host running the parent HTTP Beacon,T1071.001
HTTP Parent Beacon,T1071.001
customized for the HTTP-POST Block,T1071.001
Encrypting and encoding the data with XOR mask and random key,T1573.001
threat actors use their beacon sessions to establish RDP access,T1021.001
attackers was to establish a Remote Desktop session,T1021.001
"to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted",T1021.001
attacker’s Kali Linux host to RDP into our target’s environment,T1021.001
RDP into the target host,T1021.001
Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session,T1021.001
SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon,T1090
SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited,T1090
the SMB Beacon is communicating over the network with a parent Beacon using named pipes.,T1090
can see the named pipe created that we specified on the Cobalt Strike interface when we created the SMB listener.,T1090
RDP into the target host using reverse proxy,T1090
threat actors using reverse proxy,T1090
a reverse proxy,T1090
Reverse Proxy using Cobalt Strike Beacon,T1090
the ability to run a SOCKS proxy server on the team server.,T1090
This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session,T1090
attackers take advantage of this technique using proxychains,T1090
employ proxychains from the attacker’s Kali Linux host,T1090
via reverse proxy.,T1090
can be configured as a proxy,T1090
threat actors use their beacon sessions to establish RDP access through a reverse proxy,T1090
the victim’s hostname is captured in this logon event,T1082
execute the command systeminfo on the compromised host.,T1082
it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.,T1041
which will then send the results to the C2 server,T1041
SSL can be used to complicate command-and-control (C2) traffic analysis,T1095
"replacing an early call instruction to their malicious code, or by overwriting the entry point in the PE header",T1055
"unpack any additional payloads,",T1027
HTTPS and other protocols built on SSL have,T1071.001
service using HTTPS,T1071.001
SSL encrypted traffic,T1071.001
TLS encrypted data,T1071.001
detect when TLS connections are being initiated and log the symmetric keys generated for the SSL/TLS connection,T1573.001
"decrypt TLS traffic,",T1140
decrypt network traffic,T1140
decrypted,T1140
the decrypted HTTPS traffic.,T1140
encrypt,T1027
SSL encrypted traffic,T1027
TLS encrypted data,T1027
downloads the next stage from a public file storage service,T1105
"embeds the next stages of the execution inside an additional file, usually an XML or a PDF file.",T1027
that embeds the Crypter with the payload.,T1027
the actor embeds the malicious code inside different legitimate codes.,T1027
which enables an HTTPS connection.,T1071.001
"Once downloaded and executed, the malicious installer copies its compressed files into a newly created folder with a legitimate-looking name (i.e., IIS Application Health Monitor) in one of the following directory paths:",T1036.005
"At first glance, the files within the directory may seem legitimate",T1036.005
Write a registry Run key,T1547.001
Write a.lnk file in the startup folder,T1547.001
registry run key persistence implementation,T1547.001
The Decryption Shellcode,T1140
"The Decryption shellcode has three main tasks: first, it extracts the Loader shellcode and the payload, then it decrypts them, and finally, it transfers the execution to the decrypted Loader shellcode.",T1140
Decryption shellcode execution flow,T1140
The Decryption shellcode,T1140
decrypts it using the denoted decryption key,T1140
the decrypted payload,T1140
the decrypted payload,T1140
the decrypted payload address,T1140
An encrypted additional shellcode,T1027
An encrypted payload,T1027
these are encrypted and split inside the XML.,T1027
the user will be encouraged to download a malicious installer,T1204.002
"deceive the user into thinking that the application has failed to execute, even as it silently continues the malicious execution in the background.",T1204.002
shellcode is to inject the decrypted payload within the currently running process (itself).,T1055
the Loader overwrites the current PE with the final payload’s PE,T1055
It does so by copying the PE headers and each section according to the current executable’s base address.,T1055
the Loader copies the new PE headers to the base address and each section to the relevant location according to the IMAGE_SECTION_HEADER,T1055
the import address table and relocation table of the newly injected PE.,T1055
the newly injected PE,T1055
Loader removes evidence of injection by using the following methods: Update the LDR data table entry to match the injected PE. Remove the injected PE headers from memory.,T1027
disable system defenses,T1562.001
The process list checked is as follows,T1057
The services running on the compromised system are checked against the following list,T1057
"The credentials also allow BlackCat to move laterally within the victim’s system and/or network, often with administrative privileges.",T1078
the ransomware to deploy additional tools,T1105
such as Mimikatz,T1003.001
utilizes a unique onion domain,T1090
Encrypted Multi-Hop Proxies,T1090
cyber actors use the VPS as well as small office and home office (SOHO) devices as operational nodes to evade detection.,T1090
have been routinely observed using a VPS as an encrypted proxy.,T1090
Some of these nodes operate as part of an encrypted proxy service to prevent attribution by concealing their country of origin and TTPs,T1090
cyber actors have been observed using a network of VPSs and small office and home office (SOHO) routers as part of their operational infrastructure to evade detection and host C2 activity,T1090
"to locate certain files, paths,",T1083
cyber actors have been observed using multiple implants with file system enumeration and traversal capabilities.,T1083
IP address space,T1016
cyber actors have exploited known vulnerabilities in Internet-facing systems,T1190
exploit targeting a public-facing appliance vulnerability.,T1190
"Exploiting Internet accessible webservers using webshell small code injections against multiple code languages, including net, asp, apsx, php, japx, and cfm.",T1190
These emails may contain a malicious link or files that will provide the cyber actor access to the victim’s device,T1566.001
These emails may contain a malicious link or file that provide the cyber actor access to the victim’s device,T1566.001
after the user clicks on the malicious link or opens the attachment.,T1204.002
the user clicks on the malicious link or opens the attachment.,T1204.002
"gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks.",T1078
"cyber actors used valid accounts to log into a service specifically designed to accept remote connections,",T1078
The actor may then perform actions as the logged-on user.,T1078
"cyber actors used valid accounts to log into a service specifically designed to accept remote connections,",T1078
The actor may then perform actions as the logged-on user.,T1078
"Using cmd.exe,",T1059.003
Windows Command She Will,T1059.003
or command line interface tools,T1059.003
executing malware shellcode and batch files,T1059.003
such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks.,T1053.005
to establish new services to enable persistence.,T1543.003
cyber actors have also been observed modifying group policies for password exploitation.,T1484.001
usage of Mimikatz,T1003.001
observed targeting the LSASS process or Active directory (NDST.DIT) for credential dumping.,T1003.001
"Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement.",T1055
Using shellcode that injects implants into newly created instances of the Service Host process (svchost),T1055
were observed using the 7-Zip utility to unzip imported tools and malware files onto the victim device.,T1140
cyber actors have been observed deleting files using rm or del commands.,T1070.004
cyber actors were observed Base64 encoding files and command strings to evade security measures.,T1027
have been observed using Base-64 encoded commands,T1027
"were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads.",T1218.011
"have been observed using commands, including tasklist, jobs, ps, or taskmgr, to reveal the running processes on victim devices.",T1057
cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.,T1078
cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.,T1078
cyber actors used RDP,T1021.001
cyber actors have been observed using the mv command to export files into a location,T1074.001
a downloader that downloads and executes a payload,T1105
cyber actors have been observed importing tools from GitHub or infected domains to victim networks,T1105
cyber actors used the Server Message Block (SMB) protocol to import tools into victim networks.,T1570
it also tries to delete the wp-sale.js file,T1070.004
obfuscated PHP code (again using character code obfuscation):,T1027
a heavily obfuscated script,T1027
obfuscated JavaScript code,T1027
When decoded,T1140
"When decoded, a backdoor is revealed",T1140
sent as a POST request,T1071.001
This backdoor executes arbitrary PHP code sent in POST request parameters.,T1071.001
actors disable antivirus software,T1562.001
the threat actor deactivated antivirus protocols,T1562.001
after receiving phishing emails containing malicious PDF documents [T,T1566.001
for initial access is RDP compromise.,T1021.001
actors often use RDP to move laterally across the network,T1021.001
download multiple tools,T1105
actors gain initial access through exploiting public-facing applications,T1190
PsExec has also been used to aid lateral movement,T1570
actors used a legitimate admin account to remotely log on to the domain controller,T1078
by modifying Group Policy Objects,T1484.001
force a group policy update,T1484.001
delete files upon completion—including,T1070.004
numerous batch (.bat) files on impacted systems,T1059.003
Batch files create a new admin user,T1059.003
which are typically transferred as an encrypted 7zip file.,T1027
These strings are passed to a decoding function where they are converted from hex to byte and XOR’d with decimal 18.,T1140
the decoded strings,T1140
Once decoded,T1140
Base64 decodes the payload content,T1140
to decode the second buffer using key 58 3E 88 D0,T1140
decoded by Shellcode,T1140
These strings are passed to a de-obfuscation function,T1140
PowerShell de-obfuscation routine,T1140
this shellcode is responsible for fetching Remcos RAT,T1105
used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers,T1105
retrieves a decoy tax document and VBS script.,T1105
copying the current process command line as a new argument,T1059.003
full command line argument,T1059.003
a single payload package is retrieved that contains both the two-stage shellcode,T1027
highly obfuscated commands and encrypted shellcode.,T1027
The PowerShell command contains various obfuscated strings,T1027
inject Remcos RAT into a legitimate Windows process such as ieinstal.exe.,T1055
injecting it into ieinstall.exe,T1055
execution begins with the user clicking on a shortcut file,T1204.002
executed by the user clicking a shortcut file,T1204.002
enticing users to click on malicious shortcut files,T1204.002
checks if the system is 64-bit,T1082
remote access and surveillance features,T1219
keylogging,T1056.001
screenshots,T1113
highly obfuscated and contains junk code to impede analysis.,T1027
The script concatenates hundreds of smaller strings into a single variable which ultimately builds and executes,T1027
The payload would then be decrypted through XOR,T1140
use a set of tools via remote desktop,T1021.001
the ransomware drops a batch file,T1059.003
to steal system information like machine details,T1082
the payload most likely arrives by exploiting public-facing websites and domains.,T1190
targeted vulnerabilities in Microsoft SQL (MS SQL) Server for initial access,T1190
"the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server",T1105
used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.,T1562.001
to terminate security-related processes and services by dropping KILLAV,T1562.001
the threat actors who perform brute-force attacks on MS SQL Servers.,T1110
"executed a spam campaign with malicious OneNote file attachments,",T1566.001
The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers,T1190
The malware implemented a series of Mimikatz modifications on closed-source tooling,T1003.001
staging a credential theft capability in the LSASS process itself by abusing native Windows capabilities,T1003.001
"In order to steal credentials, the attackers employ custom modified versions of Mimikatz",T1003.001
stealing credentials from the Local Security Authority Subsystem Service (LSASS) process.,T1003.001
"This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.",T1003.001
accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file,T1003.001
of a Security Package into LSASS using RPC calls.,T1003.001
steals credentials from LSASS,T1003.001
The threat actors used C:\MS_DATA as their main working directory for storing malware and staging data for exfiltration,T1074.001
and Remote Desktop user sessions.,T1021.001
"""cmd"" /c",T1059.003
"cmd"" /c",T1059.003
"cmd"" /c",T1059.003
"cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"""cmd"" /c",T1059.003
"They also retrieve networking information, like network adapters, specific machines, and network services like Remote Desktop Protocol (RDP).",T1016
"For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines.",T1570
and the PsExec Windows Sysinternals tool and net for lateral movement and exploration,T1570
loads and executes the decrypted,T1140
pc.exe decrypts AddSecurityPackage64.dll and pc.dll using the AES encryption algorithm,T1140
"pc.dll decrypts,",T1140
Disabling Windows event logging in an attempt to evade detection,T1562.001
"In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself",T1562.001
Injecting pc.dll into LSASS as a Security Package,T1055
to execute malicious code in the context of LSASS.,T1055
"enumerating the processes’ threads,",T1057
tasklist,T1057
informationAddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package,T1055
embedded JavaScript Observed Notation (JSON)-based configuration to set parameters,T1027
text-encoded in base64,T1027
brute-force attacks,T1110
brute-forcing and compromising servers,T1110
Valid credentials,T1078
"uploaded to the command-and-control (C&C) server,",T1041
usually at port 5028/TCP,T1095
use several highly obfuscated and underdevelopment custom loaders,T1027
malicious RAR archive,T1027
install an information stealer.,T1005
"stealer,",T1005
keylogger with logging capabilities using the Telegram API,T1056.001
distributed to victims via phishing attempts,T1566.001
embedded binary files,T1027
"archive contains the files,",T1140
"deobfuscate, decompress,",T1140
decrypts strings,T1140
"deobfuscation, and decompression",T1140
decompressing,T1140
"decompresses it using the GZipStream API,",T1140
masquerades as a legitimate word document,T1036.005
legitimize the package in the eyes of the victim,T1036.005
designed to lure unsuspecting victims into executing the loader.,T1204.002
is executed by the victim,T1204.002
utilizes Telegram for delivering payloads,T1105
download,T1105
used to send program execution DEBUG and Telegram to deliver payloads and send commands.,T1105
downloads the next part,T1105
"utilizes Telegram for delivering payloads, sending commands, and receiving the payload heartbeat.",T1095
send commands.,T1095
sends a request to the attacker-controlled Telegram channel,T1095
"sends the message ""bot getted"" to the debug server.",T1095
"accepts commands from a Telegram channel,",T1095
"message to both the Debug server and the Telegram channel,",T1095
sends a GET request to https://api[.]telegram[.]org/bot{token}/getUpdates to retrieve the command,T1095
API hashing,T1027
resolves hashed Windows APIs,T1027
conceal the utilization of potentially suspicious APIs (functions) from static detection,T1027
"replacing the human-readable names of functions (such as ""CreateMutexW"") with a hash value,",T1027
used in the code to call the corresponding API function,T1027
employs dynamic API resolving to conceal its API imports,T1027
"storing the names or hashes of the APIs needed, then importing them dynamically at runtime.",T1027
"passes two arguments to the ""mw_resolveAPI"" function.",T1027
resolves the given API hash and retrieves the address of an exported function,T1027
creating a hash for each export function name,T1027
"string encryption,",T1027
irrelevant code,T1027
LoadLibrary and GetProcAddress functions,T1106
Compressapi,T1106
GetTokenInformation API.,T1106
retrieves the MachineGuid of the infected system from the SOFTWARE\Microsoft\Cryptography\MachineGuid registry key,T1012
"retrieves the MachineGuid of the infected system from the ""SOFTWARE\Microsoft\Cryptography\MachineGuid"" registry key.",T1012
deletes the HKCU\SOFTWARE\Intel registry key and recreates it,T1112
collects information about the .NET Framework Setup,T1082
elevate its privileges by executing the mw_UAC_bypass function,T1548.002
Calling Local Windows RPC Servers from .NET,T1548.002
bypass user account control (UAC) using only two remote procedure call (RPC) requests,T1548.002
"executes an export function called ""Entry"" from UpdateTask.dll via rundll32.exe",T1218.011
payload through rundll32.exe,T1218.011
disable Microsoft Defender,T1562.001
patch the integrity level of the Microsoft defender (MsMpEng.exe) and forcibly reduce it from system to untrusted integrity.,T1562.001
determine if it is running as an account with administrator privileges or simply as a regular user,T1033
creating scheduled tasks,T1053.005
sets up its working directory,T1074.001
collect system information and steals user information,T1074.001
"tokens, and passwords from various web browsers and applications",T1078
captures screenshots,T1113
compressed and exfiltrated to the attacker via Telegram,T1041
"some strings, such as web browser paths and Geolocation API services URLs, are encrypted with the AES algorithm in cipher-block chaining (CBC) mode",T1573.001
"gathers basic system information,",T1082
for the infected system by gathering the username and hostname,T1082
"the malware then proceeds to gather basic system information, including username, computer name, and OS version,",T1082
"System info, including both hardware and OS info.",T1082
Collection of information about the system in HTML format,T1082
and hostname,T1082
"gathers basic system information, which it then sends to the C2,",T1041
send a list of process names and IDs back to the C2,T1041
the system information gathered by Domino Backdoor and sent to the C2,T1041
in return receives an AES encrypted payload.,T1027
uses a custom algorithm which XOR’s multiple values together.,T1027
which is stored immediately before the encrypted config block.,T1027
"The malware generates a random 32-byte key, which it encrypts using the RSA key.",T1027
loading an encrypted payload from its resources,T1027
The Microsoft WinCrypt library is used for AES encryption and,T1027
the encrypted config.,T1027
be based on an encryption algorithm used previously in,T1027
by gathering the username and,T1033
"to gather basic system information, including username,",T1033
is generated from the system username,T1033
used a similar XOR-based algorithm as part of its encryption mechanisms during communication with the C2.,T1573.001
"then proceeds to gather basic system information, including username, computer name, and OS version, which it then encrypts using AES-256-CBC and the generated,",T1573.001
then sends the AES-encrypted system data.,T1573.001
This data is then encrypted using AES and returned to the C2.,T1573.001
the decrypted config contains two pipe-delimited IP addresses,T1140
and decrypts them using XOR and the key,T1140
"The malware then proceeds to decrypt its configuration block,",T1140
The config is decrypted using XOR and a 16-byte key,T1140
"A second config block, which is decrypted separately",T1140
The decrypted data consists of a 4 byte size,T1140
The malware then decrypts the received payload using AES and the shared key.,T1140
which decrypts to the following 5 bytes,T1140
decrypting it using AES-256-CBC and a hardcoded key.,T1140
"The decrypted data consists of 4 bytes containing the payload size,",T1140
The Microsoft WinCrypt library is used for AES encryption and decryption by both,T1140
is decrypted using XOR and a 16-byte key,T1140
executes the decrypted shellcode,T1140
loads the resources using the API calls LdrFindResource_U and LdrAccessResource,T1106
and execute the file using CreateProcessA.,T1106
"utilising similar API calls,",T1106
the malware enumerates the running processes on the system and compiles a list of process names and IDs.,T1057
enumerate running processes and send a list of process names and IDs back to the C2,T1057
Enumerates running processes,T1057
the loader allocates memory within the current process and then loads the PE payload into it using the full PE loading procedure.,T1055
"It copies the headers, maps the individual PE sections, processes any relocations, loads the PE’s imports, and then executes the PE from its internally specified entry point.",T1055
"passes the PE payload to it, which the shellcode then loads and executes.",T1055
Enumerate files on desktop,T1083
Enumerates files under Steam application directory,T1083
looping through entries under registry key,T1012
"waits for data collection tasks to complete,",T1005
"creating a hash of the collected data, to which it then appends its current process id.",T1005
uploads data to the C2 via a HTTP POST request,T1071.001
http/https data transfer,T1071.001
Self-delete after sending data,T1070.004
It then attempts to connect to the C2 via TCP port 443,T1095
"ranswomare for Windows can self-propagate in the local area network using the legitimate PsExec utility (contained in its body), which creates a temporary system service.",T1569.002
Legitimate accounts obtained by the attackers can be used to ensure persistence in the compromised infrastructure.,T1078
may use stolen legitimate accounts specified in the configuration data.,T1078
uses the command she will to run appropriate commands,T1059.003
an additional BAT file contained in the body of the ransomware.,T1059.003
"The attackers may use wmic to obtain information and run various commands,",T1047
They may also use the wmiexec module from Impacket to execute commands and move across the network.,T1047
uses wmic to obtain the,T1047
ransomware uses Native API.,T1106
the function CreateProcessWithLogonW.,T1106
"affiliates may exploit group policies, which results in a scheduled task being created (on each host) that launches the ransomware.",T1053.005
disabling security tools,T1562.001
"To prevent being detected, the attackers end processes and services related to security and antivirus software.",T1562.001
"To bypass UAC, BlackCat ransomware may escalate privileges using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.",T1548.002
"Bypass User Account Control;The attackers may bypass UAC using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.",T1548.002
decrypts configuration data as well as decrypts and unpacks the legitimate PsExec utility,T1140
unpacks the legitimate PsExec utility,T1027
ransomware uses obfuscation.,T1027
use a SoftPerfect Network Scanner executable renamed to svchost.exe.,T1036.005
uses PsExec to modify the system registry parameter MaxMpxCt,T1112
"To obtain authentication data, the attackers may dump the LSASS process using legitimate tools (procdump, comsvcs.dll).",T1003.001
"To obtain authentication data from the registry and files, the attackers may use NirSoft utilities.",T1552.001
"The attackers enumerate drives, directories, and files",T1083
to search for sensitive information for exfiltration purposes.,T1005
The attackers collect information from the local system for exfiltration purposes.,T1005
The attackers may use RDP to move across the network.,T1021.001
uses wmic to obtain the UUID of the compromised host.,T1082
enumerates all running processes,T1057
can self-propagate in the network by using the legitimate PsExec utility,T1570
to search for ones relating to security,T1518.001
enumerates system services to search for ones relating to security,T1518.001
"Before exfiltration, the attackers may put collected data in 7Zip archives.",T1074.001
"Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS,",T1071.001
"When the attackers use Cobalt Strike, the collected information may be sent via Cobalt Strike server communication channels.",T1041
"To remotely access the compromised infrastructure, the attackers may use the legitimate tools TeamViewer and ScreenConnect.",T1219
"To remotely access the compromised infrastructure, the attackers may use Cobalt Strike, TeamViewer and ScreenConnect",T1219
which perform asymmetric/symmetric encryption of the C&C server communication channel.,T1573.001
the attackers copy tools necessary for deployment to the compromised host.,T1105
the malware executes a command to delete itself from the system,T1070.004
delete key files,T1070.004
"attackers have been seen using several methods to distribute the wiper through the domain, like: domain Group Policy Object (GPO)",T1484.001
installs the payload as a service,T1543.003
sets a hardcoded list of system directories,T1083
system directories are targeted,T1083
enumerates their partitions.,T1083
an obfuscated .NET program.,T1027
WMI,T1047
to identify where the Operative System is stored in the disk,T1082
Application-level protocol,T1071.001
sends the output of ipconfig in a POST request,T1071.001
the opening of a URL file extracted from the archive.,T1071.001
output of ipconfig was sent to one of two addresses,T1071.001
Application-level protocol,T1071.001
a GET request is sent to the C2 server.,T1071.001
application-level messages from the server to the client is sent as the body of an HTTP response,T1071.001
are sent using separate POST requests.,T1071.001
sends an HTTPS request,T1071.001
same IP address was used as C2 server,T1071.001
domains give attackers the ability to mask malicious traffic as legitimate activity within the company,T1071.001
HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.,T1071.001
HTTP and HTTPS are supported,T1071.001
HTTP with long polling,T1071.001
connect by sending a GET request to a URL from the configuration and provide a special cookie value,T1071.001
sends GET requests with pull operations.,T1071.001
POST request with push operation,T1071.001
Application-level protocol,T1071.001
use HTTP/HTTPS for C2 connections,T1071.001
An encrypted resume,T1027
archive,T1027
archive contains a bait PDF document,T1027
XOR encrypted with a 16-byte key,T1027
obfuscated with VMProtect,T1027
additional XOR encryption with the key,T1027
AES-128-CBC for encryption.,T1027
hashed with MD5,T1027
use AES-128 in CFB mode as the encryption algorithm,T1027
encrypted with the algorithm,T1027
a RAR archive,T1027
distributed in a RAR archive,T1027
ROR-13 hash,T1027
re-encrypted and saved in the same location,T1027
encrypted header,T1027
encrypted Base64 string containing the session GUID,T1027
compressed with GZip prior to encryption,T1027
are obfuscated with VMProtect,T1027
obfuscated,T1027
obfuscated code,T1027
is encrypted in the file,T1027
is re-encrypted,T1027
has been obfuscated with the same rel_jmp and fake-jb techniques,T1027
SFX archive,T1027
SFX archive,T1027
RAR and SFX-RAR files,T1027
plus the folder,T1027
"malicious archive,",T1027
located in the data sections,T1027
shellcode is located in a PE file overlay.,T1027
(encrypted) shellcode,T1027
consists of two .exe files.,T1027
contains three identical executable files,T1027
contains just one file:,T1027
which is also embedded inside the CHM file,T1027
three sections are extracted,T1027
malicious shortcuts,T1036.005
Web lnks with two shortcuts:,T1036.005
copies the payload to the folder C:\Users\Public\Downloads,T1036.005
PDF documents with a CV and IELTS certificate,T1036.005
the folder C:\Users\Public,T1036.005
copied to the folder %appdata%\Microsoft\AddIns\,T1036.005
into the folder c:\programdata,T1036.005
folder c:\programdata,T1036.005
trying to open either of the shortcuts,T1204.002
If the user opens it directly,T1204.002
"tries to make users run malicious .lnk, .chm, and .exe files",T1204.002
"running a command that extracts a Base64-encoded CAB archive from the body of the LNK file,",T1140
archive is unpacked to a temporary folder.,T1140
an extracted JS script,T1140
extract shellcode,T1140
decrypts the string,T1140
used for decryption:,T1140
is unpacked,T1140
unpacks,T1140
encrypted portion of the data is decrypted,T1140
is decrypted,T1140
decryption and decompression,T1140
decryption,T1140
decodes it into shellcode with Base64,T1140
decrypt,T1140
uses a custom PL format with encryption,T1140
adding itself to the startup folder,T1547.001
"writes the file svchost.bat, which transfers control to winness.exe, to the startup folder",T1547.001
persists by means of a registry run key or a startup folder,T1547.001
"adding a scheduler task,",T1053.005
creates a task with schtasks for persistence,T1053.005
that all three intermediate C2 servers,T1090
possible proxy servers (any indicated in the configuration plus system proxies) and C2 servers,T1090
domains give attackers the ability to mask malicious traffic as legitimate activity within the company,T1090
proxy server,T1090
proxy,T1090
– proxy server address and credentials,T1090
proxy server,T1090
collects and sends system information,T1005
OS uptime,T1082
Operating system version and whether it is 32-bit or 64-bit,T1082
Computer name Name of running module PID,T1082
Shellcode version and whether it is 32-bit or 64-bit,T1082
Whether the OS is 32-bit or 64-bit,T1082
Computer name,T1082
collect information about the computer name and OS version and whether it is 32-bit or 64-bit,T1082
Network adapter IP addresses MAC address of one of the adapters,T1016
List of IP addresses,T1016
MAC addresses of network adapters,T1016
Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes.,T1016
collect information about the IP and MAC addresses of the infected machine,T1016
Username,T1033
Username and workgroup,T1033
collect information about the name of the current user,T1033
Transport-level protocol,T1095
Standard TCP connection,T1095
two TCP connections.,T1095
Duplication of socket with TLS connection,T1095
establishes a TCP connection,T1095
messages are exchanged in the original TCP connection (without TLS encryption).,T1095
KCP protocol,T1095
uses KCP on top of a TCP connection,T1095
three ways to connect to the C2 server,T1095
"Transport protocol 3, port 8443 Transport protocol 2, port 80 Transport protocol 1, port 8080",T1095
TcpConnector and TcpBindConnector are classes responsible for connecting over TCP as client and server,T1095
Transport protocols TCP,T1095
RPC (Pipe),T1095
Network-level protocol,T1095
KCP protocol,T1095
KCP protocol,T1095
support for multiple transport protocols for connecting to C2 servers,T1095
use TCP and UDP for C2 connections,T1095
AES-128 is the encryption algorithm used.,T1573.001
is encrypted in the standard way,T1573.001
"encrypted in the backdoor's standard way,",T1573.001
data is encrypted in the standard way,T1573.001
uses AES for encrypting traffic in its backdoors,T1573.001
injectors,T1055
run it in an active process,T1055
running an arbitrary command in a CHM file via an ActiveX object,T1055
runs in a new process,T1055
is injected in a similar way,T1055
injected into,T1055
Crosswalk and Metasploit injectors,T1055
inject shellcode into the process,T1055
SeDebugPrivilege,T1106
finds the API functions it needs,T1106
Microsoft CryptoAPI,T1106
Cryptography API:,T1106
via a ZwCreateSection call,T1106
via ZwMapViewOfSection calls,T1106
execute a method from the .NET assembly,T1106
HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations,T1106
RPCConnector and RPCBindConnector,T1106
TcpBindConnector and HttpBindConnector,T1106
TcpConnector/TcpBindConnector,T1106
CreateThread,T1106
uses various WinAPI functions to run malicious shellcode in the current process or to inject it into another process,T1106
finds the PID of the target process,T1057
Current processes are checked,T1057
Name of running module PID,T1057
injects shellcode into it,T1055
"injects shellcode into the processes explorer.exe, winlogon.exe, wmplayer.exe, svchost.exe, and spoolsv.exe",T1055
archive was distributed,T1105
unpacks an HTML,T1027
is unpacked from the CHM file.,T1027
SFX archive,T1027
unpacks three files,T1027
contents are unpacked,T1027
SFX archiveWhen unpacked,T1027
use VMProtect or custom packers for its malware,T1027
can send system information,T1041
is the library Funny.dll,T1055
dynamically loads the library,T1055
"that contains the library mapistub.dll,",T1055
dynamically loaded from a Base64 constant defined in the main assembly.,T1027
conditional jumps that never run are included,T1027
obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).,T1027
the file is deleted,T1070.004
wiping traces of malware from the system,T1070.004
saved in the registry,T1112
passes control to a.bat.,T1059.003
cleanup script,T1059.003
uses cmd.exe and .bat files to run commands,T1059.003
sends phishing messages with malicious attachments,T1566.001
persists on infected machines by creating new services,T1543.003
uses legitimate utilities to load DLLs,T1574.002
establish C2 connections via a peer-to-peer network of infected hosts,T1090
support C2 connections via an external HTTP/SOCKS proxy,T1090
"using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.",T1106
abusing API calls in the Operating System.,T1106
The malware also decrypts,T1140
the decryption routine,T1140
Decryption routine,T1140
the AES 256 decryption key of the payload,T1140
strings decoded when running,T1140
to decrypt the payload from the .dat file using the AES-256-CTR decryption algorithm and starts to execute.,T1140
injects the payload in memory.,T1055
The malware was injected into a SVCHOST process where a driver location pointed to the config file,T1055
injects it into a process.,T1055
a process injection in one of the svchost processes,T1055
injected themselves into Windows Media Player,T1055
injected code in a process,T1055
the adversary had removed the payload file from the system.,T1027
"Where in the beginning of the campaign the adversary was sloppy, during the last months of activity they became more careful and started to remove evidence",T1027
"Besides the use of Mimikatz to dump credentials,",T1003.001
"acquired through the use of Mimikatz, or creating LSASS dumps,",T1003.001
"using Mimikatz and dumping lsass,",T1003.001
"Using Mimikatz and dumping of lsass,",T1003.001
makes use of the technique “DLL Sideloading”,T1574.002
"When the executable is run, the DLL next to it is loaded.",T1574.002
The dll is run using the command “rundll32.exe,T1218.011
The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.,T1569.002
The DLL embeds several obfuscated strings,T1027
was to start a program as a service,T1543.003
The DLL is used to create a malicious service,T1543.003
". The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.",T1543.003
Adversary installed custom backdoor as a service,T1543.003
Adversary launched backdoor and some tools as a Windows Service,T1543.003
the command line dump of the memory: cmd /c,T1059.003
"When running the file from the command line,",T1059.003
"In some cases, batch (.bat) scripts were created",T1059.003
content in a batch script:,T1059.003
"the exfiltration of data on the system, such as OS, Processor (architecture),",T1082
Username,T1033
WMI activity [T1546.003] was also observed to execute commands on the systems.,T1047
WMI was used for running commands on remote systems,T1047
"From a persistence point of view, scheduled tasks",T1053.005
Adversary ran scheduled tasks for persistence of certain malware samples,T1053.005
and the use of valid accounts,T1078
they were looking to get valid accounts.,T1078
the adversary gained credentials in the network,T1078
the files were exfiltrated over the backdoor,T1041
the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths,T1041
malware exfiltrated data towards a C2,T1041
When the data was gathered on a local system using the backdoor,T1005
and the rar files were deleted,T1070.004
exfiltrated over HTTP using GET requests,T1071.001
HTTP traffic to C2,T1071.001
The packet data was customized and sent through a POST request with several headers towards the C2.,T1071.001
The malware started to open up both UDP and TCP ports to connect with a C2 server,T1095
the customized packet size using a XOR value.,T1573.001
Adversary exploited a web-facing server with application,T1190
the actor established initial access by compromising the victim’s web server,T1190
Tools were transferred to a compromised web-facing server,T1105
Adversary browsed several locations to search for the data they were after.,T1083
including adding of registry keys,T1112
and lateral movement/execution of files,T1570
"the attackers would launch a lateral movement phase, using default Windows credentials",T1078
run a network recognition process to find the IP address of each of the ATMs,T1016
using a variety of encryption schemes and symmetric keys.,T1573.001
to install AnyDesk and provide remote access for the “technician” to install the malware.,T1219
All captured information from the transaction is saved to an encrypted file placed in a directory previously set by the malware configuration,T1074.001
Those files will later be sent to the malware C2 server,T1041
Captured data stored in the uploader C2,T1041
sending all cab files generated from the stolen transactions to the server,T1041
"StartSendScreen, StopSendScreen",T1113
StartSendScreen Start screen capture StopSendScreen Stop screen capture,T1113
Download a file from the remote server,T1105
"StartDownload, StopDownload.",T1105
She Will Execute a specified command via CMD,T1059.003
the files are sent through an HTTP POST request.,T1071.001
Add the process to a startup registry key,T1547.001
malicious OneNote documents to entice users to click on an embedded file to download and execute,T1204.002
a fake message to lure users to execute the HTA file,T1204.002
"Upon clicking the Open button, it drops the HTA file",T1204.002
it prompts the user with a fake message to double-click on open to view the attachment.,T1204.002
The message above the ‘Open’ button instructs the user to “double click” in order to receive the attachment.,T1204.002
The malicious document is delivered in either zip files or ISO images to the target through phishing emails.,T1566.001
the malware author used phishing emails to deliver malicious OneNote document either as attachment,T1566.001
Windows batch script,T1059.003
executes a batch file,T1059.003
the batch file,T1059.003
the malicious batch file,T1059.003
Upon execution of the batch file,T1059.003
launched by cmd.exe,T1059.003
batch file,T1059.003
Embedded Executable Objects In OneNote,T1027
an embedded file gets executed by the user,T1027
The FileData member of the FileDataStoreObject is the key member that holds the embedded data in the OneNote document.,T1027
Embedded data in Data object,T1027
OneNote file contains an embedded HTA attachment,T1027
The OneNote file with the embedded HTA file,T1027
contains the “whoami” command,T1033
make use of the curl utility to download Qakbot and then execute it.,T1105
The HTA file uses curl utility to download,T1105
Curl is used to download the malicious DLL file,T1105
The script will then execute the downloaded file,T1105
downloads the payload from the Internet and executes on the target system.,T1105
Powershell will be invoked and it fetch the Qakbot payload from Internet,T1105
use powershell to download the payload,T1105
executed by rundll32.exe.,T1218.011
The script will then execute the downloaded file with Rundll32.exe,T1218.011
execute it with rundll32.exe,T1218.011
Obfuscated HTA script,T1027
The HTA file contains obfuscated script,T1027
The obfuscated registry is then read by MSHTA and the obfuscated code is,T1027
with obfuscated content,T1027
Deobfuscated HTA content,T1140
code is de-obfuscated,T1140
Base64 Decoded instructions in dropper,T1140
The base64 decoded batch file,T1140
then deletes the registry key,T1112
creates a registry key in HKEY_CURRENT_USER\SOFTWARE\,T1112
A closer look at the document reveals the graphical elements are all images placed in a layered style by the malicious actor.,T1027
enumerate files and folders,T1083
"It then performs SQL queries to retrieve files, file size, folders",T1083
Many of the hosts used to support these second-stage operations hosted RDP services,T1021.001
can run commands that will download files,T1105
"web she will with filenames that masquerade as human.aspx, which is a legitimate component of the MOVEit Transfer software.",T1036.005
several POST requests,T1071.001
large volumes of files have been stolen from victims' MOVEit transfer systems.,T1005
"The threat actors also moved laterally to the domain controller, compromised credentials",T1078
implanted Ngrok reverse proxies,T1090
The actors used Ngrok to proxy RDP connections and to perform command and control.,T1090
the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organization’s unpatched VMware Horizon server,T1190
The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server.,T1190
added an exclusion rule to Windows Defender,T1562.001
added an exclusion rule to Windows Defender.,T1562.001
The actors added an exclusion rule to Windows Defender.,T1562.001
"The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools",T1562.001
The actors manually disabled Windows Defender via the GUI.,T1562.001
"The exclusion rule allowlisted the entire c:\drive, enabling threat actors to download tools to the c:\drive without virus scans.",T1562.001
manually disabled Windows Defender via the Graphical User Interface (GUI),T1562.001
The Scheduled Task was named RuntimeBrokerService.exe,T1053.005
created a Scheduled Task,T1053.005
The actors’ exploit payload created Scheduled Task,T1053.005
the actors used RDP,T1021.001
RDP sessions,T1021.001
the actors leveraged RDP to propagate to several hosts within the network.,T1021.001
The actors used RDP to move laterally to multiple hosts on the network.,T1021.001
RDP connections,T1021.001
and the built-in Windows user account DefaultAccount [T1078.001] to move laterally,T1078
The actors used built-in Windows user account DefaultAccount.,T1078
Mimikatz – a credential theft tool.,T1003.001
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials,T1003.001
the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process,T1003.001
trying to dump LSASS process.,T1003.001
The actors used Mimikatz to harvest credentials.,T1003.001
Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain,T1090
"The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network",T1090
The actors downloaded the following tools,T1105
to download next stage and execute it,T1105
The exploit payload then downloaded mdeploy.text,T1105
The actors downloaded malware and multiple tools to the network,T1105
as outgoing HTTPS port 443 connections,T1071.001
The actors removed malicious file mde.ps1 from the dis.,T1070.004
removed mde.ps1 from the disk,T1070.004
$BASE64 encoded payload,T1027
recording files to be uploaded when their download is requested by the C2 server.,T1041
and uploads it back to the server.,T1041
uploads it to the C2 server.,T1041
sends it to the C2 server.,T1041
sends it to the C2 server.,T1041
Upload a recording file with a specified name to the C2 server.,T1041
data to be exfiltrated to the C2 server,T1041
sends data to the C2 server,T1041
Sends the shellcode execution results to the C2 server,T1041
decrypts the next loader stage,T1140
decrypts it,T1140
Decrypts,T1140
decryption procedure,T1140
Decrypts,T1140
shellcode decrypts,T1140
After decrypting,T1140
decrypts the Orchestrator,T1140
decodes the directory path,T1140
decrypts the hidden page,T1140
decrypting them on the fly.,T1140
decrypts it with XOR,T1140
Decrypts the Trojan with a XOR-based cipher,T1140
The decryption key,T1140
injects the Trojan loader into exe.,T1055
can be injected to processes,T1055
The malware injects the ProcessWorm into all processes running on the system,T1055
injects itself into processes,T1055
injects the ProcessWorm if needed.,T1055
injects the ProcessWorm into processes,T1055
is injected into all running processes.,T1055
injecting code,T1055
The injected Trojan loader,T1055
collects specific system information,T1082
Returns information about the machine’s BIOS.,T1082
Returns information about the operating system,T1082
computer name,T1082
Overall available space Space available to current user (may be less than overall available space due to quotas) Disk capacity,T1082
Returns information about the computer system,T1082
checks if it is running on a 64-bit system,T1082
Returns OSVERSIONINFOEXW and SYSTEM_INFO structures,T1082
the current process name,T1057
Returns the list of running processes,T1057
Returns ProcessDebugPort value returned by NtQueryInformationProcess for current process.,T1057
Returns ProcessDebugObjectHandle value returned by NtQueryInformationProcess for current process,T1057
"Returns process names of the current process tree (i.e. the current process, the parent process, the grandparent process, etc.)",T1057
obtains the list of processes,T1057
extract specific information about running processes,T1057
regularly obtains the list of running processes.,T1057
examines all the processes on the system,T1057
looks for specific processes,T1057
"acquires handles for all running processes on the system, which results in either winlogon.exe or explorer.exe obtaining numerous process handles.",T1057
When it detects a starting first (or a stopping last) instance of a process from the list,T1057
running processes,T1057
a part of code from the .text section (roughly 8 KB) is overwritten with heavily obfuscated code,T1027
obfuscated code,T1027
obfuscated trampoline in the .text section.,T1027
This trampoline is protected with an obfuscator,T1027
obfuscated with FinSpy Mutator,T1027
This module is an obfuscated shellcode.,T1027
obfuscated DLL,T1027
obfuscated with FinSpy VM.,T1027
It is encrypted with a 256-byte RC4 key.,T1027
conceals memory areas that contain the Trojan components’ code and data.,T1027
encrypts the Orchestrator’s pages with a cipher based on XOR and ROL operations and assigns the PAGE_NOACCESS attribute to them,T1027
protected with an obfuscator,T1027
An obfuscator similar to OLLVM is used to protect FinSpy,T1027
It is obfuscated with a protector resembling the open source OLLVM obfuscator.,T1027
The encrypted VFS file.,T1027
"The setup configuration file, which is encrypted with RC4",T1027
an obfuscator resembling OLLVM or both these protectors,T1027
a call to the CreateWindowExW,T1106
the NtTerminateProcess and ExitProcess functions,T1106
CreateFileW API.,T1106
API function,T1106
various WinAPI functions.,T1106
low-level API functions (such as NtEnumerateValueKey or NtQuerySystemInformation),T1106
NtTestAlert function,T1106
call the NtTestAlert function,T1106
NtTestAlert function,T1106
CreateProcessInternalW API function,T1106
NtQueueAPCThread function,T1106
KiUserExceptionDispatcher function,T1106
WinAPI file manipulation functions.,T1106
calling API functions from this library,T1106
hooks the kernel’s PsCreateSystemThread function,T1106
launches a slightly modified Metasploit Reverse HTTPS stager,T1071.001
connects to a configured C2 server using HTTPS for communication.,T1071.001
Makes an initial POST request to the C2 server,T1071.001
to the C2 server via a POST request.,T1071.001
All communications between the server are encrypted with RC4,T1573.001
encrypted with RC4,T1573.001
A snippet of the RC4 key generation function,T1573.001
"Returns the list of network adapter types, IP and MAC addresses assigned to them.",T1016
Returns names of shortcuts in the Desktop directory.,T1083
Returns the path to the ‘Program Files’ folder.,T1083
Returns the short form of the user’s profile folder,T1083
Returns the user’s profile folder,T1083
Returns the list of object names in the \GLOBAL?? directory.,T1083
Retrieve the list of files,T1083
gets the list of recent files,T1083
"search, delete files.",T1083
file listings,T1083
Create file listing recordings,T1083
Returns the path to the user’s temporary folder.,T1083
Returns the current domain SID,T1033
Returns the current user’s name,T1033
Returns the current user’s SID.,T1033
WMI query,T1047
Creates a scheduled task that runs at system startup,T1053.005
The Task Scheduler launches it at system startup,T1053.005
scheduled task properties,T1053.005
a DLL obfuscated with VMProtect.,T1027
unpacking the Orchestrator,T1027
unpacks it with aPLib.,T1027
Orchestrator is unpacked,T1027
The Orchestrator (as well as plugins) are packed with aPLib and encrypted with AES.,T1027
unpacks with aPLib,T1027
encrypted with XOR and compressed with aPLib.,T1027
unpacks it with aPLib,T1027
takes a screenshot,T1113
screenshots,T1113
screen,T1113
"take screenshots during, online conversations.",T1113
Capture the screen area around mouse click locations,T1113
"Take screenshots with a specified frame rate, and livestream or record them.",T1113
screenshots,T1113
Commands are used to download and install plugins,T1105
Commands are used to download and run the Trojan Installer.,T1105
"Upload, download",T1105
downloading and executing specific utilities,T1105
downloads Security Shellcodes from the C2 server,T1105
may save recording files in the working directory,T1074.001
stored in the working directory,T1074.001
the malware’s working directory,T1074.001
"Once the working directory is prepared,",T1074.001
keylogs,T1056.001
keystrokes,T1056.001
record keystrokes,T1056.001
Delete a recording with a given filename from the system.,T1070.004
Uninstall the backdoor.,T1070.004
wipes all the files and registry keys created by the backdoor,T1070.004
delete files.,T1070.004
creating an APC (Asynchronous Procedure Call) with the procedure address pointing to the start of the shellcode.,T1055
APC injections,T1055
The asynchronous procedure places a hook on the NtTestAlert function and then exits,T1055
will be loaded with the help of the APC injection loader.,T1055
the hooked process creation function clears a possible hook of the NtQueueAPCThread function and then uses it to create an APC procedure in the new process.,T1055
junk code created by the ProcessWorm loader,T1027
entries point to buffers of randomly generated junk code,T1027
method names contain junk.,T1027
The executable is prepended with 0x4000 random bytes and encrypted with RC4,T1027
documents sent to the printer.,T1005
Steal files which are printed by the victim,T1005
recently opened documents,T1005
Uninstall a plugin from the machine,T1027
Sets up persistence by creating an entry in the HKCU\Software\Microsoft\Windows\CurrentVersion\Run registry key.,T1547.001
adds it to the HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run key,T1547.001
Bash script,T1059.003
launched on every startup by rundll32.exe,T1218.011
creates a thread in the kernel that injects the next stage into winlogon.exe.,T1055
A thread with trampoline shellcode is created inside exe.,T1055
The victim downloads a Trojanized application and executes it.,T1204.002
TeamViewer,T1219
Cleans API functions potentially hooked by security solutions,T1562.001
has operated sites on the Tor network using the following .onion,T1090
this key is typically obfuscated with AES 256 encryption.,T1027
encrypted PowerShell.,T1027
"Upon execution, the ransomware binary deletes itself",T1070.004
Creating the HKCU\Software\Zeppelin registry key,T1112
by modifying the Registry.,T1112
valid credentials have been used by Vice Society to gain initial access.,T1078
"Internet-facing applications and systems vulnerabilities can be exploited, such as PrintNightmare (CVE-2021-1675) and (CVE-2021-34527), to gain initial access.",T1190
Batch files are used,T1059.003
features multiple flags that could be set as command line arguments,T1059.003
Persistence is maintained after boot/reboot via malicious autostart registry keys.,T1547.001
utilizes legitimate programs to side-load the group’s own DLL to execute their payload.,T1574.002
Malicious commands are executed via WMI as a means of “living off the land” and avoiding detection.,T1047
execute commands via scheduled tasks/jobs.,T1053.005
Files dropped in the victim’s environment by Vice Society may have been altered to appear legitimate.,T1036.005
attempts to disable Windows Defender,T1562.001
"Attempts to disable or modify endpoint security, such as Microsoft Defender, on compromised devices.",T1562.001
utilizes comsvcs.dll to dump credentials from Local Security Authority Subsystem Service.,T1003.001
RDP is used by the group for lateral movement.,T1021.001
"Lateral tool transfers have been used to move tools and files from one compromised system to another, including SMB and RDP.",T1570
to exfiltrate data to external C2 servers.,T1041
to exfiltrate data directly to C2 servers.,T1041
Tools such as SystemBC and proprietary backdoors are known to be used,T1219
"Legitimate processes have been corrupted by Vice Society via code injection, as a means to evade defenses.",T1055
"malware is designed to steal sensitive information from victims' systems,",T1005
attackers used an innocent-looking email to lure victims into opening an attachment.,T1566.001
"we found the original email that included a ZIP file attached, which contained an ISO file.",T1566.001
sample uses obfuscation,T1027
This file is an obfuscated .NET file,T1027
only uses one code obfuscation technique: API hashing.,T1027
Payload Obfuscation,T1027
"each data byte in the HTTP based C2 communication,",T1071.001
submitted to the C2 server through HTTP protocol using the POST method.,T1071.001
the HTTP C2 Communication section.,T1071.001
HTTP C2 Communication,T1071.001
to the C2 through the HTTP protocol.,T1071.001
can be found in the two bytes of the HTTP payload,T1071.001
shows a HTTP POST request and its corresponding message body.,T1071.001
"the Content-Key, which is a custom HTTP header whose value corresponds to a hash generated out of the HTTP header.",T1071.001
HTTP POST request (type 27 / data exfiltration).,T1071.001
then uploads this information to an attacker-controlled machine via HTTP POST.,T1041
exfiltrates information to the C2 through the HTTP protocol.,T1041
HTTP POST request (type 27 / data exfiltration).,T1041
an ISO file opener that mounts and opens the file with a simple double-click.,T1204.002
"To the victim, the opening process simply looks like a regular directory.",T1204.002
"obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code.",T1055
process hollowing was used to inject a malicious PE file into the legitimate process called aspnet_compiler.exe.,T1055
use this technique to retrieve export functions from loaded libraries,T1106
the corresponding APIs in the appropriate library.,T1106
via the MoveFileExW or CopyFileW Windows API.,T1106
"Then, it creates and sets a new value for the registry key HKCU\Software\Microsoft\Windows\CurrentVersion\Run.",T1547.001
"In order to establish persistence on the targeted host, the malware starts by saving a copy of itself in a new folder in the %APPDATA% directory",T1547.001
searches for and exfiltrates the following information: OS architecture Built-in admin Domain host name Hostname Local admin Operating system Screen resolution,T1082
Username information,T1033
Exfiltrate keylogger data,T1056.001
Keylogger database,T1056.001
can use additional payload types,T1105
Exfiltrate screenshots,T1113
"It collects sensitive data from web browsers,",T1552.001
"These functions are made to steal credentials from different types of applications and services on the Windows operating system: Browsers: Safari, Internet Explorer, Firefox and Chromium-based browsers",T1552.001
adopting publicly disclosed proof-of-concept (POC) code shortly after it is released to exploit vulnerabilities in internet-facing applications.,T1190
"their initial exploitation of vulnerable internet-facing applications,",T1190
"continues to use older vulnerabilities, especially Log4Shell, to compromise unpatched devices",T1190
"After gaining initial access to an organization by exploiting a vulnerability with a public POC,",T1190
as several adversaries are exploiting CVE-2022-47966 for initial access. Apache Log4j2 (aka Log4Shell),T1190
enable RDP connections.,T1021.001
can use the Active Directory database to access credentials for users’ accounts.,T1078
"credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,",T1078
The actors could also gain access to other systems where individuals may have reused their passwords.,T1078
to persist in target environments and deploy additional tools.,T1105
backdoor with the ability to download and run additional tools,T1105
create scheduled tasks for persistence.,T1053.005
Scheduled Task Creation or,T1053.005
Remote Task Creation/Update using Schtasks Process,T1053.005
"the group crafts bespoke phishing emails, often purporting to contain information on security policies that affect countries in the Middle East, to deliver weaponized documents to individuals of interest.",T1566.001
"can read files,",T1083
"gather information on an infected host, and send details back to the attackers.",T1005
Commands executed by WMI on new hosts,T1047
script to deobfuscate the control flow of shellcode,T1140
Malware immediately decrypts the third layer,T1140
it decrypts the c2 URL,T1140
Use NtQueryInformationProcess API,T1140
"It decrypts an encrypted payload,",T1140
Payload decryption function.,T1140
the payload decryption key,T1140
deobfuscated code of GuLoader’s shellcode.,T1140
using stack to decrypt strings,T1140
script to restore deobfuscate control flow.,T1140
control flow obfuscation,T1027
encrypted shellcode’s file,T1027
encrypted payload from c2.,T1027
obfuscated arithmetic value calculations,T1027
an encrypted payload,T1027
shellcode control flow obfuscation,T1027
control flow obfuscation.,T1027
Unpacking of GuLoader’s shellcodes.,T1027
packed using NSIS installer.,T1027
UNPACKING GULOADER’S SHELLCODE,T1027
It then calls CallWindowProcW API.,T1106
Uses EnumWindows API,T1106
Uses EnumDeviceDrivers and GetDeviceDriverBaseNameA APIs.,T1106
Uses MsiEnumProductsA and MsiGetProductInfoA APIs.,T1106
Uses OpenSCManagerA and EnumServicesStatusA APIs.,T1106
Uses NtSetInformationThread API,T1106
DbgBreakPoint and DbgUiRemoteBreakin API,T1106
it starts payload execution using the ZwCreateThreadEx API.,T1106
call RtlAddVectoredExceptionHandler API,T1106
"This shellcode has complex obfuscation, consisting of junk code",T1027
dynamic API resolution,T1027
use process hollowing to inject decrypted payload into child process and resolves its Import Address Table.,T1055
"DLL sideloading,",T1574.002
"program first sideloads u2ec.dll, which then loads the payload file usb.ini",T1574.002
malware rzlog4cpp.dll is sideloaded,T1574.002
which is used for the first sideloading.,T1574.002
including the use of DLL sideloading,T1574.002
"Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.",T1574.002
First-stage legitimate executable for DLL sideloading,T1574.002
Second-stage legitimate executable for DLL sideloading,T1574.002
files have XOR-encrypted content to prevent detection,T1027
contains another payload that is XOR-encrypted,T1027
applies obfuscation techniques,T1027
reads the encrypted configuration filecan,T1027
an encrypted configuration.,T1027
the logging strings are encrypted with a single byte in XOR operations as,T1027
and obfuscation mechanisms.,T1027
an increasing number of obfuscations are being adopted to thwart static analysis.,T1027
containing one-byte XOR encrypted sections,T1027
"will decrypt this file with a single byte in XOR operations, find the PE header, and drop the payload to the specified path.",T1140
after decrypting the frData member in,T1140
The decryption function,T1140
It will then decrypt the encrypted payload with the predefined RC4 key,T1140
"After decryption, it then checks if the first byte of the decrypted payload",T1140
The decrypted payload,T1140
"After this is decrypted,",T1140
The malware will continue to read and decrypt goopdate,T1140
C&C traffic of the PUBLOAD HTTP variant,T1071.001
"it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices",T1071.001
malware that communicates over the MQTT protocol.,T1071.001
Command codes in the PUBLOAD HTTP variant,T1071.001
HTTP variant,T1071.001
HTTP variant,T1071.001
"The data in the HTTP body is the same as the past variant,",T1071.001
HTTP variant,T1071.001
supports data upload,T1105
the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server,T1105
PowerShell downloading malware,T1105
The certutil.exe program downloads the WinRAR binary,T1105
the threat actors used PowerShell to download multiple malware and archives from the server,T1105
command execution.,T1059.003
its she will open command.,T1059.003
create a reverse she will.,T1059.003
It will then create a reverse she will via ncat.exe to the server,T1059.003
backdoor that is capable of executing commands,T1059.003
including adding more command-line arguments,T1059.003
"also supports command-line arguments,",T1059.003
we discovered several tools used for UAC bypass in Windows 10.,T1548.002
HackTool.Win32.ABPASS is a tool used to bypass UAC in Windows 10.,T1548.002
HackTool.Win32.CCPASS is another tool that is also used for Windows 10 UAC bypass,T1548.002
This service has the highest privileges that can be abused for Windows 10 UAC bypass.,T1548.002
UAC bypass will be executed via the AppInfo RPC service.,T1548.002
UAC Bypass via the CMSTPLUA COM interface,T1548.002
UAC Bypass via the AppInfo RPC service,T1548.002
UAC bypass will be executed,T1548.002
UAC bypass is executed via token manipulation.,T1548.002
UAC bypass is executed,T1548.002
net user <username>,T1033
and the following data is written into registry:,T1112
Registry keys changed,T1112
It creates a new She Will in the registry.,T1112
it installs itself to %programdata% and then sets the registry run key for persistence.,T1112
It invokes the undocumented API UserAssocSet to update the file association.,T1106
strings and the APIs used by,T1106
It installs itself by creating an InstallSvc service,T1543.003
creating aservice called InstallSvc,T1543.003
Creates a service,T1543.003
which is injected to conduct backdoor behaviors.,T1055
and inject it into winver.exe for the next-stage payload,T1055
"It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.",T1055
It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).,T1095
Delete file,T1070.004
Delete file,T1070.004
Keystrokes and windows monitoring,T1056.001
Monitor keystrokes and windows,T1056.001
Keylogging,T1056.001
will check if the running processes,T1057
will check if the process avp.exe exists.,T1057
It sets up a run key for via the command C:\ProgramData\GoogleUpdate\googleupdate.exe work for persistence.,T1547.001
It sets up a run key for the command C:\programdata\netsky\netsky.exe online for persistence.,T1547.001
Sets Run Key with “work/online”,T1547.001
It installs itself by creating aservice called InstallSvc which will trigger “C:\programdata\netsky\netsky.exe online”.,T1569.002
"malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.",T1573.001
"Regardless of whether the file content is compressed or not, it will be encrypted in XOR operations with a specific string",T1573.001
Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.,T1204.002
Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.,T1566.001
that had the remote desktop service enabled.,T1021.001
and the creation of a schedule task.,T1053.005
conceal its true code through either encryption or compression,T1027
make the malicious payload smaller and avoid detection based on static malware analysis techniques,T1027
UPX is an open-source packing algorithm,T1027
MPRESS is a free packer.,T1027
Andromeda is a custom packer,T1027
"compress (and if it has the functionality of a crypter also encrypts) the original executable, which is saved in one of the sections of the final packed file.",T1027
"entry point of the original file is relocated, and so is the Import Address Table (IAT).",T1027
"change the final payload’s section names,",T1027
have very few imports as they do not rely on external libraries,T1027
"allocate memory, change permissions, read the encrypted/packed chunk of code, decrypt it, load it to the allocated memory space and execute it",T1027
use system calls,T1027
VirtualAlloc used for allocating memory in the current process,T1027
VirtualProtect changes the permissions of the given virtual address.,T1027
RtlDecompressBuffer decompresses the provided buffer.,T1027
CreateProcessInternalW creates a new process.,T1027
can create a new threat with the malicious unpacked payload.,T1027
"initial code usually called a stub, decrypts or decompresses the real code",T1140
stub is a small part of code that implements the decompression (and decryption) of the originally packed file,T1140
the payload of the malware can be part of the loader’s file,T1027
strongly indicates that it contains another component that is dropped/loaded.,T1027
"it can be downloaded from a remote location (by the loader, also known as a Downloader).",T1105
use system calls,T1106
VirtualAlloc used for allocating memory in the current process,T1106
VirtualProtect changes the permissions of the given virtual address,T1106
RtlDecompressBuffer decompresses the provided buffer.,T1106
CreateProcessInternalW creates a new process,T1106
"not see them in the imported function list, and they not even be part of the strings in the sample.",T1027
try to hide these system calls,T1027
function and the corresponding library are dynamically loaded at runtime – also known as explicit linking,T1027
this executable then downloads and executes additional payloads,T1105
This executable binary insecurely downloads and executes additional payloads from the Internet.,T1105
Downloading and running further executables,T1105
It downloads and runs an executable payload,T1105
This is a Windows Native Binary executable embedded inside of UEFI firmware binary,T1027
This Windows executable is embedded into UEFI firmware,T1027
the embedded Windows executable,T1027
an embedded executable,T1027
This executable uses the Windows Native API,T1106
It then sets registry entries,T1112
to run this executable as a Windows Service.,T1569.002
when using the HTTPS-enabled options,T1071.001
implants made their native Windows executables look like legitimate update tools.,T1036.005
the Windows payload was named “IntelUpdater.exe”,T1036.005
Capturing screenshots,T1113
Real-time screen monitoring,T1113
a legitimate tool which is frequently used by bad actors for malicious purposes in ways similar to TeamViewer,T1219
"NetSupport Manager, used maliciously or otherwise, provides full and complete control over the target device.",T1219
"As NetSupport Manager is a legitimate tool that has a long history of development, it is highly attractive to attackers as it can be relied on to work ‘out of the box’.",T1219
"has been observed in multiple ISO files masquerading as legitimate software,",T1036.005
The RAT installation is disguised to look similar to a Google Chrome installation.,T1036.005
RAT installer disguised as Google Chrome setup,T1036.005
threat actors are able to masquerade the dropper or installer,T1036.005
The sample is obfuscated via the Babadeda crypter.,T1027
a base64 encoded string is used to specify various parameters,T1027
Base64 encoded RAT execution command,T1027
"Persistence for the RAT is achieved via registry entry, and a shortcut to the installed RAT executable is written to the Startup folder.",T1547.001
Persistence via Scheduled Task,T1053.005
"In addition, the sample generates a scheduled task with multiple triggers.",T1053.005
Network adapter details are pulled via GetAdaptersAddresses,T1016
Additional data is gleaned via WMI queries,T1047
SELECT * FROM Win32_ComputerSystem,T1082
all running processes are enumerated and logged via EnumProcesses (32-bit processes).,T1057
has the ability to drop and execute additional components.,T1105
These files are all self-deleted after launch,T1070.004
threat actors using this tool are very quick to update their lures and find ways to entice their victims into installing the malicious remote control software.,T1204.002
decoded command,T1140
Downloads the miner and watcher.,T1105
then a malware downloader is uploaded to the device,T1105
Reconfigures Windows Defender to exclude the user profile path and the entire system drive from scanning.,T1562.001
"its “intelligent” way of brute forcing: it checks the prompt and, based on the prompt, it selects the appropriate credentials.",T1110
This method speeds up the brute forcing process,T1110
“intelligent brute forcing”,T1110
then determines the processor architecture,T1082
"Is able to steal/gather information on CPU type, screen resolution",T1082
"The downloading of the actual malware is done via a variety of possible commands (for example, wget, curl, tftp and ftpget).",T1570
via the she will “echo” commands.,T1059.003
keystroke,T1056.001
download a malicious file,T1204.002
executes a malicious script,T1204.002
"JavaScript is the module that has to be manually executed by the victim,",T1204.002
zip archive,T1027
comes with an embedded PE payload,T1027
PE is stored as a Base64 encoded string,T1027
"stored as a list of registry keys, yet we also observed a variant in which similar content was written into a TXT file.",T1027
obfuscated Powershell script that runs another Base64 obfuscated layer that finally decodes the .NET payload.,T1027
embedded inside as a base64 encoded buffer,T1027
In its resources we can find another PE,T1027
been obfuscated in order to hide its real intentions,T1027
"Base64 encoded string, and in the other as a hexadecimal string",T1027
PE file was encoded as an obfuscated hexadecimal string.,T1027
Base64 encoded script,T1027
Base64,T1027
obfuscated by XOR,T1027
three layers where one decodes content for the next,T1140
decodes the next element:,T1140
deobfuscates and runs another block of code,T1140
deobfuscate it.,T1140
decodes it,T1140
deobfuscate the file,T1140
decoding,T1140
decoding,T1140
Decoded content,T1140
Decoded content,T1140
deobfuscates,T1140
was decoded,T1140
"decoding the base64-encoded content,",T1140
decompressed,T1140
reading/writing registry keys,T1112
"written to the registry, as a list of keys.",T1112
JavaScript fetched from the C2 server,T1105
downloaded code chunk,T1105
GET request with C2 server,T1071.001
Process Hollowing – one of the classic methods of PE injection,T1055
"PE injection, manual loading into the parent process",T1055
fetches IcedID from a remote resource,T1105
Malicious OneNote attachment,T1566.001
"The “Forked” version of the malware loader first appeared in February 2023, distributed directly through thousands of personalized invoice-themed phishing emails.",T1566.001
These messages used Microsoft OneNote attachments (.one) to execute a malicious HTA file,T1566.001
string-decryption code,T1140
sending basic host info to the C2,T1041
"took place over an unencrypted HTTP channel, the network traffic was plainly visible.",T1071.001
"When the user double clicks or opens the lnk file,",T1204.002
lures the user to open a document.lnk file which will execute the malicious DLL loader,T1204.002
"The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks",T1204.002
"then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).",T1055
"From these injected processes,",T1055
the different processes they injected into,T1055
a process where Cobalt Strike was injected into,T1055
The process injection technique was used multiple times to inject into different processes,T1055
Almost every post-exploitation job was launched from an injected process.,T1055
a process where the threat actors injected:,T1055
where they were previously injected into,T1055
Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account,T1055
previously injected into,T1055
"Process injections in svchost process via CreateRemoteThread, Default named pipes, etc",T1055
processes which threat actors injected into:,T1055
"After injecting into various processes on the host,",T1055
various injections across hosts,T1055
injected into multiple processes on different hosts.,T1055
the threat actors began discovery tasks using Windows utilities,T1059.003
These batch scripts’ purposes,T1059.003
then two batch scripts were dropped and run.,T1059.003
using the following command line: C:\Windows\System32\cmd.exe /c,T1059.003
C:\Windows\system32\cmd.exe /C powershell.exe -nop -w hidden -c,T1059.003
launching the getsystem command in the wrong console (she will console rather than the beacon console).,T1059.003
C:\Windows\system32\cmd.exe /C getsystem,T1059.003
cmd.exe /C,T1059.003
C :\Windows\system32\cmd.exe /C she will,T1059.003
Threat actors used two scripts named s.bat (for servers) and w.bat,T1059.003
bat script:,T1059.003
bat script:,T1059.003
using Windows utilities like ping and tasklist.,T1057
tasklist,T1057
tasklist was also used in order to enumerate processes on multiple hosts remotely,T1057
process list,T1057
the threat actor started their first lateral movement using RDP,T1021.001
they accessed the server via RDP,T1021.001
"Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:",T1021.001
the threat actor started their first lateral movement using RDP to pivot to a server using the local Administrator account.,T1078
the first lateral movement from the beachhead to the server using RDP with an Administrator account:,T1078
and again on a server with Administrator privileges.,T1078
using the Administrator account each time,T1078
"to execute Procdump, which was used to dump lsass.",T1003.001
"they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.",T1003.001
dumping their LSASS process,T1003.001
LSASS Dump,T1003.001
Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique,T1003.001
C:\programdata\procdump64.exe -accepteula -ma lsass.exe C:\ProgramData\lsass.dmp,T1003.001
"Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS,",T1003.001
"Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the ProgramData folders on multiple hosts in the environment.",T1570
"Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server:",T1570
The threat actors also transferred ProcDump from the beachhead to multiple workstations:,T1570
This first lateral movement was performed in order to drop and install AnyDesk.,T1570
threat actors remotely dropped AnyDesk binary on a server from the beachhead:,T1570
used PowerShell to download and execute,T1105
which downloaded obfuscated PowerShell and executed it in memory:,T1105
"just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon",T1105
dropping and the execution of several payloads using multiple techniques,T1105
"threat actors used CS as the main Command and Control tool, dropped several payloads,",T1105
the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.,T1569.002
"C:\Windows\System32\cmd.exe /c start rundll32 namr.dll,IternalJob",T1218.011
Sysmon File Created event showing wab.exe created by rundll32.exe,T1218.011
cmd.exe /C rundll32.exe,T1218.011
C:\Windows\System32\rundll32.exe,T1218.011
"Because rundll32.exe executed PowerShell, we can see that rundll32.exe created",T1218.011
were initiated from the rundll32.exe process,T1218.011
The random (PsExec) service runs a rundll32.exe process without any arguments.,T1218.011
"The metadata included TA machine’s hostname,",T1082
systeminfo,T1082
"wmic product get name,version",T1082
“Display information about current Windows version,T1082
MAC address,T1016
ipconfig /all,T1016
showing wab.exe executed by WMI,T1047
wmic /node,T1047
wmic,T1047
obfuscated PowerShell,T1027
"Once deobfuscated,",T1140
its installation as a service was used in order to persist and create a backdoor to the network.,T1543.003
the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.,T1543.003
"a remote service was created with random alphanumeric characters, service name and service file name",T1543.003
Below is an example of the service edc603a that was created,T1543.003
A new service was created,T1543.003
Threat actors obtained and abused credentials of privilege domain accounts,T1078
"A service account, with Domain Administration permissions, was used to create a remote service on a Domain Controller to move laterally.",T1078
the service account logged into one of the Domain Controllers from the beachhead.,T1078
"We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.",T1027
ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:,T1027
"Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:",T1027
whoami,T1033
C :\Windows\system32\cmd.exe /C she will whoami /all,T1033
the win32 function CreateServiceA was used by the malware,T1106
The account used to perform this lateral movement,T1078
Threat actors executed this tool on patient 0 with low-level privileges multiple times,T1078
"The threat actor then deployed Anydesk, which was the only observed persistence mechanism used during the intrusion.",T1219
they accessed the server via Anydesk.,T1219
AnyDesk and its installation as a service was used,T1219
"AnyDesk logs, %ProgramData%\AnyDesk\ad_svc.trace and %AppData%\AnyDesk\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion",T1219
"The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.",T1566.001
Threat actors also created a remote thread in svchost.exe,T1055
"Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:",T1055
the service account password was weak and cracked offline by threat actors.,T1110
Named pipes were created in order to establish communication between CS processes,T1090
Named piped are commonly used by Cobalt Strike perform various techniques.,T1090
used CMD-based scripts,T1059.003
CMD-based scripts,T1059.003
CMD-based scripts,T1059.003
gets executed via the “SHELLEXECUTE”.,T1059.003
The first .CMD file set seen to use AutoIt in its execution,T1059.003
Each email has an HTML attachment.,T1566.001
"The email text employs scare tactics, such as evidence of a traffic violation, prompting the user to open the HTML attachment",T1566.001
prompting the user to open the HTML attachment,T1204.002
contains some junk code and data in HEX format.,T1027
The data blob in HEX decodes,T1140
slightly obfuscated URL address,T1027
two base64 encoded data blobs and code instructions for its execution.,T1027
base64 data block execution,T1027
The first base64 data blob,T1027
All data is then sent back to the attacker's C2,T1041
the attacker's C2 via the HTTP POST method.,T1071.001
The C2 is constructed with the victim's enumerated data,T1005
"extract sensitive information,",T1005
operating system version,T1082
OS architecture (x86 or x64),T1082
keyboard layout,T1082
Opening the attached “multa_de_transito_502323.html” file triggers the embedded JavaScript,T1027
download a “.VBS” file,T1105
It proceeds by downloading the “sqlite3.dll” file,T1105
"to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys",T1012
exploiting vulnerable web-facing devices,T1190
"exfiltrate proprietary or confidential information,",T1005
decrypting a shellcode,T1140
starts by decrypting its initial configuration data,T1140
It starts its code by decrypting its initial configuration,T1140
the code of the decryption algorithm used by RedLine Stealer to decrypt its initial configuration data,T1140
Once the initial configuration data has been decrypted,T1140
to decrypt the password stored,T1140
"Once the master key is decrypted,",T1140
to decrypt it using AES GCM algorithm,T1140
The decrypted password,T1140
Try to disable Windows Defender service “WinDefend”,T1562.001
Try to disable Tamper Protection settings of Windows Defender,T1562.001
"Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender.",T1562.001
"Disable Windows update services such as (“wuauserv”, “WaaSMedicSvc”, “UsoSvc”)",T1562.001
Disable Automatic Update and change Windows configurations related to Windows Update,T1562.001
which is often encoded or encrypted to prevent detection,T1027
combination of Base64 and XOR functions.,T1027
The master key is encoded with Base64 and encrypted,T1027
to grab the encoded and encrypted master key,T1027
it will parse the AES IV (Initialization vector) and the encrypted password,T1027
to steal information from the compromised or targeted host,T1005
has the ability to collect or extract various types of system information from a targeted or compromised computer,T1082
func_GetHostSerialNumber(),T1082
host serial number,T1082
"Retrieves system default language, timezone and OS version",T1082
"Get processor information of the compromised host by executing ""SELECT * FROM Win32_Processor""",T1082
func_GetProcessor(),T1082
func_GetLanguageTimeZoneOsVersion(),T1082
func_GetGraphicCards,T1082
"Get AdapterRAM and Graphic Card Name and type by executing ""root\\CIMV2"", ""SELECT * FROM Win32_VideoController""",T1082
func_GetTotalRAM(),T1082
"Get the total RAM size of compromised host by executing ""SELECT * FROM Win32_OperatingSystem"" and look for ""TotalVisibleMemorySize""",T1082
"Retrieve the user domain name, username",T1033
Get the user name of the compromised host,T1033
func_GetUserName(),T1033
"Parse firewall and Anti Virus Product install in the compromised host by running ""SELECT * FROM ROOT\\SecurityCenter2"" ""SELECT * FROM ROOT\\SecurityCenter"" ""SELECT * FROM AntivirusProduct"" ""SELECT * FROM FirewallProduct"" ""SELECT * FROM AntiSpyWareProduct""",T1518.001
func_GetFirewalls(),T1518.001
func_ListProcesses(),T1057
Retrieve process list and process information by running 'SELECT * FROM Win32_Process',T1057
Screen Capture,T1113
func_ScanScreen() is the one responsible for this screen capture capability,T1113
has a functionality to capture a screenshot of the targeted or compromised host as part of its data collection and exfiltration,T1113
uses .NET Graphics class CopyFromScreen Function() to transfer a bit block of color data from the screen to the Graphic drawing surface that will be saved in memory stream for data exfiltration.,T1113
Parse all installed application in the compromised host by querying 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall' registry,T1012
"Parse browser application and browser version installed in the compromised host by querying ""SOFTWARE\WOW6432Node\Clients\StartMenuInternet"" or ""SOFTWARE\Clients\StartMenuInternet"" registry",T1012
uses .NET Graphics class CopyFromScreen Function(),T1106
using Windows CryptProtectData() API.,T1106
cracking browser sensitive information like passwords,T1110
The decrypted password will be sent to its C2 Server as part of its data exfiltration.,T1041
it enumerates several known Crypto Wallet directories and looks for files related to crypto currencies by looking for files having “wallet” substring on its file name.,T1083
"used a compiled remote desktop malware,",T1021.001
then executed RDPEnable on the infected machine.,T1021.001
There were also instances of the malware actors using PsEXEC to enable the remote desktop protocol (RDP) of a target system,T1021.001
It enumerates files and directories,T1083
File enumeration,T1083
"using FindFirstFileW, FindNextFileW, and FindClose APIs",T1083
For each directory it traverses,T1083
"using FindFirstFileW, FindNextFileW, and FindClose APIs",T1106
installing remote access software.,T1219
"actors used tools such as PCHunter, PowerTool, GMER, and Process Hacker to disable any security-related services running in the system.",T1562.001
by listing accessible local IPs,T1016
It checks for the number of processors in the infected system,T1082
Checking the number of processors,T1082
"This is a multi-stage attack that involves sideloading DLLs,",T1574.002
involves sideloading DLLs along,T1574.002
icon files with encrypted data appended to the end of the files.,T1027
"These encrypted strings,",T1027
"once decrypted, contained the C2 domains for additional malicious artifacts.",T1140
attempt to obtain system information,T1082
the malware attempts to retrieve additional malicious artifacts,T1105
Inject and execute DLLs,T1055
Manipulate processes (list,T1057
Manipulate files and directories (list,T1083
"Manipulate files and directories (list, download, upload, view, delete",T1070.004
"download, upload",T1105
Take screenshots,T1113
Execute commands via Command Prompt,T1059.003
executed using ShellExecute with the following command line:,T1059.003
This type of threats is usually delivered as email attachments.,T1566.001
Encoded binary payload,T1027
Encrypted and compressed payload,T1027
Start of encrypted and compressed loader configuration and payload,T1027
"an encoded payload split across several nodes, further complicating its extraction.",T1027
That node contains the encoded payload.,T1027
the encoded payload,T1027
"To hide the strings it uses during its execution, it primarily uses a simple encoding by subtracting 35 from each character of the original string and encoding the result with Base64",T1027
"Similar to decoding strings, the binary payload is extracted by decoding the data using Base64 and adding 35.",T1140
the resulting bytes are further decoded with xor 82.,T1140
The decoded payload,T1140
Once the payload is decoded,T1140
After decrypting and decompressing the payload,T1140
Decrypted and decompressed payload,T1140
Decodes sensitive memory regions in the current process with the same XOR key,T1140
it locates a packed and compressed payload,T1027
Injection type: Current process (1) or in the new process,T1055
Process to inject into,T1055
Process to inject into,T1055
this loader prepends a stub containing 79 bytes of junk instructions before the actual payload shellcode.,T1027
The bytes at 25 hardcoded offsets within this stub are replaced with random bytes to hinder shellcode detection.,T1027
"To launch the shellcode, the loader calls ZwCreateThreadEx to create a new suspended injection thread hidden from debuggers using the THREAD_CREATE_FLAGS_CREATE_SUSPENDED (0x01) and THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER (0x4) thread creation flags.",T1055
by redirecting calls to the Windows Sleep API to its own function,T1106
communicates with the C2 server specified in the configuration via HTTP or HTTPS POST requests,T1071.001
shared with the C2 server on the initial check-in request (Figure 11) for encrypting subsequent data communicated between the agent and C2 server with AES-256-CTR.,T1573.001
the execution of the downloaded DLL via the tool rundll32.exe.,T1218.011
performs the download of a file,T1105
PowerShell script that downloads and executes a dropper,T1105
downloads a payload,T1105
malware dynamically calls the API NtAllocateVirtualMemory,T1106
AES Cryptographic Provider from WinCrypt APIs,T1106
the API Web RESTful that provides access to Microsoft Cloud service resources.,T1106
using the Microsoft Graph API,T1106
uses the Microsoft Graph API,T1106
decrypted using the RSA,T1140
The malware proceeds to de-obfuscate strings using a XOR loop,T1140
de-obfuscated strings:,T1140
decrypted through an AES-256-CBCdecryption algorithm,T1140
decrypted,T1140
the decrypted content,T1140
The code in the injected PE,T1055
"injects in itself a new PE (Portable Executable) file,",T1055
passes the execution to the region of memory in which the copied PE is allocated,T1055
the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.,T1055
the full HTTP request to make the first connection to the C&C,T1071.001
enumerating the child files in the check OneDrive subdirectory.,T1083
The execution triggers the setting of the following registry key,T1112
triggered when the user starts the presentation mode and moves the mouse,T1204.002
triggered when the user starts the presentation mode and moves the mouse,T1204.002
"A new file, again with a JPEG extension",T1027
to run the subsequent BAT scripts,T1059.003
the attacker’s BAT file to run,T1059.003
The BAT script,T1059.003
a BAT file (4.2) to be run on logon as another UI she will,T1059.003
executes another BAT script,T1059.003
Some variants used a known UAC bypass method abusing the legitimate fodhelper.exe,T1548.002
UAC bypass implementation,T1548.002
"If it fails, it sets in the registry",T1112
Register a new service,T1543.003
a new service that will run its VBS script (4.1) using sc.exe.,T1569.002
the malicious executable to unpack itself.,T1027
"which is unpacked only when run with a unique password, allow evading traditional signature-based detection.",T1027
decrypting and running the ransomware,T1140
The user is then prompted to open the single visible shortcut (2) file.,T1204.002
contains obfuscated VBA scripts or a binary with a JPG extension,T1027
to trick users into opening the malicious attachments in,T1204.002
"If a target opens the malicious attachment,",T1204.002
using three possible types of messages to try to get a target to open the email and malicious attachment.,T1204.002
"The attachment, if opened,",T1204.002
spear phishing emails pretending to be from financial vendors or partners to trick users into opening the malicious attachments in the emails.,T1566.001
a malicious attachment sent via phishing emails,T1566.001
"the malicious attachment,",T1566.001
the email and malicious attachment.,T1566.001
sends emails pretending to be related to a shipment notice for the target which contain a malicious attachment.,T1566.001
Both send information to command and control (C2) servers,T1041
keylogging every tap,T1056.001
obtain logs of the infected machine’s keystrokes,T1056.001
exfiltrate data from messaging applications such as WhatsApp and Viber,T1005
The malware can deliver payloads from the command and control (C2) server,T1105
take screenshots,T1113
"This version of CEIDPageLock has VMProtect, which makes analysis and unpacking difficult",T1027
then proceeded to dump credentials from LSASS.,T1003.001
the threat actors again used Get-System to elevate and then dumped LSASS.,T1003.001
"Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",T1003.001
threat actor injected into a dllhost.exe process,T1055
which is then injected into svchost and dllhost.,T1055
Process injection was observed during the intrusion,T1055
direct Cobalt Strike processes and the injected processes,T1055
"injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.",T1055
dumped from an injection into the SearchIndexer process,T1055
This was achieved by transferring a Cobalt Strike DLL over SMB,T1570
the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.,T1570
SMB to transfer DLL's into the ProgramData folder of hosts for purposes of lateral movement.,T1570
and executing via a remote service on another workstation.,T1569.002
using a batch file named find.bat.,T1059.003
Windows discovery commands,T1059.003
using a batch script,T1059.003
batch script,T1059.003
basic discovery tasks on the host using built in Windows utilities.,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
via the find.bat batch script.,T1059.003
which was then fed to a batch script,T1059.003
"The batch file contained one line,",T1059.003
began enumerating the network using native Windows binaries,T1059.003
via the interactive she will,T1059.003
wrote a registry run key for persistence,T1547.001
used a registry run key to maintain persistence.,T1547.001
systeminfo,T1082
systeminfo,T1082
C:\Windows\system32\cmd.exe /C systeminfo,T1082
ipconfig,T1016
ipconfig /all,T1016
sending new emails with attached xls and zip files.,T1566.001
The document came in via email in the form of a zip file which included an xls file.,T1566.001
"The emails were sent through various compromised email accounts, propagating additional malicious xls files",T1566.001
Using the remote admin tools,T1219
the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment,T1219
Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.,T1219
after a user opened an Excel document and enabled macros.,T1204.002
To deobfuscate the document the tool xlmdeobfuscator was used with the following output.,T1140
After deobfuscation,T1140
used process hollowing to launch under the context of the Dllhost.exe process,T1055
"the following URLs are hard coded, and obfuscated",T1027
to download the second stage.,T1105
malware pulled down and executed a Cobalt Strike payload on,T1105
ran another round of discovery activity with native windows utilities,T1059.003
cmd.exe /C,T1059.003
“C:\Windows\System32\cmd.exe” CommandLine: “C:\Windows\system32\cmd.exe /c,T1059.003
cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C gpupdate,T1059.003
C:\Windows\system32\cmd.exe /C gpupdate,T1059.003
C:\Windows\system32\cmd.exe /C gpupdate,T1059.003
C:\Windows\system32\cmd.exe /C gpupdate,T1059.003
whoami.exe,T1033
cmd.exe /C whoami,T1033
The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon,T1570
"the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.",T1570
"They utilized RDP,",T1021.001
the threat actor was seen establishing RDP connections,T1021.001
"Cobalt Strike was used to enable RDP,",T1021.001
remotedesktop mode = enable cmd,T1021.001
RDP connections were established from the beachhead host to systems throughout the environment,T1021.001
details of the RDP session,T1021.001
"the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign.",T1566.001
"This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.",T1090
"in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender",T1562.001
"To evade detection, the threat actors disabled Windows Defender",T1562.001
they disabled Windows Defender via a group policy modification.,T1484.001
by adding the below to an already linked GPO.,T1484.001
They then force updated the GPO on all clients using Cobalt Strike.,T1484.001
Cobalt Strike Beacon was dropped and executed on the system,T1105
was executed via rundll32.exe,T1218.011
including the computer name and the OS version of the compromised system were sent,T1082
cmd.exe /C reg add,T1112
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware DeleteValue,T1112
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableRealtimeMonitoring DeleteValue,T1112
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableBehaviorMonitoring DeleteValue,T1112
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableIntrusionPreventionSystem DeleteValue,T1112
HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection DeleteKey,T1112
The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed,T1090
This proxied traffic,T1090
"LSASS was accessed by an unusual process “runonce.exe” on multiple hosts, including a domain controller.",T1003.001
systems injected the Conti DLL into memory,T1055
web application vulnerabilities,T1190
exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891,T1190
GrandstreamCVE-2020-25223WebAdmin of Sophos SG UTMCVE-2021-42013ApacheCVE-2022-31137Roxy-WICVE-2022-33891Apache SparkZSL-,T1190
"CVE-2018-12613, a phpMyAdmin vulnerability that could allow threat actors to view or execute files",T1190
propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials,T1110
default or weak credentials,T1078
using a combination of eight common usernames and 130 passwords,T1110
malicious payload,T1105
downloads,T1105
downloads the Zerobot binary,T1105
download and execute binaries of various architectures until it succeeds,T1105
"download this RAT,",T1105
identify the architecture,T1082
copies itself to the Startup folder,T1547.001
methodDescriptionUDP_LEGITSends UDP packets without data,T1095
TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.,T1095
TLS_SOCKETContinuously sends random payloads on an open TLS socket.,T1095
"methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).",T1095
HTTP_HANDLESends HTTP GET requests using a Golang standard library.HTTP_RAWFormats and sends HTTP GET requests.HTTP_BYPASSSends HTTP GET requests with spoofed headers.HTTP_NULLHTTP headers are each one random byte (,T1071.001
Zerobot HTTP requests,T1071.001
"open-source remote administration tool (RAT) with various features such as managing processes, file operations, screenshotting, and running commands.",T1219
running commands,T1059.003
"screenshotting,",T1113
This attachment (unless zipped) is the MyDoom executable.,T1566.001
"executables attached to its phishing e-mails have an extension hidden by default by most Windows deployments (.cmd, .scr, .com, etc.).",T1566.001
the file is a 32-bit Windows executable packed using the UPX (Ultimate Packer for Executables) packer (https://en.wikipedia.org/wiki/UPX) to compress and make it more difficult to analyze.,T1027
The packer decompresses and executes,T1027
"Upon execution, an attempt to alter the Windows firewall settings is made.",T1562.001
"makes a copy of itself, places it in the “Temp” folder (C:\Users\<user>\AppData\Local\Temp), and changes the name to a known Windows application/process.",T1036.005
The activity thereafter included dumps of LSASS,T1003.001
process enumerations.,T1057
then launched by cmd.exe,T1059.003
the executable ‘3ujwy2rz7v.exe’ was downloaded,T1105
that uses command and control servers to collect information on compromised systems,T1041
A user had to click on this in order to execute the malware.,T1204.002
the malware immediately begins to look for EDR and antivirus software.,T1518.001
Phishing emails spoof legitimate senders to deliver RokRAT via LNK files,T1566.001
Email attachments mimic legitimate documents,T1566.001
several Zip Archives files hosting multiple lure documents likely sent via phishing campaigns,T1566.001
targets for phishing emails containing this type of decoy document.,T1566.001
"campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document",T1566.001
containing obfuscated PowerShell scripts,T1027
the obfuscation technique for the dropped files being hex-encoding vs. string concatenation,T1027
"contain an encoded PowerShell,",T1027
PowerShell scripts in charge of downloading a second stage RokRAT shellcode,T1105
file download/upload,T1105
to start the download process,T1105
downloads the payload,T1105
keylogging,T1056.001
"Optical Disc Image files (ISO) containing LNK files that had slightly modified PowerShell scripts, and Hangul Word Processor decoy documents",T1027
The ISO files that X-Force observed contained a LNK file,T1027
a JPEG decoy file are dropped,T1027
the JPEG decoy file,T1027
a batch file,T1059.003
a batch file,T1059.003
drop batch files,T1059.003
then the payload is executed using Windows API functions (VirtualProtect).,T1106
"the payload that is decoded using the first byte as a key,",T1140
packed into a Windows executable file,T1027
stealing sensitive data from the victim’s networks.,T1005
the adversary identifies data of interest from the network of the victim,T1005
"This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.",T1005
the adversary collected the data from various sources within the victim’s network.,T1005
Credential theft and password spraying,T1110
"password spraying attack against the victim’s remote services,",T1110
"With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised",T1110
"The adversary started a password spraying attack against those domain admin accounts,",T1110
The user account was possibly compromised on the Linux server by using credential stuffing or password spraying:,T1110
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.,T1110
Password spraying,T1110
or password spraying.,T1110
This adversary starts with obtaining usernames,T1033
The built-in Windows quser-command to show logged on users is also heavily used by them.,T1033
"To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals",T1033
to identify if privileged users are active on the systems,T1033
These credentials are used in a credential stuffing,T1110
The user account was possibly compromised on the Linux server by using credential stuffing,T1110
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.,T1110
credential stuffing,T1110
more specifically by credential stuffing,T1110
"After obtaining a valid account, they use this account to access the victim’s VPN, Citrix or another remote service that allows access to the network of the victim.",T1078
"With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.",T1078
the adversary used the valid account to directly login,T1078
The threat used valid accounts against remote services:,T1078
the adversary accessed the company portal with the valid account.,T1078
"cloud drive, or other cloud resources accessible by the compromised account.",T1078
"the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.",T1078
starts using the Cobalt Strike beacon for remote access and command and control.,T1219
"If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller",T1078
"After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,",T1078
"and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.",T1078
successfully got a valid domain admin account this way.,T1078
"In other cases, the adversary moved laterally to another system with a domain admin logged in.",T1078
"This can be anything from file and directory-listings,",T1083
"the adversary copying results of the discovery phase, like file- and directory lists from local systems,",T1083
"If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.",T1041
The adversary uses the command and control channel to exfiltrate small amounts of data.,T1041
adversary executes Cobalt Strike’s built-in Mimikatz to dump its password hashes.,T1003.001
We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going,T1003.001
the actor executes Cobalt Strike’s built-in Mimikatz to dump its credentials or password hash,T1003.001
", staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.",T1074.001
Files and folders of interest are collected as well and staged for exfiltration.,T1074.001
We have seen the adversary staging data on a remote system or on the local system.,T1074.001
This activity group always uses a renamed version of rar.exe.,T1036.005
The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.,T1570
The DLL’s used were side-loaded in memory on compromised systems.,T1574.002
File deletion,T1070.004
Use scheduled tasks,T1053.005
The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.,T1053.005
"An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\windows\temp\update.bat"" /sc once /f /st 06:59:00",T1053.005
batch files for automation.,T1059.003
"The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.",T1059.003
executing a batch-file (.bat) to perform their tasks.,T1059.003
They switched to C2 encapsulated in HTTPS in Q3 2019.,T1071.001
the adversary achieving credentials access by brute force,T1110
The adversary installs a hackers best friend during the intrusion: Cobalt Strike.,T1105
"the adversary also searches for VPN and firewall configs,",T1518.001
"This lures users to double-click the graphic to view the content,",T1204.002
Malicious documents that implement this technique require users to double-click a document element.,T1204.002
capturing screenshots,T1113
and enumerating files and drives,T1083
establish persistence by creating a registry key under \SOFTWARE\Microsoft\Windows\CurrentVersion\Run only if the victim’s machine name differs.,T1547.001
include exfiltrating system information,T1005
"implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.",T1027
the obfuscation techniques used,T1027
"obfuscated using Crypto Obfuscator,",T1027
malicious dynamic link library (DLL) file that is eventually side-loaded to the application.,T1574.002
to a side-loading vulnerability that,T1574.002
"We have seen the payload delivered in diverse ways including DLL side-loading,",T1574.002
abuse legitimate applications vulnerable to DLL side-loading attack.,T1574.002
DLL Side-Loading,T1574.002
"A benign, legitimate executable abused to side-load the malicious DLL",T1574.002
The malicious side loaded DLL,T1574.002
WDSyncService.exe executable abused to side-load a malicious DLL,T1574.002
Side loaded malicious DLL,T1574.002
abused to side-load the malicious DLL.,T1574.002
executable abused to side-load malicious DLL,T1574.002
DLL Side-Loading,T1574.002
DLL Side-Loading,T1574.002
that is abused to side-load a malicious DLL,T1574.002
executable that dropped a legitimate WD Discovery app to side-load the malicious WDLocal.dll,T1574.002
side-loads malicious WDLocal.dll The side-loaded DLL,T1574.002
DLL side-loading is a highly effective technique for tricking Windows systems into loading malicious code.,T1574.002
Adversaries use side-loading attacks for execution,T1574.002
"Once the executable starts running, it side-loads the malicious DLL",T1574.002
to lure victims into downloading a malicious file,T1204.002
"designed to steal sensitive information, including login data, cookies, and Facebook ad and business account information.",T1005
"The scripts are encoded using different techniques,",T1027
(base64 encoded with string replacements),T1027
uses are compressed and encrypted,T1027
Base64 encoded string with several string replacements.,T1027
self-written extensions that obfuscate the PHP scripts.,T1027
And malicious payloads are also sometimes encrypted/packed or obfuscated,T1027
obfuscated with SmartAssembly,T1027
base64 encoded with some string modifications,T1027
"it downloads the file from its command and control (C2) server,",T1105
they are downloaded from the C2,T1105
"executes, it drops a PHP application with additional files",T1105
Download and run,T1105
Downloads a file from the given URL and executes it with the given arguments.,T1105
the given task the downloaded file,T1105
the new stealer is downloaded and executed,T1105
Upload file function,T1105
then decodes and executes it.,T1140
"In the main thread the SFX/ZIP file is executed/decompressed,",T1140
DLL that decodes and drops three files,T1140
It starts with de-obfuscating the next stage (string replacements + base64 decoding),T1140
"Once decoded, this executable, written in Rust and compiled with Cargo, gets the current date and time, and decrypts Chromium-based browsers’ encryption key",T1140
It does this by decoding the rss.txt into an executable,T1140
the executable decodes and drops the next stage,T1140
it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.,T1053.005
registers a new scheduled task to trigger every day and repeat every hour with option “d” as an argument.,T1053.005
Creates a scheduled task to be executed with d as an argument,T1053.005
Responsible for installing persistence via scheduled tasks,T1053.005
The attacker must know the time to set it in the scheduled task.,T1053.005
createTS—creates scheduled task. createLG—creates scheduled task at logon,T1053.005
"it creates a scheduled task that executes the updated routine, which triggers at log-on and every 30 minutes.",T1053.005
registers two scheduled tasks:,T1053.005
embeds legitimate DLLs using the SmartAssembly feature,T1027
"Once the execution completes, the file is deleted to leave no evidence on the machine.",T1070.004
the file is deleted to remove evidence from the machine.,T1070.004
passes this command line as an argument,T1059.003
"Gets a command to run, executes it",T1059.003
Gets command from C2 and executes it,T1059.003
Executable that accepts an executable as an argument and executes it with hidden console,T1059.003
“wmic os get LocalDateTime /value”.,T1047
to steal the victim’s Facebook information and send it back to the C2.,T1041
Extract victim’s sensitive Facebook data using the graph API and send the results to a C2 server,T1041
The malware can extract this information and send it to its command and control (C2) server,T1041
API functions.,T1106
API calls,T1106
the API calls,T1106
calls point to a suspicious API,T1106
"creation functions like NtCreateUserProcess, NtCreateProcessEx, CreateProcessInternalW, CreateProcessA or CreateProcessW.",T1106
an exported function from one of the Windows libraries,T1106
suspicious APIs often used in code injection techniques like CreateRemoteThread or NtSetContextThread.,T1106
frequently called API function,T1106
critical APIs,T1106
Microsoft Outlook Messaging API (MAPI) module,T1106
process creation library functions,T1106
calls the NtProtectVirtualMemory function where the NewAccessProtection argument is PAGE_EXECUTE_READWRITE and the BaseAddress argument is an address to a library function,T1106
uses a variation of AtomBombing that queues an APC to call memset to clean an RW region in ntdll.dll.,T1055
dispatch an asynchronous procedure call (APC) to the APC queue of a target process thread using NtQueueApcThread,T1055
the injector process dispatches another APC using NtQueueApcThread to force the remote process to execute NtSetContextThread.,T1055
it queues an APC into the patched GlobalGetAtomA to get the payload running.,T1055
"APC routine argument in the case of NtQueueApcThread,",T1055
"AtomBombing is the write-primitive, which allows writing to the remote process using atom tables and APC.",T1055
AtomBombing Injection Technique,T1055
AtomBombing is a technique that allows malware to inject code while avoiding calling suspicious APIs,T1055
"Malware using the AtomBombing technique first writes the payload into the global atom table, which can be accessed by all processes.",T1055
uses a slightly modified AtomBombing technique that injects one of its stages into a Windows process,T1055
the malware can read HTTP-POST headers,T1071.001
injects the main bot into svchost.exe.,T1055
Injected Processes,T1055
Process Injection via Hooking,T1055
use this technique to inject themselves into other processes,T1055
"they inject their main bot into a Windows process, and then inject their other modules into different processes according to the module’s purpose",T1055
an injection into a web browser process.,T1055
injected thread,T1055
they suspend the remote process threads,T1055
The injected process,T1055
goes through processes one by one,T1057
used to steal victims’ sensitive data.,T1005
injects its main bot into a hollowed instance of svchost.exe,T1055
"implemented process hollowing by first using VirtualProtectEx on the process entrypoint, and then writing the hook stub using WriteProcessMemory.",T1055
"Process hollowing is a process injection technique that creates a new legitimate process in a suspended mode, unmaps its main image and replaces it with malicious code.",T1055
The malicious code is written into the newly created process and the suspended thread context instruction pointer is changed using NtGetContextThread/NtSetContextThread.,T1055
for process hollowing from a WoW64 process into a 64-bit svchost.exe,T1055
Evasive Process Hollowing By Entrypoint Patching,T1055
Evasive Process,T1055
Evasive Process Hollowing by Entrypoint Patching,T1055
Decompresses a local buffer,T1140
Common injection methods used by banking Trojans involve writing a mapped PE into a remote process using WriteProcessMemory,T1055
"obscure the call by wiping artifacts from the buffer, such as wiping the PE header.",T1027
malware disguised as Hancom Office document files.,T1036.005
“Who and What Threatens the World (Column).exe” and is designed to deceive users by using an icon that is similar to that of Hancom Office.,T1036.005
creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.,T1036.005
malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.,T1036.005
connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.,T1036.005
URL registered in the task scheduler appears to be a normal homepage,T1036.005
Decompressing the compressed file,T1027
Decompressing,T1140
injected and executed within the normal Windows process called mstsc.exe.,T1055
of mstsc.exe being executed after being injected with malware,T1055
deleted using the cmd command.,T1070.004
registers its file with the name onedrivenew under the Run key,T1112
registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.,T1547.001
schtasks.exe command to register the file to the task scheduler with,T1053.005
URL registered in the task scheduler,T1053.005
connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.,T1071.001
using an obfuscated Meterpreter stager,T1027
One of the techniques to conceal the traffic from DNS-based filtering is Domain Fronting.,T1090
Domain fronting uses legitimate or high-reputation domains to remain undetected by defenders.,T1090
domains for domain fronting may indicate an interest in the geopolitics of this area of the world.,T1090
the domain fronting functionality before launching the attack.,T1090
"The actor in this campaign has used domain fronting, which is a technique which can use high reputation domains to conceal the Cobalt Strike command and control traffic.",T1090
Domain fronting can be achieved with a redirect between the malicious server and the target.,T1090
actors may misuse various content delivery networks (CDNs) to set up redirects of serving content to the content served by attacker-controlled C2 hosts.,T1090
The beacons are of particular interest due to the domain fronting technique using a government host as the initial DNS lure.,T1090
The DNS request for the initial host resolves to a Cloudflare-owned IP address that allows the attacker to employ domain fronting and send the traffic to the actual C2 host,T1090
Domain fronting is a technique used by attackers to circumvent protection based on DNS filtering.,T1090
modify the subsequent HTTPs requests header to instruct the CDN to direct the traffic to an attacker-controlled host.,T1090
The threat actor in this case uses domain fronting with the Cloudflare Content Delivery Network,T1090
.]net via HTTP Get and POST metadata specified in the beacon's configuration.,T1071.001
"relies on other parts of the HTTP request, including the Host header and the actual C2",T1071.001
suspicious section .kxrt with the packed and encoded malicious code.,T1027
decryption routine is executed that decrypts the remaining malicious code in the .kxrt section and writes it to the virtual memory.,T1140
Decoder routine to decrypt the beacon DLL.,T1140
The decrypted malicious code,T1140
"Once decoded, the loader's execution jumps to the beginning of the DLL",T1140
now responsible for decoding the configuration.,T1140
by calling WinHTTPGetProxyForUrlEx and WinHTTPCreateProxyResolver,T1106
calls the VirtualProtect function,T1106
modifies the victim's system power and lid open/close policies in the registry.,T1112
can also manage the system power policies registry keys to set the minimum and maximum sleep times and the lid open and close action policy.,T1112
routed through European TOR VPN exit nodes.,T1090
VPN access using Single Factor authentication.,T1078
Minidump of LSASS process memory,T1003.001
The minidump function of comsvcs.dll can be used to dump lsass.exe.,T1003.001
leveraging comsvcs.dll with proxy execution by rundll32.exe.,T1218.011
"do rundll32.exe C:\windows\System32\comsvcs.dll,",T1218.011
Conducting discovery indirectly via schedule tasks named “Windows Update”,T1053.005
performing remote directory listings.,T1083
to discover interesting to them directories,T1083
"Leveraging a dual-use tool, PCHunter64, to acquire detailed process and system information.",T1082
Threat actors can use windows binaries and commands,T1059.003
RDP connection established,T1021.001
"Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network",T1021.001
the threat actor was able to RDP unencumbered across the organization’s infrastructure.,T1021.001
The threat actor executed two actions to bypass Windows Defender,T1562.001
"the threat actor leveraged one of the most popular dual-use agents, AnyDesk, to provide persistent remote access into the affected organization on multiple systems.",T1219
"several files were staged for possible, but unconfirmed exfiltration",T1074.001
spear phishing emails that contain a .csv or .xlt file attachment,T1566.001
The email is directed to “Non-Resident Alien” tax payers to have them fill out a PDF file (that is attached to the email),T1566.001
"a cyber-attack in the form of credential stuffing,",T1110
Enduring Credential Stuffing,T1110
using login credentials from what the company suspects are past data breaches from other companies,T1110
replace the “ServiceManager.exe” file from the driver folder with a malicious file to trick the driver into running the tainted file,T1036.005
log keystrokes,T1056.001
decrypts that specific payload code,T1140
A threat actor could establish an administrator session,T1078
a payload download code that grabs malware to download and install the backdoor.,T1105
then sign on as a legitimate user,T1078
decrypting database passwords from Windows registry values,T1140
decrypting them from Windows registry values,T1140
decrypt the more sensitive data in the user’s database.,T1140
"decrypt these database passwords,",T1140
decryption,T1140
decryption,T1140
decrypts the password,T1140
decrypted dba user password.,T1140
decrypts this payload,T1140
decrypting the appropriate loader,T1140
decryption,T1140
decrypts the payload,T1140
decrypting them,T1140
gather database passwords,T1005
steal database passwords and configuration information,T1005
steal credentials by decrypting them from registry values.,T1005
Exfiltrated credentials,T1078
decrypt these database passwords,T1078
decrypts the password for the dba username,T1078
decrypted dba user password.,T1078
successfully obtain the database passwords,T1078
steal credentials by decrypting them from registry values,T1078
the encryption key for sensitive data,T1027
encrypted,T1027
encryption,T1027
encryption,T1027
XORed with the value,T1027
encrypted using its own XOR key,T1027
encrypted payload,T1027
write module to the encrypted storage,T1027
"unpacks and loads the next stage of the malware, namely the main module",T1027
unpacking the main module and,T1027
handles communication between the modules and attacker’s C&C server.,T1041
"0x10000013data for C&C server (execution logs, stolen data, …)",T1041
upload data to C&C,T1041
exfiltrates data over its C&C channel.,T1041
acquire a list of the running processes and their loaded modules,T1057
"collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line",T1057
collect information about loaded modules for each of the running processes,T1057
0x10000025get handle of the process with specified PID,T1057
enumerates running processes,T1057
get information about processes running on a system,T1057
stored in DataS5 (for dba) and DataS6 (for micros) registry values within one of the following registry keys,T1112
Windows registry Run key,T1112
GetComputerName API,T1106
GetTickCount Windows API,T1106
PeekNamedPipe Windows API function,T1106
information about specific registry keys,T1012
"queries the Registry for ORACLE MICROS RES 3700 POS version, database passwords and other configuration data",T1012
is injected into one of the processes specified by the C&C,T1055
module is injected into one of the processes specified by the C&C,T1055
is injected only into processes running under WOW64.,T1055
its injection into one of the following processes,T1055
0x10000012inject and execute received module in specified process,T1055
"injected first,",T1055
inject a networking module,T1055
inject processes that are expected to communicate over the network,T1055
0x0AInject and execute received module in specified process,T1055
0x0BInject and execute received module in specified process,T1055
inject and execute received module in specified process,T1055
scanning selected IP addresses,T1016
scan specific IP addresses,T1016
IP addresses intended for scanning and the special “ping” IP address,T1016
scanning IPs specified in the command data to collect additional information about the environment,T1016
scan of the selected IP addresses,T1016
downloaded from the C&C along with the ModScan module,T1105
parsing payload received in the C&C responses,T1105
download additional payloads and C&C commands,T1105
TCP ports 50123,T1095
and 2638,T1095
by sending a specially crafted TCP packet,T1095
sends a hardcoded TDS 4.2 & 5.0 Login Packet (Figure 6) to the specified IP address on port 2638,T1095
"transmitted using the lightweight networking module,",T1095
Version of the Oracle,T1082
information about the database server and the TDS versions used,T1082
sending an HTTP Post message,T1071.001
module uses HTTP and port 80.,T1071.001
avoid system processes that might attract attention if caught communicating over the network,T1071.001
HTTP POST or GET methods,T1071.001
uses HTTP for command and control,T1071.001
stored between data xml tags (<data>%version%</data>) of the response from the service,T1027
"encrypted payload, containing the main functionality of the dropper, is stored in the dropper’s resources as bitmaps named from A to L.",T1027
being the payloads stored in the resources,T1027
encrypted within the main module’s code.,T1027
"with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.",T1078
"hash of the dropped loader to change with each execution,",T1027
creating a Windows service,T1543.003
create a new service for persistence.,T1543.003
"Decompiled code responsible for loading the payload from the binary’s resources,",T1027
Communication with the C&C is encrypted using AES in CBC mode,T1573.001
XORed with the first 4 bytes of the AES key used to encrypt the message.,T1573.001
encrypts communication with C&C using AES in CBC mode,T1573.001
using Windows Command She Will to execute the initial dropper.,T1059.003
use Registry Run key for persistence,T1547.001
inject it is modules into various processes.,T1055
gathers username and computer name from victim machines and reports them to the C&C in initial message.,T1033
The attack revolves around a DLL sideloading,T1574.002
"DLL sideloading scenario, the malicious loader (ffmpeg.dll) would replace the clean dependency;",T1574.002
DLL sideloading,T1574.002
DLL sideloading,T1574.002
encoded malware,T1027
encrypted payload,T1027
malicious encoded .ico payload,T1027
generate the HTTP request,T1071.001
these appear to be maliciously patched versions of the legitimate ffmpeg.dll,T1036.005
GetSystemTimeAsFileTime Api call,T1106
which initiates the payload download,T1105
malware tries to login and get access to the victim server via brute force.,T1110
tries to get access to the server via brute force,T1110
malware samples are packed with UPX Packer.,T1027
Upon unpacking a sample,T1027
"the malware uses a set of credentials that is hard coded into the malware binary,",T1110
Hard-coded credentials for brute forcing.,T1110
from the decrypted configuration,T1140
"The malware then de-XORs other strings, with the hard-coded key",T1140
Most of the strings are de-XOR’d in a function,T1140
simply de-XOR the entire binary,T1140
"Also the de-XOR’d strings,",T1140
"Once the malware has de-XOR’d all its strings, it invokes a method named go.",T1140
we find an XOR loop that decrypts this configuration.,T1140
as a hard-coded XOR key,T1027
we find an XOR loop,T1027
This produces strings including a commandline usage:,T1059.003
can be set via the command-line as well.,T1059.003
This parses command-line options,T1059.003
the data will be published on our TOR darknet sites.,T1090
--remove self remove this file after work,T1070.004
"this snippet of code invokes ptrace with PT_DENY_ATTACH (0x1f) which will kill the process if a debugger is currently attached,",T1055
the embedded .NET injector and PE payload(s).,T1027
embedded payloads of one of the IronPython scripts.,T1027
the main task of loading malware is done by an embedded process injector.,T1027
IronNetInjector is made of an IronPython script that contains a .NET injector and one or more payloads.,T1027
Contain an encrypted .NET injector and one or more encrypted PE payloads.,T1027
Embedded .NET injector and payload(s) are encoded with Base64 and encrypted with Rijndael.,T1027
script with embedded .NET injector and ComRAT payload,T1027
"the embedded payloads in the IronPython scripts,",T1027
embedded malware:,T1027
the embedded files in the scripts,T1027
These scripts contain an embedded PE loader to execute an embedded malware payload.,T1027
the embedded .NET injector,T1027
which in turn injects the payload(s) into its own or a remote process.,T1055
contains the ability to inject .NET assemblies into unmanaged processes.,T1055
the payload is either loaded into its own process or a remote one.,T1055
remote process the payload gets injected to.,T1055
the second option is used with the PID of explorer.exe to load the ComRAT payload reflectively into the process.,T1055
the injector is its ability to load an assembly into an unmanaged process.,T1055
to load an assembly into an unmanaged process.,T1055
The method InjectAssembly is used to inject a .NET assembly into a native process,T1055
Function and variable names are obfuscated,T1027
Strings are encrypted,T1027
scripts are obfuscated to prevent easy detection.,T1027
Decoded IronPython script,T1140
the Rijndael decryption key is passed.,T1140
get decoded and decrypted,T1140
The decryption key is passed as an argument,T1140
full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.,T1055
PowerShell Empire’s ReflectivePEInjection script,T1055
The method Invoke is used to inject a native PE into a remote process and InvokeVoid to call any exported function of the injected payload.,T1055
As a command line argument,T1059.003
Windows task XML file,T1053.005
The task is used to start an IronPython script,T1053.005
The task’s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created:,T1053.005
the Windows task XML,T1053.005
The task file is then used to create a task which in turn starts a script when triggered.,T1053.005
a Windows task XML to start,T1053.005
the submitter collected the files from different places,T1005
"This is accomplished with a native bootstrapper DLL, which gets injected into the remote process and prepares it so a .NET assembly can be injected afterwards.",T1055
DLL gets injected,T1055
The output is then parsed to the targeted process ID with the help of tasklist filters.,T1057
Contains the imported unmanaged function declarations and win32 structures/constants.,T1106
being able to use the .NET framework APIs directly from Python.,T1106
can use .NET framework APIs,T1106
use of the .NET framework APIs,T1106
when .NET framework APIs are used in the code,T1106
use of WMI to both store and persist the backdoor,T1047
Windows Management Instrumentation (WMI).,T1047
to use WMI for storage and persistence.,T1047
"WMI provides many administrative capabilities on local and remote systems, including querying system information, starting and stopping processes, and setting conditional triggers.",T1047
"WMI can be accessed using a variety of tools, including the Windows WMI Command-line (wmic.exe), or through APIs accessible to programming and scripting languages such as PowerShell.",T1047
WMI permanent event subscriptions can be used to trigger actions when specified conditions are met.,T1047
"Subscriptions consist of three core WMI classes: a Filter, a Consumer, and a FilterToConsumerBinding.",T1047
"WMI Consumers specify an action to be performed, including executing a command, running a script, adding an entry to a log, or sending an email",T1047
Creating a WMI permanent event subscription,T1047
"WMI Filters define conditions that will trigger a Consumer, including system startup, the execution of a program,",T1047
then created a WMI event subscription in order to execute the backdoor,T1047
use WMI to persist a backdoor and also store the PowerShell backdoor code.,T1047
created a new WMI class and added a text property to it in order to store a string value.,T1047
The WMI component of the POSHSPY backdoor leverages a Filter to execute the PowerShell component of the backdoor on a regular basis.,T1047
WMI Component,T1047
“BfeOnServiceStartTypeChange” WMI Query Language (WQL) filter condition The BfeOnServiceStartTypeChange Filter was bound to the CommandLineEventConsumer WindowsParentalControlsMigration.,T1047
legitimate WMI persistence,T1047
attacker use of WMI,T1047
WMI persistence.,T1047
"decrypted, and executed the backdoor code",T1140
Decoded CommandLineTemplate PowerShell code,T1140
wrote the encrypted and base64-encoded PowerShell backdoor code,T1027
base64-encoded PowerShell command.,T1027
executing PowerShell code as an EncodedCommand,T1027
to download and execute additional PowerShell code and Windows binaries,T1105
Downloading and executing PowerShell code,T1105
Encrypting communications using AES and RSA public key cryptography,T1573.001
"Writing executables to a randomly-selected directory under Program Files, and naming the EXE to match the chosen directory name",T1036.005
"Appending a file signature header to all encrypted data,",T1027
appended file headers used to bypass content inspection made this backdoor difficult to identify,T1027
Word document lure requesting the user to run the VBA macro.,T1204.002
"When opened, the user sees a social engineering image telling them that they must click the “Enable editing” button to see the document’s contents.",T1204.002
Packed DLL analysis,T1027
packing being used to obfuscate the malware.,T1027
there is indeed some sort of unpacking happening.,T1027
Although the unpacking procedure happens in multiple steps,T1027
As soon as the unpacked executable is running,T1027
An Examination of its Unpacking Routine,T1027
its unpacking routine,T1027
"Once the “.tmp” file is found, it is moved and renamed to the Office templates folder",T1036.005
loaded using rundll32.exe.,T1218.011
"As a second argument, the macro passes the entry function “DllUnregisterServer” to rundll32.exe so that the execution starts correctly.",T1218.011
runs rundll32.exe to load the malware.,T1218.011
executes it using rundll32.exe,T1218.011
Looking at the decrypted data,T1140
the decryption process starts,T1140
data that will be decrypted,T1140
The algorithm to decrypt the data is simple.,T1140
the second decryption stage occurs,T1140
the decrypted memory structure,T1140
Before the decryption starts,T1140
contains the decryption algorithm for the second stage,T1140
The output of this decryption,T1140
The decryption algorithm,T1140
the executable code used to decrypt the encrypted data,T1140
After successfully decrypting the C2 URLs,T1140
all the decrypted C2 URLs,T1140
the malware calls a decryption function,T1140
"Although the decoding algorithm of the C2 response looks quite complex, it is actually Base64 decoding, followed by an XOR operation using the key 0x7A.",T1140
decryption function.,T1140
can be decrypted to an active malware download server,T1140
The API function located at the beginning of the memory section are resolved using GetProcAddress,T1106
Windows API functions,T1106
Windows API functions,T1106
After resolving the functions,T1027
The names of Windows API functions are stored in the first 150 bytes,T1027
several Windows API functions are resolved using GetProcAddress,T1027
memory structure contains executable code.,T1027
Data view of the section containing the encrypted malware.,T1027
The area after this contains encrypted data.,T1027
Structure of the encrypted section.,T1027
encrypted URLs contained in the malware itself.,T1027
the encrypted data,T1027
This technique is called self-injection or PE overwrite,T1055
"This function obtains the username,",T1033
the computer name and the domain of infected system.,T1082
the computer architecture,T1082
generated based on the computer architecture.,T1082
The subsequent functions collect additional information such as the machine’s public IP address,T1016
"To determine the command and control (C2) servers waiting for the data to be sent to, the malware calls a decryption function that uses the RC4 algorithm",T1573.001
"After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data",T1071.001
making a HTTP GET request,T1071.001
"the malware initiates a download, which delivers an executable",T1105
Its main purpose is to download and execute a second stage malware payload,T1105
Thread Execution Hijacking,T1055
Thread Execution Hijacking,T1055
The final execution method Hancitor supports is Thread Execution Hijacking.,T1055
The only difference is that the malware replaces the thread context with the downloaded executable and resumes it afterwards.,T1055
Process Hollowing,T1055
Process Hollowing,T1055
"If the Process Hollowing method is used, a new svchost.exe process is created in a suspended state.",T1055
"The malware then allocates new memory in the newly-created process, writes the executable to it and executes it in a new thread.",T1055
Process Injection method,T1055
the malware was distributed as email Word document attachments,T1566.001
then recursively searches through all local temp folders.,T1083
Query string containing system information before being sent to the C2.,T1041
The backdoor uses domain fronting to obfuscate its true C2 server,T1090
The fronted domain is configured by an earlier stage of execution and the actual domain is hard-coded in the backdoor.,T1090
PowerShell initiated the first connection to the fronted domain,T1090
communicates with its C2 server using HTTPS,T1071.001
its C2 server consists of JSON data exchanged via HTTP POST requests.,T1071.001
HTTP POST request that contains the command output.,T1071.001
C2 server via a subsequent HTTP POST request,T1071.001
its C2 server via a subsequent HTTP POST request.,T1071.001
its C2 server every five seconds via HTTP POST requests.,T1071.001
"backdoor that supports commands, including screen capture",T1113
Upload a screen capture,T1113
keystroke capture,T1056.001
The backdoor writes captured keystrokes to memory,T1056.001
continuously captures keystrokes,T1056.001
the keylogging utility,T1056.001
This attacker utilized an additional keylogging utility,T1056.001
The keylogging utility was configured to capture and record keystrokes to C:\ProgramData\psh\System32Log.txt.,T1056.001
Keylogger Deployment,T1056.001
keylogger,T1056.001
The backdoor may also download and execute additional PowerShell commands from its command and control (C2) server.,T1105
Downloaded VBScript and PowerShell,T1105
a PowerShell script block was executed to download,T1105
PowerShell to connect to third-party file sharing sites to download the UltraVNC application,T1105
PowerShell to connect to third-party file sharing sites to download an NGROK utility,T1105
use UltraVNC to download two LNK files,T1105
used UltraVNC to download an in-memory dropper,T1105
using UltraVNC to download and store a file,T1105
deployed additional tools,T1105
"The Data field may contain RC4-encrypted, Base64-encoded command",T1573.001
The backdoor uses an RC4 key configured by an earlier stage of execution to encrypt and decrypt the Data field,T1573.001
observed the RC4 key UwOdHsFXjdCOIrjTCfnblwEZ used for RC4 encryption and decryption.,T1573.001
RC4-decrypts command data returned in the Data field.,T1573.001
"The dropper configures the backdoor with a C2 server address, RC4 encryption key,",T1573.001
Base64-decodes,T1140
decryption.,T1140
decrypt the Data field.,T1140
decrypts and executes in memory,T1140
embedded key to decrypt the source code,T1140
the deobfuscated SMOKEDHAM dropper.,T1140
Upload a screen capture to its C2 server,T1041
The backdoor writes captured keystrokes to memory and uploads them to its C2 server,T1041
reg.exe add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run,T1547.001
created a persistence mechanism for NGROK by adding VirtualHost.vbs to the WindNT value under the current users Run registry key.,T1547.001
created a persistence mechanism for UltraVNC by adding the application to the ConhostNT value under the current users Run registry key.,T1547.001
reg.exe add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run,T1547.001
store a file named update.lnk in the %APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\ directory,T1547.001
the command line argument provided,T1059.003
passed as an argument on the command line.,T1059.003
executed using the Command-Line Compiler.,T1059.003
launched with a command line,T1059.003
using Command Prompt.,T1059.003
backdoor source code is embedded as an encrypted string.,T1027
whoami.exe,T1033
systeminfo.exe,T1082
reg.exe ADD 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList,T1112
modifying Terminal Server registry key values,T1112
modifying the Local Security Authority (LSA) registry key value,T1112
reg.exe ADD 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v fDenyTSConnections /t REG_DWORD /d 0 /f,T1112
reg.exe ADD 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v fSingleSessionPerUser /t REG_DWORD /d 0 /f,T1112
reg.exe ADD HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v LimitBlankPasswordUse /t REG_DWORD /d 1 /f,T1112
modified the WDigest registry key value HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential to enable credential caching.,T1112
to enable multiple Remote Desktop connection sessions,T1021.001
the attacker was observed moving laterally to different systems in the environment using Remote Desktop Protocol (RDP) connections.,T1021.001
"attacker dump the LSASS process using Task Manager to a file named lsass.DMP, and later, zip the dump into two files named lsass.zip and lsass2.zip located in the C:\ProgramData\psh\ directory.",T1003.001
LSASS Dumping,T1003.001
conducted credential harvesting via dumping LSASS memory.,T1003.001
activity from Tor,T1090
hop points to enable their cyber operations while remaining anonymous.,T1090
“The Onion Router” (Tor) is often used by cyber threat actors for anonymity and C2.,T1090
resulted in confirmed compromises of internet-facing Federal Government agency systems.,T1190
resulted in confirmed compromises of internet-facing Federal Government agency systems.,T1190
the actors leveraging CVE-2019-19781 to compromise Citrix Application Delivery Controllers.,T1190
attack of a Remote Desktop Protocol on a public-facing server.,T1190
cyber threat actors using external proxy tools,T1090
These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.,T1090
proxy tools depending on their intended use.,T1090
activity from a network proxy tool,T1090
Cyber threat actors also continue to identify large repositories of credentials that are available on the internet to enable brute-force attacks.,T1110
brute-force passwords.,T1110
threat actors using Mimikatz in conjunction with coin miner protocols and software.,T1003.001
The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool.,T1003.001
the actors using Mimikatz during their operations.,T1003.001
a brute-force attack of a Remote Desktop Protocol on a public-facing server.,T1110
such as a keystroke logger,T1056.001
file injection capability,T1055
actors to execute directory traversal attacks,T1083
or delete files,T1070.004
"allows cyber threat actors to execute arbitrary system commands,",T1059.003
The lures are designed to socially engineer the recipient to download and open an attached RAR file that contains either a Microsoft Compiled HTML Help (CHM) or Excel payload.,T1566.001
phishing emails that were used as lures to deliver the files,T1566.001
download further malware payloads,T1105
to download a next stage EXE payload using cURL,T1105
downloading of the next stage.,T1105
One scheduled task (shown below) runs every 15 minutes,T1053.005
"""C:\Windows\System32\schtasks.exe"" /create /sc MINUTE /mo 15 /TN",T1053.005
creates two different scheduled tasks.,T1053.005
Scheduled task,T1053.005
"The second scheduled task created attempts to execute the payload downloaded by the other task: ""C:\Windows\System32\schtasks.exe"" /create /sc MINUTE /mo 20 /TN",T1053.005
create a scheduled task,T1053.005
"""C:\Windows\System32\schtasks.exe"" /create /sc minute /mo 15 /tn",T1053.005
used to create scheduled tasks for persistence,T1053.005
schtasks /create /tn WinSecurity /sc minute /mo 15,T1053.005
"These payloads are compressed inside RAR files, this helps avoid static analysis techniques",T1027
The more common payloads contained within the RAR files are Microsoft Compiled HTML Help (CHM) files,T1027
The computer name,T1082
the computer name is sent to the C2,T1082
the username is also sent to the C2.,T1033
The computer name and the username is also sent to the C2.,T1041
the computer name is sent to the C2,T1041
"plugins such as a keylogger,",T1056.001
remote access tool,T1219
file stealer,T1005
"an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.",T1027
Encoded PowerShell command,T1027
The decoded command,T1140
threat actors obtain initial access to networks is through the use of compromised valid credential pairs,T1078
often will search for directories on the network,T1083
remote desktop protocol (RDP) and secure she will (SSH) accesses,T1021.001
Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers,T1190
Exposed RDP servers are also abused by threat actors to gain initial access into a targets network.,T1190
use brute force password attacks,T1110
"The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER",T1071.001
The threat actor also engaged in brute-forcing against the victim's internal web services,T1110
brute forcing tool called FSCAN.,T1110
brute-force attacks on systems,T1110
brute forcing attempts on some of the internal FTP servers inside victim network,T1110
The database used a weak password and was susceptible to brute-force attacks.,T1110
threat actor used the Windows command-line arguments,T1059.003
received a command-line argument from attacker,T1059.003
"Used to search for the string ""DBPath"" in all files within the current directory and its subdirectories",T1083
List of recently opened files and folders on the computer.,T1083
The threat actor uses stolen passwords from valid accounts,T1078
to escalate privileges using valid accounts,T1078
the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.,T1090
"After establishing the reverse SOCKS proxy connection,",T1090
"The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.",T1090
Execution of FRP reverse SOCKS proxy on infected host.,T1090
Installation of malicious Windows service.,T1543.003
it will install a fake Windows service called “windowsupdate”,T1543.003
Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\Windows\Temp\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate,T1543.003
Maintain Presence via Windows Service Installation,T1543.003
"To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload",T1543.003
installed a second stage persistence backdoor on infected device by abusing Windows Services.,T1543.003
This service executes a malicious binary (Cobalt Strike Cat payload) under “C:\Windows\Temp\svchost.exe” every time the victim device is started.,T1569.002
"Windows services ran with the highest privilege, NT AUTHORITY\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.",T1569.002
the threat actor used private proxy addresses from a Chinese underground proxy IP solution called 'Tigercloud Club' to conceal their real IP address.,T1090
Reverse proxy tool,T1090
Reverse proxy tool,T1090
Threat actor uploaded the fast reverse proxy (FRP) binary,T1090
One of the main initial access vector is exploitation of publicly exposed web services.,T1190
Initial Compromise Through Exploiting Publicly Facing Applications,T1190
the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:• CVE-2023-21839 Oracle WebLogic Server RCE [13]• CVE-2021-3129 Laravel debug mode RCE [14]• CVE-2020-2551 Oracle WebLogic RCE [15]• CVE-2021-44228 Apache Log4j [16],T1190
the victim IP address was publicly serving a web service that contained a phpMyAdmin database.,T1190
Decrypting and exporting browser data,T1140
the decryption key for the ZIP folder and access the tool,T1140
distributed inside an encrypted ZIP folder.,T1027
"executed the ""tasklist /SVC"" command to list all running processes on the victim device.",T1057
deleted the LaZagne binary after execution to avoid detection from the user's side.,T1070.004
The actor leveraged ONE-FOX - a collection of pentest tools - to copy binaries from actor´s system to the victim.,T1570
Recording keystrokes in real time with offline logging available,T1056.001
Downloading files remotely,T1105
the dropper then downloads a custom XMRig miner,T1105
"a script to download, configure and execute",T1105
to download the XMRig payload.,T1105
pulls the XMRig payload,T1105
generating a script to decode the legitimate Mach-O file.,T1140
is decoded and unarchived,T1140
This value is decoded,T1140
The Logic Pro X dropper binary is deleted with the /tmp/ bundle,T1027
"In order to unpack the legitimate binary,",T1027
binary unpacks a customized Mach-O,T1027
previously written Base64 file,T1027
Files are dropped/downloaded as Base64-encoded archives.,T1027
The script first deletes itself from the disk.,T1070.004
removes any files,T1070.004
deleted every time,T1070.004
The script then removes any files,T1070.004
script removes the i2pd Mach-O file from the disk.,T1070.004
"Even though the scripts produce many on-disk artifacts, the dropper and scripts are quick to remove them",T1070.004
Files are deleted after use.,T1070.004
to proxy the miner’s network communications.,T1090
mining proxy.,T1090
The usage of a proxy allows authors to control all of their mining implants and their target pools via a centralized console,T1090
the mining proxy,T1090
command line arguments,T1059.003
is executed as a command line argument,T1059.003
The padded i2pd Mach-O file,T1027
pads the resulting Mach-O with a random number of \x00 bytes,T1027
binaries are padded with a random number of zero bytes to change its hash and expand its size.,T1027
is padded with a random number of \x00 bytes.,T1027
the user will continue to execute the dropper,T1204.002
The dropper is executed by the user.,T1204.002
As long as the dropper successfully launches its legitimate application,T1036.005
"The dropper bundle in the applications folder appears legitimate,",T1036.005
The authors cleverly utilized these legitimate dependencies via symbolic links when dynamically creating the legitimate bundle in the temp folder.,T1036.005
"The dropper is installed into a legitimate file path, posing as the legitimate application.",T1036.005
utilize legitimate file paths to mask their execution.,T1036.005
"In order to appear as a working copy of Logic Pro X, the dropper contains a legitimate copy of the lure application",T1036.005
The mirrored bundle contains the legitimate application instead of the dropper binary.,T1036.005
to mirror all directories found in /Applications/Logic Pro X.app/Contents and /Applications/Logic Pro X.app/Contents/MacOS to their respective /tmp/ locations,T1036.005
The malicious dropper contains a legitimate version of the software and executes it to give the illusion of a properly behaving application.,T1036.005
a check using pgrep for Activity Monitor processes,T1518.001
This proxy server is located on the I2P network at the destination of the pool tunnel,T1090
config via the XMRig miner’s native API.,T1106
By modifying the below registry value EnableLUA to “0”,T1112
"The ConsentPromptBehaviorAdmin key has been set to “0”, indicating that the behavior of the consent prompt for actions requiring administrator privileges has been modified",T1112
the ransomware modifies specific registry values,T1112
malware aims to deactivate User Account Control (UAC) on the target system,T1548.002
UAC BYPASS,T1548.002
"to disable User Access Control (UAC), a security feature in Windows",T1548.002
"By deactivating UAC, the ransomware gets elevated privileges without requiring user permission or administrator credentials",T1548.002
After bypassing UAC,T1548.002
the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions,T1106
using the FindFirstFileW() and FindNextFileW() API functions.,T1106
"the malware leverages various functions from the CryptoAPI, including CryptAcquireContextW(), CryptImportKey(), CryptSetKeyParam(), and CryptEncrypt().",T1106
"using the MoveFileExW() API function,",T1106
to search and identify accessible volumes on the targeted system.,T1083
the malware proceeds to identify files and directories for encryption by iterating through them,T1083
This function scans a specified path by finding all files within the given directory and its subdirectories.,T1083
then iterates over each volume to search for specific files related to virtual machines.,T1083
This function scans VM volumes on an ESXi server.,T1083
scanning files in a specified or generic path,T1083
then iterates over each volume to find files,T1083
command uses the Windows Management Instrumentation Command-line (WMIC),T1047
This function is responsible for deleting all files and directories in the user’s trash folder.,T1070.004
by passing the file path to be encrypted as an argument.,T1027
It removes log files and temporary files from the root directory.,T1027
"It also deletes the ransomware, script file, and ransom note (index.html), ensuring that no evidence remains on the compromised system.",T1027
It uses the esxcli command to list all VM processes,T1057
"configuring autorun entries,",T1547.001
through legitimate remote access software such as AnyDesk,T1219
invoked the wave 2 ransomware immediately from the command line,T1059.003
both use CreateFile and WriteFile APIs,T1106
using DeviceControl API methods,T1106
use of the same DeviceControl API methods,T1106
DeviceControl API methods,T1106
DeviceControl API methods,T1106
ransomware attempts to decrypt,T1140
RC4 key for decryption,T1140
the RC4 decryption method uses CryptoAPI (CryptDecrypt) instead of the usual substitution box method,T1140
execute embedded scripts,T1027
Embedding of EldoS RawDisk driver inside the wiper malware,T1027
the threat actor embedded the signed raw disk driver in the wiper executable,T1027
the raw disk driver was embedded inside the malware,T1027
the download and launch of a suspicious batch file.,T1105
the actor introduced a downloader to fetch and spawn the next stage payload,T1105
the malicious document connects to the remote server and downloads the payload,T1105
install additional malware,T1105
They then returned 18 hours later to install further malware,T1105
when the malicious Word document opens it fetches the next payload from the remote server:,T1105
it fetched an additional script payload,T1105
a different method of fetching and executing the next stage payload,T1105
"a file downloaded from the internet,",T1105
fetch the next stage payload.,T1105
If the fetched data by cURL command,T1105
Fetch the payload with cURL command,T1105
fetching the next stage payload,T1105
fetching a remote payload,T1105
fetches a payload from the embedded URL and loads it.,T1105
launch of a suspicious batch file.,T1059.003
Windows Batch script,T1059.003
the operator executed several Windows commands,T1059.003
cmd.exe /c,T1059.003
cmd /c,T1059.003
cmd /c,T1059.003
batch file,T1059.003
The batch file name,T1059.003
the scriptlet of the batch file,T1059.003
"cmd.exe"" /c",T1059.003
"cmd.exe"" /c",T1059.003
Windows Batch file,T1059.003
This script is for executing the PowerShell script via a Windows scheduled task,T1053.005
Windows displays a warning message when the user tries to open a file downloaded from the internet.,T1204.002
strategy to persuade the victim to execute the malicious shortcut file,T1204.002
executed when the victim double-clicked on the shortcut file,T1204.002
the executable ieinstal.exe was used to bypass UAC.,T1548.002
one victim in the UAE was attacked using a malicious Word document,T1566.001
to gather basic system information.,T1082
rundll32.exe,T1218.011
spawns it with the rundll32.exe command with the payload URL,T1218.011
Embedded files of ISO image,T1027
an encrypted Dump.bin file,T1027
downloader contains an encrypted configuration at the end of the file.,T1027
the supplied encrypted decoy document.,T1027
an encrypted decoy document,T1027
The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.,T1027
decodes 0x3E8 bytes with that key,T1140
The decrypted data,T1140
loads the decrypted DLL file,T1140
The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.,T1140
the malware decrypts the payload with a delivered 64-byte RC4 key.,T1140
the decrypted payload,T1140
"checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender",T1518.001
"If TrendMicro, BitDefender, or Windows Defender products are installed",T1518.001
If Windows Defender or Bitdefender Antivirus is installed on the victim’s computer,T1518.001
depending on the antivirus installed.,T1518.001
the malware can disable the functionalities of EDR/AV products.,T1562.001
injects the fetched payload into the explorer.exe process,T1055
The Blockchain.pdf file is a malicious HTML application file,T1027
This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address,T1027
"The campaigns used a variety of email attachments such as Microsoft OneNote attachments and somewhat rare to see .URL attachments,",T1566.001
This campaign began with thread hijacked emails which contained HTML attachments.,T1566.001
"The HTML attachments used HTML Smuggling to drop a password protected, zipped Windows Script File (WSF).",T1027
to download and execute an intermediate script which then downloaded and executed the Standard IcedID Loader using a non-standard export “init”.,T1105
used to download and execute an IcedID loader.,T1105
opened it would initiate the download of a batch (.bat) file.,T1105
The batch file would download and execute,T1105
"When opened, the OneNote document instructed the recipient to ""open"" the document by double-clicking the button displayed in the OneNote document.",T1204.002
"file was concealed beneath the ""open"" text which, if clicked, executed the HTA file.",T1204.002
containing the encrypted bot and DLL loader.,T1027
download of a batch (.bat) file.,T1059.003
The batch file would download and execute,T1059.003
"that contained various bat files,",T1059.003
execute an IcedID loader with rundll32,T1218.011
loader with rundll32,T1218.011
Config decryption within IcedID Lite Loader.,T1140
Decryption of the URI within,T1140
The domain is decrypted from the configuration and the URI path is decrypted within the function,T1140
Decryption is the same across both,T1140
This pattern of decrypting strings,T1140
the Forked Loader decrypts and copies strings into global variables where they will be later used to resolve required functions.,T1140
Decryption of the config buffer in the Forked Loader.,T1140
With the config decrypted,T1140
"The response gets decrypted with the IcedID decryption routine,",T1140
Contains code to decrypt strings and domains,T1140
String decryption of the DLL names,T1140
"With the DLL strings decrypted, the malware then decrypts the loader configuration by taking the first 64 bytes and XORing it against the next 64 bytes.",T1140
The first four bytes of the decrypted buffer will contain the project identifier,T1140
This function decrypts strings,T1140
decrypts the DLL strings to be used later to resolve handles to the DLLs needed,T1140
The strings are decrypted in the same algorithm where the data is split into DWORDs and XOR’d against a random key.,T1140
String decryption for the DLL names needed for execution.,T1140
"Decryption of “Lite Loader”"" domains.",T1140
a function is called that decrypts strings that,T1140
there are two domains that are decrypted:,T1140
"With the domain names decrypted, the DLL Loader decrypts 10 strings that should be URIs to be appended to the domains.",T1140
Decryption of “Lite Loader” filenames.,T1140
After the strings are decrypted,T1140
Base64 decoding this value,T1140
following base64 decoded header,T1140
showing the decrypted botpack structure.,T1140
that makes the HTTP request.,T1071.001
sends an HTTP request that will contain the encrypted bot response.,T1071.001
contain the host information,T1082
The Base-64 encoded segment,T1027
may also deliver a weaponized Office document that executes the ReconShark reconnaissance malware.,T1566.001
to distribute password-protected weaponized Office documents,T1566.001
Office documents weaponized,T1566.001
hardware information.,T1082
to use this tool for remote management of its infrastructure.,T1219
"webshells, mostly obfuscated,",T1027
the hacker also changes the content of the file RedirSuiteServiceProxy.aspx to webshell content.,T1036.005
RedirSuiteServiceProxy.aspx is a legitimate file name available in the Exchange server.,T1036.005
"the attacker downloads files,",T1105
drops suspicious files on the attacked servers,T1105
"collecting information on the system,",T1005
“cmd” /c,T1059.003
"""cmd"" /c",T1059.003
the standard Windows command line tool cmd.exe.,T1059.003
Delete file or folder,T1070.004
"the hacker also injects malicious DLLs into the memory,",T1055
the DLL was injected into the memory of the svchost.exe process,T1055
executes these files through WMIC.,T1047
", the above files no longer exist on the compromised system, possibly due to the hacker’s evidence deletion.",T1027
Decrypt the request received using AES algorithm,T1140
"After decoding,",T1140
creates a listener that listens for connections to port 443 at the path https://*:,T1071.001
This method is responsible for collecting system information,T1082
"Information such as operating system architecture, framework version, operating system version, etc.",T1082
listing directory and file information in the format D|-|<Date created> |<Date modified> |<folder or file name>,T1083
reading files,T1083
Sending and receiving data with C2 using the RC4 encryption algorithm where the key will be generated at runtime.,T1573.001
delivered via phishing email as an attachment,T1566.001
The archives often include a JavaScript (.js) file,T1027
likely exploited known vulnerabilities in unpatched applications for initial access,T1190
gains access to the targets through remote exploitation of an unpatched internet-facing device.,T1190
"to perform initial intrusion leveraging exposed vulnerable applications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in",T1190
"Installing legitimate remote access tools, such as RPort, Ligolo and eHorus",T1219
common native Windows tools and commands such as netstat,T1016
Windows Management Instrumentation (WMI) to launch commands on devices,T1047
Remote scheduled tasks to launch their customized PowerShell backdoor,T1053.005
to register a scheduled task used to launch the ransomware payload.,T1053.005
The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.,T1078
GPO was leveraged again to register a scheduled task used to launch the ransomware payload.,T1484.001
first interfered with security tools using Group Policy Objects (GPO).,T1484.001
the threat actors leveraged highly privileged credentials and access to domain controllers,T1078
The threat actors used the compromised administrator account,T1078
the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.,T1078
"the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.",T1078
"The first account was the compromised Azure AD Connector account,",T1078
the threat actors were observed using compromised credentials to access the Azure AD Connect device.,T1078
authentication from a known attacker IP address into the Azure AD Connector cloud account.,T1078
the threat actors executed multiple actions in the cloud using two privileged accounts.,T1078
The Azure AD Connector account and the compromised administrator account were then used to perform,T1078
a successful sign-in to the Microsoft Azure environment was observed.,T1078
The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.,T1078
the threat actors leveraged RDP for access into the account.,T1021.001
"the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.",T1021.001
"Those files will still get executed, if the user clicks on run",T1204.002
As LSASS dumps are nowadays recognized by the dump file itself,T1003.001
LSASS dump in c:\tmp detected and deleted,T1003.001
LSASS dump in the WebDAV detected,T1003.001
"done via the GetAsyncKeyState API,",T1106
this is done via the popen API,T1106
uses Windows API functions to execute files,T1106
"This is done via the GetAsyncKeyState API, with keystrokes being logged",T1056.001
"keylogging are enabled by default,",T1056.001
logs keystrokes for windows with titles containing substrings specified in its configuration,T1056.001
Window titles to keylog,T1056.001
can log keystrokes.,T1056.001
"Screenshots and keylogging are enabled by default,",T1113
can capture screenshots,T1113
"the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphin’s startup",T1547.001
"The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\<random_run_name>\”%appdata%\Python27({32|64})\pythonw.exe” “<loader_step_1>” “<loader_encrypted_step_2>”",T1547.001
uses Run keys for persistence of its loader,T1547.001
can execute she will commands,T1059.003
creates directory listings,T1083
The command to get specific files,T1083
It creates directory listings,T1083
to get files from drives,T1083
it searches the drives of compromised systems for interesting files,T1083
can obtain file and directory listings.,T1083
"The following file extensions of interest, specific to media, documents, emails, and certificates,",T1005
can collect files from local drives.,T1005
Username,T1033
obtains the victim’s username.,T1033
Computer name,T1082
RAM size and usage,T1082
OS version,T1082
"obtains various system information including OS version, computer name and RAM size.",T1082
List of installed security products,T1518.001
obtains a list of installed security software.,T1518.001
Local and external IP address,T1016
obtains the device’s local and external IP address.,T1016
XOR-decrypts an embedded PE file,T1140
"XOR-decrypts further shellcode carried within itself,",T1140
"XOR-decrypts its contents,",T1140
a decrypted configuration,T1140
injects it into the created process,T1055
in a specified separate process that is created and injected.,T1055
and inject processes.,T1055
it creates a one-time scheduled task.,T1053.005
uses a temporary scheduled task to start after installation.,T1053.005
"After execution, the output of commands is uploaded.",T1041
exfiltrates data to Google Drive storage,T1041
it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.,T1041
exfiltrates data to Google Drive.,T1041
"The shellcode is stored in the registry,",T1112
sending an HTTP POST request,T1071.001
uses HTTPS to communicate with Google Drive.,T1071.001
staging the data in encrypted ZIP archives before upload.,T1074.001
stages collected data in a directory before exfiltration,T1074.001
"The content is encrypted using AES CBC with random 16-byte keys and IVs,",T1027
Most strings in this version are base64 encoded.,T1027
The base64-encoded strings were plaintext again in this version.,T1027
has encrypted components.,T1027
"another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader.",T1055
"which is vulnerable to a DLL side-loading vulnerability, and loads a file",T1574.002
"sideloading different DLL names, and multiple binary files names being loaded by those DLLs.",T1574.002
the executables and sideloaded files,T1574.002
Side-loaded DLL name,T1574.002
a threat actor abusing a sideloading vulnerability,T1574.002
Name of the malicious side-loaded DLL,T1574.002
Name of the executable vulnerable to side loading,T1574.002
seemingly legitimate executables and their respective sideloaded files,T1574.002
encoded shellcode,T1027
Creates a memory section with the DES-encrypted malware configuration,T1027
to obfuscate their malware.,T1027
used VMProtect to obfuscate one of them.,T1027
that decompresses and loads the first stage in memory.,T1140
shellcode decompressing and loading,T1140
there was only one stage being decrypted in memory,T1140
the malware decrypts the saved passwords,T1140
and then decrypts them,T1140
and then decrypts the content,T1140
calls Stage 1 again via process hollowing with four parameters,T1055
It then runs Stage 2 via process hollowing.,T1055
creates a registry key,T1112
a service that launches the moved executable rc.exe with one parameter.,T1569.002
Screenshot grab,T1113
Drive information retrieval,T1083
browses a directory,T1083
Process manager (browses and terminates processes),T1057
Current process ID,T1057
"deletes,",T1070.004
"uploads, downloads a file",T1105
Command execution,T1059.003
by calling the GetNetworkParams API function,T1106
Collected machine information includes the following: Randomly generated GUID Hostname,T1082
Processor architecture,T1082
Operating system version,T1082
Username,T1033
Local IP address and port used to send the network packet,T1016
The configuration is encrypted with a hardcoded DES key and is a few bytes long,T1573.001
the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.,T1573.001
"information is sent to the C&C, encrypted with a hardcoded key and DES CBC algorithm:",T1573.001
the malware retrieves information on the infected machine and sends it to the C&C,T1041
"Then, the malware retrieves information on the compromised computer and sends it to the C&C.",T1041
used as a lure to entice the victim into opening the malicious file.,T1204.002
"to extract the URL, login, and password fields from the file",T1552.001
Name of the hardcoded directory where files are copied,T1074.001
The malware also established persistence on the host with the creation of a registry run key.,T1547.001
persistence was achieved by creating a ‘Run’ key,T1547.001
These files were transferred to the domain controller over SMB.,T1570
dumped lsass memory on the domain controller.,T1003.001
We observed a process created by Cobalt Strike accessing lsass.exe,T1003.001
is a known indicator of such tools as Mimikatz,T1003.001
most likely using credentials gathered by the previous LSASS access.,T1003.001
then proceeded to access lsass memory on the host to extract credentials.,T1003.001
the threat actor became active by initiating a proxied RDP connection via the Cobalt Strike beacon to the domain controller.,T1021.001
after completing RDP connections to various hosts on the network,T1021.001
which were started via their interactive RDP session,T1021.001
RDP was also used by the threat actor,T1021.001
The threat actor was able to RDP to a backup server,T1021.001
running processes were reviewed,T1057
the threat actors checked running processes on the accessed hosts via taskmanager,T1057
"checking on running tasks,",T1057
the folder included a legitimate copy of rundll32.exe,T1218.011
rundll32.exe binary downloaded approximately 0.4 MB of data.,T1218.011
using a renamed copy of rundll32.,T1218.011
Batch script to run,T1059.003
file would execute a batch script,T1059.003
"""C:\Windows\syswow64\cmd.exe"" /C",T1059.003
An instance of cmd.exe was launched through explorer.exe which ran the following command,T1059.003
cmd.exe session,T1059.003
The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\Windows\system32\cmd.exe /C adcomp.bat which contained the PowerShell command:,T1059.003
"Once the user had mounted the ISO and the LNK file was executed by the user, the complex execution flow started.",T1204.002
The names of the registry values changed,T1112
The last registry key was used to store additional PowerShell code.,T1112
"This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc",T1106
the threat actor injected into various processes,T1055
reg.exe query,T1012
started a BITS job to download a Cobalt Strike beacon,T1105
whoami,T1016
whoami /groups,T1016
ipconfig /all,T1016
threat actor first ran some initial discovery on the host using built-in Windows utilities like ipconfig,T1016
systeminfo,T1082
systeminfo,T1082
WMI was used to pivot to a domain controller on the network.,T1047
The actor leveraged Impacket’s wmiexec.py to execute commands with a semi-interactive she will,T1047
interacts with remote endpoints via WMI,T1047
a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.,T1047
the ‘Powershell.exe’ process initiated the WMI requests.,T1047
One of the observed commands invoked via WMI was ‘firefox.exe’.,T1047
"The commands executed included directory traversal,",T1083
Tool Used to Steal Sensitive Information,T1005
proxying the traffic,T1090
initiating a proxied,T1090
Several HTTP Post events were observed to the identified domains,T1071.001
HTTP stream containing the content,T1071.001
The POST event included a MIME part indicating file upload,T1071.001
The file that was uploaded 775E.bin was deleted by the injected ‘Explorer.exe’ process from the target endpoint,T1027
The threat actor was able to RDP to a backup server using the admin credentials they acquired.,T1078
"This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode",T1055
shellcode stored in Base64.,T1027
a 200+MB padded file,T1027
padding the contents with benign data,T1027
"It included a standalone file padded with over 200MB of blank spaces, likely to impede analysis of the decompressed ISO file.",T1027
executes a CMD file,T1059.003
The CMD file contains commands,T1059.003
which use certutil (renamed here as slaughterhouse.exe) to decode,T1140
The decoded DLL,T1140
thus requires two rounds of decoding using certutil.,T1140
chaining together a series of scripts to decode,T1140
The victim double clicks the ISO to mount it,T1204.002
"Victims can be lured into clicking executable content including binaries, scripts or shortcut files masquerading as benign filetypes such as PDFs or folders.",T1204.002
DLL is then executed using rundll32,T1218.011
and injects Qakbot into wermgr.exe.,T1055
"This file is base64 twice,",T1027
or unpack the final payload,T1027
"modifies registry keys to maintain persistence,",T1112
Modifies the Windows registry,T1112
modifies the Windows Registry to allow remote desktop connections,T1112
establishes persistence through the creation of two keys in CurrentVersion\Run.,T1547.001
Creates registry key for persistence only,T1547.001
Creates two registry keys for persistence,T1547.001
Keys found in CurrentVersion\Run contain references to programs that will execute when a user logs in.,T1547.001
operators install and execute remote access tools such as Splashtop on targeted systems.,T1219
remote monitoring and management (RMM) software,T1219
operators use Splashtop to transfer malicious tools from computer to computer in the victim’s environment.,T1570
It copies other malicious batch and EXE files from a compromised internal Server Message Block (SMB) server to the newly created temp folder,T1570
operators utilize RDP to move laterally in the victim’s environment.,T1021.001
Modifies the Windows registry to allow remote desktop connections.,T1021.001
operators open up an Remote Desktop Protocol (RDP) port,T1021.001
operators use Mimikatz to dump passwords.,T1003.001
operators use Mimikatz to dump passwords from LSASS.,T1003.001
"Mimikatz, which is a tool used for extracting sensitive information such as passwords and authentication credentials from a Windows operating system.",T1003.001
"Mimikatz being leveraged maliciously by threat actors in the following ways: Credential Loading Mimikatz loads credentials from various sources such as Windows memory, Local Security Authority Subsystem Service (LSASS) process",T1003.001
"Mimikatz allows the user to manipulate the dumped credentials,",T1003.001
"is a small, UPX-packed password protected binary",T1027
This version of Mimikatz has been compressed using UPX,T1027
"While UPX is often legitimately used to reduce file size, we have observed threat actors utilizing UPX and other packing programs to evade static detection of the underlying payload.",T1027
operators use UPX to pack DC2.exe and DC4.exe to avoid static signature detection.,T1027
the batch file makes the following changes to the system,T1059.003
executes an embedded batch file.,T1059.003
is a batch script,T1059.003
is a batch script that creates a new user,T1059.003
"creates a batch script that,",T1059.003
creates a batch script,T1059.003
Disables the User Account Control (UAC),T1548.002
Attempting to use sc stop and taskkill to stop over 100 services related to various areas ranging from remote desktop tools to Windows Defender,T1562.001
"The HTML code in this file contains embedded JavaScript functionality,",T1027
cleanup script used to remove evidence of the attack on a system,T1027
cleanup scripts from other threat actors are usually smaller and more specific to the tools used by that actor.,T1027
adds an additional layer of obfuscation to the code,T1027
password-protected executables to obfuscate malware,T1027
"operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks",T1070.004
hid the installer for Advanced Port Scanner within Inno Setup installer to evade static signature detection.,T1027
employs a forged document linked to G7 to target various governments within the G20 forum.,T1566.001
spam email comprising an attached MS Office document,T1566.001
employ the remote template injection method to retrieve the next stage of the malware from the TA’s Command-and-Control (C&C) server.,T1055
download of a new payload from the attacker’s remote server,T1105
download a backdoor module.,T1105
downloads and executes a malicious backdoor,T1105
enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word’s Equation Editor,T1027
"drops an embedded payload, which is a DLL file",T1027
includes both an encrypted payload and shellcode,T1027
encrypts the collected information using RC4 encryption with the key “xkYgv127” and encodes it using base64.,T1027
proceeds to decrypt,T1140
"scheduled task entry,",T1053.005
executes the export function “StartA” from the DLL,T1106
using rundll32.exe,T1218.011
utilizing the “rundll32.exe” command,T1218.011
loader is executed through rundll32.exe,T1218.011
"hostname, operating system name, OS version, username,",T1082
"Gather computer-specific information such as computer name, username, gateway address, network adapter details, Windows version, and user type",T1082
"Internet information,",T1016
Retrieve TCP/UDP tables,T1016
the presence of any installed anti-virus software on the machine.,T1518.001
encrypted data is then exfiltrated using the below C&C URL,T1041
encrypted data is then exfiltrated using the below C&C URL,T1573.001
C&C server responds with the next stage executable,T1573.001
loader establishes a connection with a C&C server in the final stage of the attack.,T1573.001
Capture screenshots of victims’ system,T1113
Obtain information about processes and services running on the machine,T1057
Retrieve information about registry keys,T1012
using the remote process execution tool PSExec to execute batch files,T1059.003
Copy down batch scriptsExecute batch scripts,T1059.003
defaultChanges the Windows She Will from Explorer to their malicious script,T1059.003
"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat""",T1059.003
"executes the she will (file2.bat),",T1059.003
tries to start its defined she will which has been swapped to a batch script (file2.bat) by the malicious actor.,T1059.003
Command line flags may be used to change this behavior and invoke one or more of the modules.,T1059.003
that would cause registry changes,T1112
"reg.exe: reg add ""HKLM\System\CurrentControlSet\Control\Terminal Server"" /v ""fDenyTSConnections"" /t REG_DWORD /d 0 /",T1112
Sets various registry values,T1112
to enable Remote Desktop sessions (RDP) using reg.exe.,T1021.001
the malicious actor retrieved system administration tools and malicious payloads by using the Background Intelligent Transfer Service,T1105
Storing the ransomware within a 7zip encrypted archive,T1027
"encrypted archive containing the ransomware,",T1027
a decompression utility to extract the ransomware,T1140
"drop the defenses of the victim, inhibit monitoring, disable networking",T1562.001
"stops specific defensive services (Windows Defender, etc)",T1562.001
Will also skip enumeration and stopping of antivirus software.-,T1562.001
to authenticate to the site behind the onion link on the TOR network,T1090
ShellExecuteA is also used to launch,T1106
API call attempts to processes:,T1106
The local module utilizes the LookupPrivilegeValueW and AdjustTokenPrivileges that Windows API calls on its own process via GetCurrentProcess and OpenProcessToken to obtain SeDebugPrivilege privileges.,T1106
using Active Directory group policies allows the malicious actor to hit all systems in the environment for as long as that group policy is active in the victim’s environment.,T1484.001
Potential Process Hollowing,T1055
more sophisticated encryption,T1027
this technique for encryption-decryption is easily more discernable during analysis because both the encrypted data and the mapping are in the same file,T1027
for its execution technique of hiding malicious code inside log files.,T1027
The bytes of the encrypted section is a specific index on the byte map,T1027
"Though this is a very rigid method of hiding its codes,",T1027
uses byte remapping to ensure that the shellcode cannot be easily decrypted without the correct byte map,T1027
usually the encrypted payload,T1027
shows that their offsets within the encrypted region remain the same since they result in a similar shellcode even if they are composed of different bytes per binary.,T1027
"The malware checks if there are monitoring tools, specifically Process Monitor, running in the current machine with the following strings: procmon procmon64 procmon64a",T1518.001
"checks for a few installed and active antivirus products, namely: Windows Defender ESET",T1518.001
the malware proceeds to decrypt the PowerShell code,T1140
"Furthermore, since the data to be decrypted is in another file, the routine becomes even more difficult to investigate, as analysts would need the correct pair for decryption.",T1140
"Afterward, the shellcode will then decrypt and load the main ViperSoftX DLL embedded within the carrier.",T1140
"Moreover, all the strings, binaries, and other relevant data within the ViperSoftX DLL also gets decrypted the same way.",T1140
The actual bytes of the decrypted shellcode,T1140
to crawl through different paths in the system,T1083
scans for these cryptocurrency wallets in local directories: Armory Atomic Wallet Binance Bitcoin Blockstream Green Coinomi Delta Electrum Exodus Guarda Jaxx Liberty Ledger Live Trezor Bridge,T1083
the use of DLL sideloading for its arrival and execution technique.,T1574.002
found in the sideloaded DLL.,T1574.002
"the sideloaded DLL),",T1574.002
DLL sideloading,T1574.002
While other cybercriminals use sideloading to load another non-binary component,T1574.002
"We have also found that each sideloader DLL has its own pair of executable and byte map,",T1574.002
It still downloads a PowerShell code,T1105
or Windows Scripting,T1059.003
File-packed Magniber ransomware,T1027
"To obtain the credentials, the team took a snapshot of lsass.exe",T1003.001
"with a tool called nanodump, exported the output, and processed the output offline with Mimikatz.",T1003.001
"The team obtained the cached credentials from a SharePoint server account by taking a snapshot of lsass.exe with a tool called nanodump, exporting the output and processing the output offline with Mimikatz.",T1003.001
They then used forged credentials to move to multiple hosts across different sites in the environment and eventually gained root access to all workstations connected to the organization’s mobile device management (MDM) server.,T1078
The team used this root access to move laterally to SBS-connected workstations.,T1078
team attempted to determine valid accounts based on group name and purpose,T1078
The team attempted to leverage these credentials,T1078
"From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).",T1078
"with a button, which, when clicked, downloaded a “malicious” ISO file",T1204.002
"After the download, another button appeared, which, when clicked, executed the file.",T1204.002
Users downloaded and executed the team’s initial access payloads after clicking buttons to trigger download and execution.,T1204.002
they used compromised workstation and domain admin accounts,T1078
Use a previously compromised workstation admin account,T1078
Use a previously compromised domain admin account,T1078
the team leveraged compromised workstation and domain admin accounts to execute a payload,T1078
the team compromised a domain admin account and used it to laterally to multiple workstations and the DC.,T1078
they used compromised workstation and domain admin accounts to upload a payload via SMB on several target Workstations and the DC.,T1570
Use a previously compromised workstation admin account to upload and execute a payload via SMB,T1570
Use a previously compromised domain admin account to upload and execute a payload via SMB,T1570
The team’s C2 redirectors used HTTPS reverse proxies to redirect C2 traffic.,T1071.001
The team used HTTPS,T1071.001
the HTTPS beacon,T1071.001
post-exploit tool that leverages HTTP protocols for C2 traffic.,T1071.001
used HTTPS reverse proxies to redirect C2 traffic,T1071.001
"Establish a session that originates from a target Workstation system directly to an external host over a clear text protocol, such as HTTP.",T1071.001
"Establish a session that originates from a target Domain Controller system directly to an external host over a clear text protocol, such as HTTP.",T1071.001
used HTTPS reverse proxies to redirect C2 traffic.,T1090
the team uploaded and executed well-known malicious files,T1105
to download and execute a payload,T1105
"Upload and execute a well-known (e.g., with a signature) malicious file to a target DC system",T1105
used redirectors to redirect C2 traffic between the target organization’s network and the team’s C2 servers.,T1090
used HTTPS reverse proxies to redirect C2 traffic between target network and the team’s Cobalt Strike servers.,T1090
The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team’s Cobalt Strike servers,T1090
The redirectors used HTTPS reverse proxies to redirect C2 traffic between the target organization’s network and the Cobalt Strike team servers,T1090
The team used domain fronting to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating.,T1090
The team used domain fronting [T1090.004] to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating,T1090
"This technique, which also leverages CDNs, allows the beacon to appear to connect to third-party domains, such as nytimes.com, when it is actually connecting to the team’s redirect server",T1090
This technique leverages CDNs associated with high-reputation domains so that the malicious traffic appears to be directed towards a reputation domain but is actually redirected to the red team-controlled Cobalt Strike servers.,T1090
"In some instances, they used Windows Management Instrumentation (WMI) Event Subscriptions",T1047
The team used WMI Event Subscriptions to move laterally between sites.,T1047
command-line tool,T1059.003
which stored credentials in a database file.,T1552.001
"searched files on the server, and found plaintext credentials",T1552.001
the plaintext credentials in PowerShell scripts,T1552.001
the team found a .txt file containing plaintext credentials for the user,T1552.001
The team found plaintext credentials to an API user account stored in PowerShell scripts on an MDM server.,T1552.001
"Using the pattern discovered in these credentials, the team was able to crack the user’s workstation account password",T1110
The team cracked a user’s workstation account password after learning the user’s patterns from plaintext credentials.,T1110
Detect and Identify source IP,T1016
Detect and Identify source IP,T1016
Detect and identify source IP,T1016
Detect and identify source IP,T1016
Detect and identify source IP,T1016
Windows Service Creation,T1543.003
Windows Service Creation,T1543.003
Windows Service Creation,T1543.003
"execute a payload via SMB and Windows Service Creation, respectively, on several target Workstations.",T1569.002
"execute a payload via SMB and Windows Service Creation, respectively, on a target DC.",T1569.002
execute a payload via Windows Service Creation on target workstations and the DC.,T1569.002
The krbtgt account is a domain default account,T1078
Use of non-secure default configurations,T1078
The organization used default configurations for hosts with Windows Server 2012 R2.,T1078
The default configuration allows unprivileged users to query group membership of local administrator groups,T1078
The red team used and identified several standard user accounts with administrative access from a Windows Server 2012 R2 SharePoint server.,T1078
The team discovered several standard user accounts that have local administrator access to critical servers.,T1078
This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain.,T1078
"If a user with administrative access is compromised, an actor can access servers without needing to elevate privileges",T1078
Some workstations allowed unprivileged accounts to have local administrator access,T1078
keylogged a user during a mandatory password change,T1056.001
spear phishing attachments.,T1566.001
spear phishing attachments for Initial Access,T1566.001
As attackers can quickly change spear phishing attachments,T1566.001
suspicious email attachments or other phishing techniques.,T1566.001
modification of Registry Keys/Startup folder for persistence,T1547.001
Using valid accounts,T1078
valid accounts,T1078
"and protocols, such as for Remote Desktop Protocol",T1021.001
used to download files…,T1105
"The second stage payload, which was later determined to likely be the penetration testing framework ""Brute Ratel,"" was then downloaded via a connection",T1105
“RClone” was downloaded on the file servers,T1105
which allowed the threat actor to move freely between domains.,T1078
"Two "".bat"" files were sent throughout the organization.",T1059.003
"before running the "".cmd"" file contained within the ISO.",T1059.003
"this CMD file calls the ""db"" file. In both samples,",T1059.003
""".bat"" files",T1059.003
"USING "".BAT"" FILES",T1059.003
"The two "".bat"" files that were sent",T1059.003
"""cc.bat"" is a simple script",T1059.003
"""w.bat"" as viewed through the bash command ""cat"":",T1059.003
"these are the same commands as observed in the "".bat"" files:",T1059.003
Both were designed to turn off antivirus and anti-malware software.,T1562.001
""".bat"" files designed to disable Cisco AMP / Microsoft Defender",T1562.001
"the command ""net stop Cisco AMP"".",T1562.001
showing the “uninstall” commands for Windows Defender:,T1562.001
"DISABLING ANTIVIRUS/MALWARE SOFTWARE USING "".BAT"" FILES",T1562.001
were both designed to turn off Antivirus and Antimalware software.,T1562.001
designed to stop Cisco AMP.,T1562.001
Stopping Cisco AMP / Disabling Microsoft Defender,T1562.001
"From the two phishing emails, both attachments contain similar malware.",T1566.001
The phishing attachment was submitted to the target in a response to an ongoing conversation,T1566.001
"When downloaded, the initial attachment is a local HTML file.",T1027
were able to be decrypted by leveraging the decryption script,T1053.005
adds itself to a scheduled task.,T1053.005
The emulated C2 Server is now running an HTTPS server,T1071.001
shows that this connection was likely HTTPS,T1071.001
the communication is consistent with HTTP/S traffic.,T1071.001
on TCP port 2222.,T1095
most of the connection attempts to the C2 IP’s are conducted over TCP port 443.,T1095
"Due to TCP port 2222’s common use as an alternate port for SSH communication, the Malware Analyst recorded a manual SSH connection to the emulated C2 host",T1095
some data exfiltration or interaction with the downloaded second stage from the C2.,T1041
show the transfer of files using SMB.,T1570
Files commonly observed transferred via SMB include,T1570
Showing the Transfer of Cobalt Strike Beacons using RDPClip:,T1570
allows for lateral movement leveraging RPC to create SMB traffic.,T1570
indicating the use of Remote Desktop Protocol.[,T1021.001
Showing the Transfer of Cobalt Strike Beacons using RDPClip:,T1021.001
the use of RDP by the Threat Actor,T1021.001
The second encoded Base64 string was not only base64 but also Gziped for size and obfuscation.,T1027
has some simple but clever obfuscation in place.,T1027
This shows the decoded and uncompressed data.,T1140
payload decoder from Github,T1140
used to decode the body,T1140
"Task manager was then use to reveal the service running on PID 3488,",T1057
requests using RC4 encryption,T1573.001
was abused by the attacker to steal client data.,T1005
"the malware copied itself to ""$CURRENTUSER\AppData\Roaming\Microsoft\Isoaahffo\djkuuhd.dll,"" as confirmed by the file's hashes shown below, and sets itself to auto run.",T1547.001
"the process imbedded itself into wermgr.exe, the Windows Error Reporting Manager (Process ID 6660).",T1055
"This uses a mixture of disguising the ASCII as UTF-16 via manipulating the start of the file, as well as obfuscating the data using a simple cypher.",T1027
running the malware sets itself up as the service,T1543.003
"after reaching the local DC, the attacker was able to gain a better lay of the land and observe the presence of the other two domains.",T1078
a technique leveraging the Windows Management Instrumentation (WMI) service to execute malicious code.,T1047
indicating that the user deleted the collected data.,T1070.004
group utilizes sideloading,T1574.002
DLL for sideloading,T1574.002
The group uses DLL sideloading,T1574.002
detect and remove Alibaba Cloud Security from compromised instances,T1518.001
relied on their victims to execute the malicious MSI installers,T1204.002
uses cmd.exe to download files from Alibaba Cloud Object Storage Service.,T1059.003
executes OSSUTIL (included in the installer package as ssu.exe) to download files,T1059.003
use API calls such as VirtualAlloc to load and execute malicious components into memory,T1106
invokes the Windows API function DisableThreadLibraryCalls,T1106
create scheduled tasks to achieve persistence,T1053.005
Create scheduled tasks to execute the loader and updater components,T1053.005
"scheduled tasks created for the updater,",T1053.005
four scheduled tasks are created:,T1053.005
creates a registry Run key to achieve persistence,T1547.001
use various encryption algorithms to hide payloads and strings.,T1027
execute an encrypted payload located in the embedded DLL,T1027
"contains an XOR-encrypted payload, divided into three files",T1027
"encrypted with a different, single byte XOR key",T1027
use dynamic API resolution to avoid detection.,T1027
calling an export function of the DLL,T1027
"reconstructs the imports table of the DLL and calls the DllEntryPoint,",T1027
"the DLL will find the address of an export function called SVP7, which contains the entry point of the malware,",T1027
used DLL side-loading to execute their malicious payloads,T1574.002
"side-loading a malicious DLL, libpng13.dll",T1574.002
"by side-loading dr.dll, used by a legitimate, signed binary",T1574.002
", side-loaded by the same legitimate executable",T1574.002
contains shellcode and an embedded DLL file that loads FatalRAT,T1027
contains an embedded DLL,T1027
execute an encrypted payload located in the embedded DLL,T1027
has keylogger functionalities,T1056.001
Capture keystrokes,T1056.001
encrypts data with a custom encryption algorithm before it is sent to the C&C server.,T1573.001
uses TCP for C&C communications.,T1095
exfiltrates data over the same channel used for C&C,T1041
Drop a file named ossutilconfig in the %USERPROFILE% directory,T1036.005
Drop and execute the legitimate installer in C:\Program Files\Common Files (see CommonFiles64Folder).,T1036.005
"by side-loading dr.dll, used by a legitimate, signed binary",T1036.005
The original libpng13.dll is also included in the installer package (renamed to what appears to be a random name) because the malicious DLL forwards its exported functions to the original DLL.,T1055
download files from an attacker-controlled bucket in Alibaba Cloud,T1105
download and execute further shellcode,T1105
obfuscated the loader with many calls to a function that just prints some hardcoded values,T1027
"decrypt,",T1140
decrypts the payload is the same as the function used in FatalRAT to decrypt its configuration,T1140
decrypt its configuration strings,T1140
the decompiled code used to decrypt strings,T1027
Decompiled code of a function used by a FatalRAT,T1027
using a variety of software packers,T1027
one Zip contained a benign file named screenshot1242.jpeg and another contained a file named privatecopy.pdf.,T1027
"When someone tries to double-click these decoy files, Windows (or the application mapped to the relevant filetype) throws an error because the file is not the type of file it appears to be",T1027
"The target would then, naturally, double click the other file in the Zip archive",T1204.002
"command pulls down a Visual Basic script, drops it into the C:\Windows\Tasks folder, and executes it.",T1105
90 other encrypted,T1027
A heavily obfuscated VBS,T1027
"The initial infector is a Visual Basic script, heavily obfuscated",T1027
"A block of base64-encoded, encrypted data comprises almost 150KB of that script,",T1027
segments of base64 data,T1027
along with code that decodes and decrypts the block of base64.,T1140
"When decoded, the content of the Ir8 variable (a segment of which is shown below) turns out to be just another encoded PowerShell script, which the VBS decodes and then executes.",T1140
The PowerShell script decoded from the Ir8 variable uses Reflection.,T1140
performs a BXOR to decode the bytes,T1140
for the Ir8 script to decode.,T1140
These work in tandem to insert data into the Windows Registry,T1112
"The concatenated segments of base64 data from O7 get inserted into the Registry,",T1112
to load the final payload into memory from a Registry value without,T1112
It created a Run key in the Registry,T1547.001
And that Run key references a different Registry key,T1547.001
"On one machine, we found that the malware injected itself, using process hollowing, into ielowutil.exe",T1055
obfuscated with legitimate resources,T1027
encrypted stack strings,T1027
Embedded Resource,T1027
shellcode from the .data section,T1027
shellcode that was stored in the .data section is now stored in the .rsc section,T1027
advapi32.CryptHashData,T1106
will create a key using advapi32.CryptDeriveKey,T1106
advapi32.CryptEncrypt,T1106
"kernel32.LoadLibraryA, kernel32.GetProcAddress, kernel32.VirtualAlloc, kernel32.VirtualProtect and ntdll.ZwFlushInstructionCache",T1106
kernel32.VirtualALloc,T1106
"kernel32.VirtualProtect,",T1106
kernel32.GetLastError,T1106
kernel32.CreateMutexA,T1106
"wininet.HttpSendRequestA,",T1106
shellcode injection,T1055
copy each PE section one at a time,T1055
"creating another PE in memory,",T1055
injecting a PE executable,T1055
handle to the current process for the purpose of allocating memory with PAGE_EXECUTE_READWRITE permissions,T1055
decrypt the shellcode,T1140
decyrpt its C2 configuration,T1140
get a pointer to the encrypted shellcode and to decrypt it have been broken out into their own separate functions,T1140
will need to resolve these APIs dynamically to interact with the Windows operating system,T1027
resolving many different Windows APIs using kernel32.GetProcAddress,T1027
enumerating the Process Environment Block (PEB),T1057
HTTP HEAD request,T1071.001
check if it is connected to the internet by making a request,T1071.001
will make a HTTP GET request,T1071.001
will make a POST request,T1078
NBTScan for network reconnaissance,T1016
System Network Connections Discovery,T1016
PsExec for lateral movement,T1569.002
obtained credentials for pivoting with Mimikatz,T1078
detect memory dumps of the lsass process,T1003.001
OS Credential Dumping: LSASS Memory,T1003.001
had been archived,T1027
encrypted copy,T1027
encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64.,T1027
uploaded.,T1041
Exfiltration Over C2 Channel,T1041
to run bruteforcing offline.,T1110
SysUpdate and HyperBro backdoors were installed,T1105
"push Polar ransomware to computers and run it,",T1105
Three files are sent to the victim's computer:,T1105
obtained the credentials of a domain administration at headquarters,T1078
account of the compromised domain admin,T1078
Valid Accounts: Domain Accounts,T1078
"is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run",T1036.005
XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.,T1140
decoded with Base64,T1140
decrypts a third component,T1140
decrypted and decoded version,T1140
Deobfuscate/Decode Files or Information,T1140
payload and intermediate library are deleted before completion,T1070.004
deletes the intermediate DLL library and encrypted ransomware,T1070.004
del,T1070.004
del,T1070.004
yielding a PE file that is loaded and run in memory with .NET.,T1027
wmic,T1047
Windows Management Instrumentation,T1047
wmic,T1059.003
"""cmd.exe",T1059.003
Command and Scripting Interpreter: Windows Command She Will,T1059.003
looks for,T1057
list of connected disks and starts recursive traversal of directories,T1083
sends an HTTP POST request with the name of the victim's computer to a server,T1071.001
T1071 Application Layer Protocol: Web Protocols,T1071.001
SCHTASKS /Create,T1053.005
schtasks /run,T1053.005
Scheduled Task/Job: Scheduled Task,T1053.005
Scheduled Task/Job: Scheduled Task,T1053.005
Exploit Public-Facing Application,T1190
Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,T1547.001
Valid Accounts: Default Accounts,T1078
System Information Discovery,T1082
Lateral Tool Transfer,T1570
Data from Local System,T1005
Encrypted Channel: Symmetric Cryptography,T1573.001
Unpacked file names,T1027
obfuscation of the GuLoader shellcode and payloads,T1027
to download additional malicious files,T1105
subsequently download Remcos on the target system,T1105
:taking full control of the infected machinerecording keystrokes in real time with,T1056.001
The second shellcode revealed after the unpacking algorithm finished processing,T1027
this executable is an archive that can be unpacked with the help of 7zip,T1027
"Once we unpack the file, we can see several elements, as well as directories typical for NSIS:",T1027
It is unpacked,T1027
This packer has been around for many years,T1027
Then the functions are used to load and decrypt the payload.,T1140
The decryption function is custom,T1140
custom decryption algorithm is being applied on the buffer,T1140
The algorithm used for the buffer decryption differs across the samples.,T1140
This shellcode is used for decrypting,T1140
the key that will be used for the decryption is prepared.,T1140
After the PE is decrypted,T1140
we can see decryption of the next stage with the help of a custom algorithm,T1140
It contains a very similar function dedicated to decrypting and loading the final payload,T1140
"Both of them are encrypted,",T1027
loading the final payload (PE file) from the third of the encrypted files.,T1027
The authors used several common techniques to obfuscate this process.,T1027
passing the path to the encrypted component as a parameter.,T1027
obfuscating malicious elements.,T1027
"As before, they are resolved by their hashes.",T1027
"Then, a function defined by its hash is retrieved (using the same hashing algorithm that was used to retrieve imports from normally loaded DLLs):",T1027
"By extracting the syscalls, and executing them manually, the malware can use the API of the operating system, without a need of calling functions from the DLL.",T1027
functions has been resolved by their hashes.,T1027
The hashing function used for import resolving,T1027
"By extracting the syscalls, and executing them manually, the malware can use the API of the operating system,",T1106
"using low level APIs: NtCreateSection, NtMapViewOfSection",T1106
"Functions are always the same – dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.",T1106
The function GetTempPathW is used,T1106
"The low-level functions, directly related with performing the injection, are called via raw syscalls",T1106
PE injection,T1055
The payload is implanted into a newly created suspended process (a new instance of the current executable) using one of the most popular techniques of PE injection: Process Hollowing,T1055
"a second, encrypted component, which carries the payload.",T1027
a check against blacklisted processes.,T1057
distributing phishing emails containing malicious files,T1566.001
it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack,T1105
a malicious template file is downloaded and executed,T1105
to trigger the retrieval of the final stage payload,T1105
This enables the document to fetch the .dotm file from the remote server required for further actions,T1105
Upon opening the malicious document,T1204.002
an obfuscated VBA macro,T1027
“cmd /c,T1059.003
"the Windows Registry or NTFS Extended Attributes to hide their data,",T1112
hide a second stage payload in registry transaction files,T1112
"perform a number of changes on the filesystem or registry,",T1112
to store and retrieve binary data with the Windows API.,T1106
It provides applications with API functions—available,T1106
accessible through API functions.,T1106
opened with the CreateLogFile() API,T1106
using the clfsw32.dll API function,T1106
This function is patched using Microsoft Detours—a publicly available library used for instrumenting Win32 functions—so,T1106
resolves the function address for the ServiceMain export function,T1106
via the API CreateFileTransactedA(),T1106
via the API NtCreateSection(),T1106
Malware Obfuscation,T1027
most of the strings used by PRIVATELOG and STASHLOG are obfuscated,T1027
each string is therefore encrypted with a unique byte stream.,T1027
relies on XOR’ing each byte with a hard-coded,T1027
the control flow obfuscation.,T1027
"In addition to containing obfuscated strings, the installer’s code is protected using various control flow obfuscation techniques that make static analysis cumbersome",T1027
the installer generates and prints out encryption keys that the actor uses to pre-encrypt the payload before it is written to disk,T1027
"Following the payload header, the malware expects blocks of encrypted data with 8-byte headers.",T1027
Each block is then re-encrypted with the new key material as follows: The encryption key is the 16-byte GUID,T1027
"The encryption algorithm is HC-128,",T1027
Sample string deobfuscation,T1140
some of the deobfuscated strings from the installer are used for logging error messages and,T1140
the installer opens and decrypts the contents of the file passed as an argument,T1140
decrypted file contents,T1140
the decrypted data matches the payload,T1140
the malware decrypts each block using HC-128,T1140
the payload which will be decrypted.,T1140
its contents are decrypted using the HC-128 encryption algorithm,T1140
The decryption key and IV are generated using the same unique host properties,T1140
only decrypts the first matching block,T1140
the decrypted payload contents,T1140
it searches for .blf files in the default user’s profile directory,T1083
starts by enumerating *.blf files in the default user’s profile directory,T1083
malware also checks that the operating system version,T1082
The injection process,T1055
"For example, to open a registry key in a transaction, the functions RegCreateKeyTransacted(), RegOpenKeyTransacted(), and RegDeleteKeyTransacted() are available.",T1012
The GUID returned from the registry value,T1012
Mimikatz to steal credentials from host memory.,T1003.001
Mimikatz,T1003.001
Uses Mimikatz to harvest credentials.,T1003.001
decrypts them locally.,T1140
"Once decrypted,",T1140
begins to decrypt and parse its embedded configuration,T1140
decrypting the rest of the blob once it has been decoded.,T1140
Once the REvil configuration has decrypted,T1140
Decrypted REvil configuration,T1140
decrypted Ransom Cartel configuration,T1140
"they are written to the registry,",T1112
"it is written to the registry key SOFTWARE\\Google_Authenticator\\b52dKMhj,",T1112
Once the data has been written to the registry,T1112
stored within the registry,T1112
Modifies the Registry to disable UAC remote restrictions by setting SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy to 1.,T1112
"first checks to see if the registry already contains previously generated values; if so, it will read those values into memory.",T1012
the command line provided to the ransomware is parsed.,T1059.003
cmd.exe,T1059.003
Uses cmd.exe to execute commands.,T1059.003
to disable UAC remote restrictions by setting SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy to 1.,T1562.001
Adds registry run keys to achieve persistence.,T1547.001
to download and install payloads,T1105
to retrieve the malicious payload and download additional resources,T1105
Downloads and uploads files to and from the victim’s machine.,T1105
the tool downloads the files,T1105
"Uses legitimate VPN, RDP, Citrix or VNC credentials to maintain access to an environment.",T1078
to enable offline password cracking.,T1110
Uses Rundll32 to load and execute malicious DLL.,T1218.011
the ransomware will proceed to spawn another instance of itself via rundll32.exe,T1218.011
"Deletes some of its files used during operations as part of cleanup, including removing applications such as 7z.exe, tor.exe, ssh.exe",T1070.004
Uses encoded PowerShell commands.,T1027
utilizing string encryption,T1027
encrypted configuration,T1027
"a base64-encoded ransom note,",T1027
"The configuration is stored as a base64-encoded blob, whereby the first 16 bytes of the base64-encoded blob is the RC4 key",T1027
opts to obfuscate their ransomware much more heavily,T1027
Searches for specific files prior to encryption.,T1083
"seeks out files with the following file extensions: .log, .vmdk, .vmem, .vswp and .vmsn.",T1083
Target specific file path,T1083
to search machines for certain files,T1083
Uses AnyDesk to remotely connect and transfer files.,T1219
used this as a remote access tool to establish an interactive command and control channel,T1219
Routes traffic over TOR and VPN servers to obfuscate their activities.,T1090
TOR sites redirecting to a new ransomware operation,T1090
API hashing,T1027
the username,T1033
"computer name, domain name, locale and product name.",T1082
leads to a function that iterates over a call,T1106
"executes the batch file,",T1059.003
a batch script used,T1059.003
batch files,T1059.003
"A new batch file, localdisk.bat, was also executed",T1059.003
These discovery actions were completed several times again in other various batch files.,T1059.003
it was executed using a command line argument,T1059.003
a batch file.,T1059.003
the execution of the batch file,T1059.003
The batch file eyewear.bat then executed two commands,T1059.003
C:\Windows\system32\cmd.exe /c,T1059.003
C:\Windows\system32\cmd.exe /c,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe,T1059.003
enter this directly in the host OS command she will.,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
cmd.exe /C,T1059.003
invoked from the command line,T1059.003
Another batch file,T1059.003
leveraged by a batch file,T1059.003
C:\Windows\System32\cmd.exe /C,T1059.003
using the command line,T1059.003
the threat actors dropped several batch scripts on the server:,T1059.003
the batch file,T1059.003
cmd.exe /c,T1059.003
cmd.exe /c,T1059.003
cmd.exe /c,T1059.003
cmd.exe /c,T1059.003
a batch file,T1059.003
The threat actor installed Atera and Splashtop remote access software,T1219
They then repeated the install of the remote access software package.,T1219
the threat actor installed RSAT (Remote Server Administration Tools) on the beachhead host,T1219
AnyDesk was used to move laterally between a workstation and a backup server,T1219
three different Remote Access Software were used by the threat actor,T1219
the threat actor used three different tools in order to establish an interactive and persistent command and control channel.,T1219
the installation of the remote management tools,T1219
began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it,T1570
"the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.",T1570
"they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec",T1570
proceeded to dump LSASS memory,T1003.001
ProcDump was used to dump LSASS memory.,T1003.001
"several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable",T1003.001
There were several variants of Mimikatz in binary and PowerShell form,T1003.001
"C:\Windows\system32\cmd.exe /C mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords""",T1003.001
C:\Windows\system32\cmd.exe /C mimikatz.exe privilege::debug sekurlsa::logonPasswords full samdump,T1003.001
Multiple injections into the LSASS process were observed on multiple hosts.,T1003.001
LSASS process to access credentials.,T1003.001
Process dump of the LSASS process,T1003.001
the lsass.exe beacon,T1003.001
c:\windows\temp\procdump64.exe -accepteula -ma lsass.exe,T1003.001
Several more beacons were also loaded on the host using DLLs and PowerShell.,T1105
the threat actor moved on to downloading a variety of beacon executables,T1105
"to execute various dropped tools or beacons on the endpoint,",T1105
files that where downloaded from those sites:,T1105
file downloads relating to tooling/scripts.,T1105
The threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure,T1105
Lots of custom scripts dropped by threat actors,T1105
Other tools and scripts were dropped onto one endpoint,T1105
the threat actors often opened Internet Explorer to download their beacons,T1105
The threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion,T1105
the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems,T1078
"They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.",T1047
"additional beacons executed using remote WMIC commands,",T1047
executed using remote WMI commands,T1047
The use of WMIC was leveraged by a batch file,T1047
wmic /node,T1047
Threat actors used the lolbin wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers,T1047
WmiPrvSe.exe (WMI Provider Host) executed the PowerShell Cobalt Strike beacon on the remote computers.,T1047
the threat actors proceeded to RDP to the domain controller.,T1021.001
starting the RDP session,T1021.001
run from their interactive RDP session,T1021.001
used to proxy RDP connections and connect to another computer.,T1021.001
"The use of RDP was extensively used throughout the intrusion, using a variety of processes",T1021.001
establishing RDP connections,T1021.001
"During these RDP sessions,",T1021.001
This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon:,T1021.001
RDP traffic and minimize external RDP access,T1021.001
RDP traffic,T1021.001
They then opened an RDP connection back to the primary domain controller,T1021.001
the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host,T1562.001
Windows Defender tampering,T1562.001
powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI,T1562.001
reviewed Group Policy Objects for the domain.,T1484.001
"the user clicked on the ISO file, which created a new virtual hard drive disk",T1204.002
"when the victim clicked on the LNK file, it triggered the execution of the batch file",T1204.002
Clicking on the LNK file executes the batch file,T1204.002
The ISO file was delivered as a ZIP archive via a malicious spam mail campaign.,T1566.001
DLL was executed using rundll32.exe : C:\Windows\system32\cmd.exe /c D:\max\eyewear.bat ➝ rundll32,T1218.011
This process was invoked by RunDLL32.exe,T1218.011
malware running via Rundll32,T1218.011
file was executed by the injected Rundll32.exe process.,T1218.011
a single Rundll32.exe process,T1218.011
"rundll32 locker_32.dll,run",T1218.011
loads it using rundll32,T1218.011
The decoded PowerShell function,T1140
Decoded from Base64:,T1140
A scheduled task was then created using this same DLL.,T1053.005
A scheduled task was created at that time to maintain persistence on this host,T1053.005
GetSystem creates a service,T1543.003
used to inject a new beacon or a specific program to another process on the victim’s computer.,T1055
The injection is also visible from memory dumps,T1055
Several hosts showed rundll32 processes exhibiting common process injection behavior,T1055
Code injection in LSASS,T1055
an injected Cobalt Strike beacon,T1055
the injected Rundll32.exe process.,T1055
The common processes observed were two injected processes,T1055
a beacon injected into a single Rundll32.exe process,T1055
to discover information relating to the user,T1033
"host,",T1082
cmd.exe /C hostname,T1082
systeminfo,T1082
systeminfo,T1082
queried a number of target hosts to determine the host disk drive configuration,T1082
"This can be useful to determine drives, including mounted network shares.",T1082
"logicaldisk get caption,description,drivetype,providername,volumename",T1082
network configuration,T1016
ipconfig /all,T1016
ipconfig,T1016
C:\Windows\system32\cmd.exe /C dir /s *file/,T1083
threat actors used the dir command,T1083
C:\Windows\System32\cmd.exe /C dir,T1083
This was double base64 encoded.,T1027
PowerShell Base64 encoded string: The -e is short for -EncodedCommand.,T1027
The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $,T1027
PowerShell encoded commands:,T1027
powershell -np -w hidden -encodedcommand,T1027
used to proxy,T1090
"Proxying RDP traffic via a processes such as a Cobalt Strike beacon reduces the exposure of the threat actor’s own infrastructure, and blends RDP activity to those of internal hosts on the network.",T1090
the threat actors made attempts to proxy RDP traffic,T1090
the RDP traffic was being proxied through,T1090
attempted to masquerade dropped files as legitimate Microsoft Windows executables,T1036.005
Once the file was unpacked,T1027
the documents were exfiltrated over one of the encrypted C2 channels.,T1041
"When the payload was executed, there were some telltale registry events observed",T1112
files were then deleted,T1070.004
packed versions uploaded to VT,T1027
pack the code’s dependencies into the .NET assembly so it can run self-contained.,T1027
compression using QuickLZ,T1027
"with names invoking popular videogames such as Fortnite, Valorant, Roblox or Warzone2.",T1036.005
create a legitimate looking folder to drop an illicit version of the System Configuration Utility msconfig.exe,T1036.005
"creates the folder “C:Windows System32”, with a space after Windows",T1036.005
packaged into an obfuscated PowerShell batch file,T1027
heavily obfuscated batch file is hidden and automatically executed when launched.,T1027
script extracts two separate binaries from the base64 encoded text,T1027
another obfuscated binary carrying an embedded resource,T1027
extraction of the resources leads to the final payloads,T1027
Option to embed additional malware to be executed,T1027
the rootkit’s DLL that is embedded as a resource,T1027
fileless and executed only in memory after going through several decryptions and decompression routines,T1140
"AES decrypts, and GZIP decompresses it to produce two separate byte arrays",T1140
will be decompressed and decrypted,T1140
decompress and decrypt the final payload,T1140
Hooks several functions from ntdll.dll to hide its presence.,T1055
leveraging Windows Management Instrumentation (WMI) to identify the system’s manufacturer.,T1047
identify the system’s manufacturer,T1082
"delivered to the victim, commonly through a phishing mail",T1566.001
receives a ZIP file containing a benign file in plain sight,T1566.001
automatically executed when launched.,T1204.002
bat file format,T1059.003
spawned with PowerShell via Task Scheduler,T1059.003
using PowerShell.,T1059.003
base64 encoded text later in the file,T1027
more obfuscation and encryption techniques that lead to the final payload.,T1027
stored as obfuscated data in the registry,T1027
"prefix is used to hide files, directories, NamedPipes, scheduled tasks, processes, registry keys/values, and services.",T1027
writes it as encrypted data.,T1027
deletes it as soon as the utility is running,T1070.004
stored as obfuscated data in the registry,T1112
Creating a registry key to store the malware code,T1112
saves its configuration as a registry key.,T1112
spawned with PowerShell via Task Scheduler,T1053.005
Creating a scheduled task to execute the malware using PowerShell.,T1053.005
injected into the winlogon.exe process.,T1055
injected into other processes.,T1055
injects itself and additional malware(s) into all processes,T1055
be injected into the winlogon.exe process,T1055
carries out process injections,T1055
"loads a fresh copy of ntdll.dll,",T1055
loading a fresh copy of “ntdll.dll” from disk to avoid process hollowing detection,T1055
executed via dllhost.exe using process hollowing techniques.,T1055
injects the rootkit when new processes are created,T1055
Injects the rootkit to a newly created process by another process and updates the callee via NamedPipe,T1055
executes an executable using process hollowing,T1055
Enumerates all running processes,T1057
executes a file using ShellExecute,T1106
utilizes the same Common Name in their TLS certificate.,T1071.001
secure communication through TLS encryption.,T1071.001
"support for TCP network streams (both IPv4 and IPv6),",T1095
Controlling attached camera devices to take pictures of the compromised computer’s surroundings.,T1113
takes screenshots at regular intervals.,T1113
can periodically take screenshots and store them with information about the foreground process and time since the last user input,T1113
"To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture are not saved.",T1113
similar screen captures,T1113
"uses a custom network protocol, which can function over HTTP",T1071.001
we can see one more HTTP request,T1071.001
HTTP POST request used for FlowCloud C&C communication,T1071.001
can send and receive data over HTTP.,T1071.001
communicates with a hardcoded IP address via HTTP.,T1071.001
can communicate over HTTP or via its “normal protocol”.,T1071.001
"The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP",T1071.001
The fields required for HTTP,T1071.001
used for HTTP client requests,T1071.001
used for HTTP server responses,T1071.001
HTTP by prepending the data with a hardcoded,T1071.001
"or raw TCP, for C&C server communications.",T1095
can communicate over raw TCP sockets.,T1095
normal protocol uses raw TCP sockets and a custom message format,T1095
which can check running processes,T1057
which can check running processes against a hardcoded list,T1057
backdoors can list running processes.,T1057
"functionalities that collect information about programs and processes,",T1057
Other commands can be used to retrieve a detailed list of available services and currently running processes.,T1057
It checks running processes,T1057
the running processes using CreateToolhelp32Snapshot and Process32Next,T1057
the PID of the process in which the orchestrator is running.,T1057
"we found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products",T1518.001
"can check whether specific security software is installed on the machine it tries to compromise,",T1518.001
"there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVERAGE, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.",T1518.001
It checks running processes for executables of several known cybersecurity vendors.,T1518.001
contain a section defining specific security software to check for,T1518.001
"include the ability to collect mouse movements, keyboard activity",T1056.001
records keystrokes.,T1056.001
backdoor’s components records mouse and keyboard activity to a database.,T1056.001
with the keylogger component of the driver (described in the next section) by reading data from the \\.\pipe\namedpipe_keymousespy_english named pipe.,T1056.001
it acts as both a keylogger,T1056.001
Read (IRP_MJ_READ) for the keyboard driver (kbdclass or KeyboardClass0),T1056.001
"handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.",T1056.001
Keylogging,T1056.001
by compromising a web-facing application such as Microsoft Exchange or SharePoint,T1190
"exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604",T1190
The public-facing application compromise approach,T1190
has exploited web server vulnerabilities for initial access.,T1190
"Initial access to targets is obtained by exploiting vulnerable internet-facing applications such as Microsoft Exchange,",T1190
These were either dropped directly via the webshell or downloaded from a remote server,T1105
The following files are downloaded and written to disk:,T1105
"The communications module then downloads the main backdoor module,",T1105
This downloader simply downloads the loader,T1105
Encoded Royal Road payload,T1027
this encrypted file is,T1027
The identical encrypted file,T1027
deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis,T1027
"The values for these executables and configuration data can be found, encrypted, in the loader’s resource section.",T1027
"most resources are written to disk encrypted,",T1027
"In some cases, they are then re-encrypted but with a different key",T1027
same sequence of opcodes to obfuscate the program’s flow,T1027
control flow obfuscation snippet,T1027
files are distributed and stored in encrypted form.,T1027
Base64-encoded strings,T1027
new encrypted shellcode,T1027
This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC,T1027
and encrypted QuasarRAT payload,T1027
control flow obfuscation to hinder analysis,T1027
the document triggers the injection of a custom downloader – a PE executable – into an iexplore.exe process.,T1055
that decrypts hardcoded shellcode,T1140
Shellcode decryption loop,T1140
and only decrypted in memory when needed.,T1140
the loader decrypts and parses the embedded installation configuration,T1140
the rootkit module is decrypted,T1140
"the self-decrypting DLL,",T1140
[sic] section of a decoded FlowCloud config,T1140
It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme,T1140
Once it has decrypted the embedded DLL,T1140
Self-decrypting DLL,T1140
The loaded shellcode is a self-decrypting DLL.,T1140
DLL decryption routine,T1140
and only decoded as needed.,T1140
a thread that decrypts and loads the fcClient module,T1140
The decrypted shellcode,T1140
decrypt the embedded module,T1140
into the shellcode that will decompress and load the Korplug payload.,T1140
It decrypts and loads,T1140
decrypted before being written,T1140
and injects it into iexplore.exe using WriteProcessMemory.,T1055
"The next stage, injected into iexplore.exe",T1055
The injected code loads the same backdoor (rescure.dat) into the process’s memory and calls its startModule export to finish the installation.,T1055
the injection process,T1055
perform process injection to masquerade as harmless processes.,T1055
"The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.",T1055
The loader injects an orchestrator into memory in a svchost.exe process.,T1055
the orchestrator injects the network component into memory,T1055
the process into which the shellcode will be injected,T1055
"and inject shellcode,",T1055
Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run.,T1547.001
the task or service attains persistence by being set to start automatically on boot,T1547.001
It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.,T1547.001
"uses filenames that are either similar to those of legitimate Windows files (e.g., rebare.dll which could be mistaken for rebar.dll) or innocuous looking (e.g., AC146142) to avoid suspicion.",T1036.005
named after legitimate utilities are written into the %ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\ subdirectory.,T1036.005
This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.,T1036.005
registry key where each embedded resource is to be written,T1112
by writing to specific registry keys.,T1112
Network shellcode registry keys,T1112
stored in the Windows registry.,T1112
shows the three registry keys used,T1112
creating the files and registry keys,T1112
2001Path to the registry key for the PrintProcessor service,T1112
The paths and registry keys to use,T1112
it can create a service,T1543.003
service is then created,T1543.003
can be configured to create a service for persistence.,T1543.003
it can create a service or scheduled task.,T1053.005
persistence is established by using the ITaskService COM interface to create the \Microsoft\Windows\CertificateServicesClient\NetTask scheduled task,T1053.005
This task will run the DLL hijacking target as SYSTEM at each boot.,T1053.005
uses COM interfaces to schedule tasks,T1053.005
creates a scheduled task for persistence.,T1053.005
service was configured to execute the next step of the installation process by running a legitimate application,T1569.002
service is then created to run that module and is immediately started,T1569.002
target for DLL side-loading,T1574.002
DLL side-loading,T1574.002
the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL,T1574.002
"the new process loads the decoy DLL and manually replaces its content in memory with the fcClientDll module (a process known as module stomping or DLL hollowing),",T1574.002
uses DLL Side-Loading to launch its second-stage dropper.,T1574.002
"If a task with the same name already exists, it is deleted before the new one is created",T1027
"After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.",T1027
Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.,T1027
removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.,T1027
The file is then deleted from the disk,T1070.004
deletes its rootkit’s executable after launching it.,T1070.004
then starts a suspended process to perform injection on it.,T1055
stores collected data in local SQLite databases prior to exfiltration.,T1074.001
"Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server",T1074.001
uses local caches to stage data,T1074.001
data can be collected locally by the corresponding class before it is staged for exfiltration.,T1074.001
can exfiltrate files from local file systems.,T1005
The corresponding files are collected,T1005
Monitoring file system events to collect new and modified files.,T1005
can search through connected file systems and obtain directory listings.,T1083
walks through all mapped file systems and collects files,T1083
collects file and directory metadata,T1083
uses malicious RTF and DOCX attachments to compromise victims.,T1566.001
sending spearphishing emails with malicious attachments such as RTF documents created via the Royal Road builder,T1566.001
makes extensive use of the Windows API to execute commands and launch processes.,T1106
performs the functions of LoadLibrary and calls the loaded module’s startModule export.,T1106
used for function imports (via GetProcAddress),T1106
perform WMI queries,T1047
uses WMI for lateral movement and information gathering.,T1047
runs WMI queries every second to get all process creation and termination events.,T1047
lateral movement scripts such as WMIExec.,T1047
use locally configured proxies.,T1090
"can use XOR, TEA, RC4 and a modified AES algorithm to encrypt traffic and files.",T1573.001
It is encrypted using the AES algorithm,T1573.001
The application and the accompanying relevant and malicious DLL were both embedded in the loader’s resources.,T1027
the embedded DLL,T1027
the embedded DLL,T1027
It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources,T1027
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4,T1027
the function used to encrypt and decrypt the embedded module,T1027
"Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.",T1082
This is sent to the server along with the computer’s name,T1082
This includes bidirectional file transfers between the C&C and the compromised machine.,T1041
This configuration corresponds to resource 1000 in the initial loader. It defines the address and port for both the exfiltration server (file_server) and the C&C server,T1041
a given command line.,T1059.003
"is protected with DNGuard, a commercial .NET packer.",T1027
uses both regular and reflective DLL injection.,T1055
"proxy/tunneling utilities (HTran, LCX, EarthWorm",T1090
read from a file on disk or a registry key.,T1012
components use registry keys to signal each other.,T1012
it collects usernames,T1033
usernames,T1033
directory listings,T1083
directory listings were harvested as a result.,T1083
hostnames,T1082
machine names,T1082
execution using scheduled tasks,T1053.005
downloaded and run by the plaintext PY files from external infrastructure.,T1105
it download and execute yet another Python script,T1105
Code responsible for downloading cron_script file,T1105
keylogging functionality.,T1056.001
malware hidden inside the Python compiled byte code,T1027
malicious code is embedded in code,T1027
unpacking,T1027
Obfuscation is one of the most popular methods to achieve this.,T1027
JavaScript obfuscation was used,T1027
use of various obfuscation techniques in malware,T1027
the most popular obfuscation techniques is execution of Base64-encoded malicious code,T1027
use of W4SP crew obfuscation tools such as Hyperion and Kramer,T1027
be embedded in the loader itself.,T1027
that stages execution of further payloads downloaded from the internet,T1105
"attempts to fetch another stage of the payload to run in memory,",T1105
"stage the execution of additional plugins in memory,",T1105
Download a file from the C2 server,T1105
reaching out to the server to obtain a further payload.,T1105
"the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices",T1106
using the WinExec API,T1106
"injecting it into an svchost.exe process,",T1055
injecting it to the address space of another process.,T1055
The injected process,T1055
an encrypted blob,T1027
the encrypted ScrambleCross shellcode,T1027
an encrypted configuration file,T1027
facilitates the functionality of WMI in Windows,T1047
when the WMI service was initiated,T1047
upon initiation of the WMI service,T1047
Usage of WMI for remote command execution,T1047
wmic /node:<,T1047
It works by decrypting a shellcode BLOB with AES-256,T1140
through the command line as,T1059.003
via a Windows batch script file,T1059.003
issuing the following command line,T1059.003
Write text to a given *.bat file and execute it,T1059.003
Run a she will command,T1059.003
examples of command lines,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
cmd /C,T1059.003
executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.,T1569.002
"reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost""",T1112
"reg add ""HKLM\SYSTEM\CurrentControlSet\Services\iscsiwmi\Parameters""",T1112
"reg add ""HKLM\SYSTEM\CurrentControlSet\Services\iscsiwmi\Parameters"" /",T1112
The second way to execute StealthMutant is through the creation of a scheduled task,T1053.005
schtasks /create /TN,T1053.005
schtasks /run,T1053.005
Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.,T1573.001
The commands retrieved from the server are also encrypted with AES-128,T1573.001
Get list of drives,T1083
Get content list from a specified directory,T1083
"cmd /C ""C: & cd \ & dir $temp\ /od""",T1083
Sending back the result of the command’s execution to the C2 server.,T1041
"cmd /C ""C: & cd \ & whoami""",T1033
"cmd /C ""C: & cd \ & tasklist""",T1057
"cmd /C ""C: & cd \ & systeminfo""",T1082
Copying of files across SMB shares,T1570
"cmd /C ""C: & cd \ & arp -a""",T1016
Removal of artefacts from the system,T1070.004
wmic /node,T1070.004
wmic /node,T1070.004
wmic /node,T1070.004
wmic /node,T1070.004
wmic /node,T1070.004
wmic /node,T1070.004
These were used to inject the payload into process memory.,T1055
Adds Run Registry Key for Persistence,T1547.001
The persistence technique is simply adding a run registry key for persistence,T1547.001
added to the startup folder,T1547.001
Screen capture,T1113
Screen Logger,T1113
Keylogging,T1056.001
Keylogger,T1056.001
Gathering system information,T1082
System Information,T1082
Encoded shellcode in Project File,T1027
"contained encoded executables and shellcode,",T1027
"LoadLibraryW, VirtualAlloc, CreateProccessW, and ZwUnmapViewOfSection.",T1106
"LoadLibraryW loads the module, VirtualAlloc allocates the memory, CreateProcessW created a process, and ZwUnmapViewOfSection is used",T1106
using the callback function pointer in CallWindowProc,T1106
The payload from the project files was a remote access tool (RAT) called Remcos.,T1219
two large arrays of decimal bytes were decoded by the function,T1140
Decoding Function,T1140
decoding function,T1140
Remote Command Line,T1059.003
Registry Editor,T1112
stealing multiple types of data,T1005
the “UsingTask” element defines the task that will be compiled by MSBuild.,T1053.005
MSBuild has an inline task feature,T1053.005
Modify and query the Windows registry,T1112
query the Windows registry,T1012
Log keystrokes,T1056.001
Bypass UAC,T1548.002
"Egress communications over HTTP, HTTPS",T1071.001
Take screenshots,T1113
Set up proxies,T1090
payloads are usually shellcode encrypted with a rolling XOR key.,T1027
Once the encoded payload has been located,T1027
the project file has an encoded and compressed payload,T1027
"The use of shellcode, encoding, compression, obfuscated strings",T1027
since each payload will be encrypted with different keys and each configuration will uniquely change the hash value.,T1027
Encrypted payloads will also obfuscate useful strings from static analysis.,T1027
using multiple stages and encrypted/obfuscated payloads,T1027
the code can be injected into other legitimate running processes,T1055
"The payload, usually shellcode, is injected into another process.",T1055
The shellcode is then executed in a new thread.,T1055
An endpoint with a system injected,T1055
process injection,T1055
and process injection,T1055
Inject malicious code into legitimate processes,T1055
is a memory-only DLL that runs as a service,T1543.003
that pulls the Cobalt Strike payload from a fake JPG file.,T1027
also leveraging steganography to locate the start of the encoded payload,T1027
It uses a different custom packer,T1027
the malware to unpack,T1027
", it extracts, decrypts, and decompresses the data to be executed as shellcode.",T1140
"This payload is decrypted, decompressed, and then copied into memory",T1140
it is decrypted and executed,T1140
decode,T1140
domain fronting,T1090
or download additional stages.,T1105
drops and executes Cobalt Strike in the memory space of “rundll32.exe.”,T1218.011
This requires either social engineering tactics to get the target to execute the malware or another program/script to execute the file.,T1204.002
"To optimize brute forcing efforts, the malware compares the server prompt upon connection to a hardcoded list of strings",T1110
These credentials used appear to be default credentials for IoT devices.,T1078
It attempts to specifically gain root access to these devices via a default password,T1078
Like the earlier SSH brute-forcing campaign,T1110
brute-forced devices,T1110
optimizing the brute forcing implementation,T1110
Code for the brute forcing implementation is significantly more structured,T1110
added to support the Telnet brute force.,T1110
Restart Telnet brute forcing,T1110
brute forcing,T1110
SSH brute forcing code with the more usual Telnet equivalent.,T1110
The Telnet brute forcing code is designed primarily for self-propagation,T1110
"SSH brute-forcing campaign,",T1110
This allows it to download and deploy,T1105
are downloaded and executed in the victim's system,T1105
downloader to the compromised device that executes and downloads the primary payload.,T1105
"then downloads its payload via software installed on the compromised device, such as ftpget, wget, curl, or tftp, before executing the payload.",T1570
It uses the cpuinfo Python module to retrieve information about the CPU.,T1082
This code checks if the disk size is greater than a specified threshold (50 GB as example).,T1082
uses the win32api.GetDiskFreeSpaceEx() function to retrieve the disk size in bytes,T1082
Reflective PE injection,T1055
Reflective PE injection is a technique used by malware or advanced attackers to inject a Portable Executable (PE) file directly into the memory of a running process without the need for writing the file to disk,T1055
reflective PE injection allows the malware to load and execute its code directly from memory,T1055
"In reflective PE injection, the PE file is parsed and its sections are reconstructed in the target process’s memory.",T1055
-ReflectivePEInjection” that facilitates reflective PE injection using PowerShell.,T1055
This module allows the injection of a PE file into a remote or local process’s memory without writing it to disk,T1055
"Once the PE file is injected and reconstructed in memory, the execution flow can be redirected to the injected code, enabling the malware to operate within the context of the compromised process.",T1055
PE reflective injection.,T1055
The PE file is downloaded on filesystem and than executed.,T1105
uses the DownloadFile method of the WebClient object to download the file from the specified URL and save it to the specified local file path.,T1105
the file to be downloaded.,T1105
script that downloads a file from a fixed location and executes it.,T1105
PowerShell one-liner that can be used to download and execute a remote .ps1 or .exe file:,T1105
"using LNK files to download malware or other malicious files by leveraging legitimate native apps, such as PowerShell.",T1105
simple stager download of an .exe file and its execution.,T1105
This line uses the ShellExecute method of the She Will.Application object to execute the downloaded file.,T1059.003
The She Will.Application object provides methods for working with the Windows she will,T1059.003
decrypt,T1140
This decryption process utilizes the Fernet algorithm,T1140
The script will download and decrypt the string that represents the token,T1140
The fernet_decrypt function decrypts an encrypted string,T1140
It returns the decrypted message as a decoded string.,T1140
"it use the harcoded password for decryption using the fernet_decrypt function, and returns the decrypted AUTH Token.",T1140
the file will be deleted,T1070.004
"access to system APIs,",T1106
It uses the win32api.GetDiskFreeSpaceEx() function,T1106
Fernet is a symmetric encryption algorithm and token format used for secure communication and data protection,T1573.001
"It utilizes symmetric key cryptography, where the same secret key is used for both encryption and decryption",T1573.001
this code comparing the local IP address with a predefined list of network addresses,T1016
obfuscation mechanisms during the compilation process.,T1027
the injected code,T1055
the local disk volumes to be encrypted are also configured in a similar manner.,T1027
"In addition to file encryption and obfuscation,",T1027
"(crawl whole tree), I:, H:, G:, F:, E:, and D:.",T1083
"malware will attempt to gather specific, sensitive information from targeted systems.",T1005
the dropper is distributed in the form of a UPX-packed DLL,T1027
"The malware then abuses the MSDTC service, manipulating the permissions and startup parameters.",T1569.002
"its abuse of the legitimate MSDTC service,",T1569.002
malicious oci.dll into the service’s executable,T1569.002
its attempts to steal credentials and browser data.,T1552.001
This includes browser session and credential data.,T1552.001
Credential and Browser Data Theft,T1552.001
"It checks that there are no running processes related to security-related software (e.g., Windbg, Autoruns, Wireshark)",T1518.001
"It checks that there are no drivers loaded from security-related software (e.g., groundling32.sys)",T1518.001
"It checks that the status of certain services belonging to security-related software meets certain conditions (e.g., windefend, sense, cavp)",T1518.001
"Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.",T1071.001
DeleteFile,T1070.004
deleting files,T1070.004
ReadRegistryValue,T1012
GetRegistrySubKeyAndValueNames,T1012
enumerate files and registry keys,T1012
The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography,T1012
DeleteRegistryValue,T1112
SetRegistryValue,T1112
manipulating of registry keys,T1112
GetProcessByDescription,T1057
enumerate processes,T1057
The command CollectSystemDescription retrieves the following information: Local Computer Domain name Administrator Account SID HostName,T1082
OS Version,T1082
The domain name of the device,T1082
Username,T1033
System Directory,T1083
"To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration",T1036.005
schtasks /create /F /tn “\Microsoft\Windows\SoftwareProtectionPlatform\EventCacheManager” /tr “C:\Windows\SoftwareDistribution\EventCacheManager.exe” /sc ONSTART /ru system /,T1053.005
C:\Windows\system32\cmd.exe /C,T1059.003
C:\Windows\system32\cmd.exe /C,T1059.003
"With Rundll32,",T1218.011
collect and upload information about the device,T1005
to report some basic information about the compromised system,T1005
the ability to log keystrokes,T1056.001
keystrokes,T1056.001
logs keystrokes,T1056.001
"capture screenshots,",T1113
“The reconnaissance data is exfiltrated to the attacker-controlled server through an HTTP POST request,T1041
the attacker-controlled server through an HTTP POST request,T1071.001
send phishing emails with malicious HTML attachments,T1566.001
operating system information,T1082
collecting system information such as hostnames,T1082
OS version information,T1082
run the payloads by sideloading them to the legitimate executables,T1574.002
insights on anti-virus software present on the machine,T1518.001
downloading and executing two other PowerShell scripts from a different attacker-controlled server,T1105
IPv4 addresses,T1016
“The banking trojan targets the victim’s sensitive information,T1005
"Once user credentials have been compromised, this tool takes “full control” of the account",T1078
"“When a victim opens the HTML file attachment, an embedded URL is launched in the victim’s browser, redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance",T1027
Identify processes,T1057
Logged Processes,T1057
"Identify processes related to backups, antivirus/anti-spyware,",T1518.001
actors have also gained initial access to victim networks by distributing phishing emails with malicious attachments,T1566.001
by exploiting the following vulnerabilities against Microsoft Exchange servers,T1190
removes virus definitions and disables all portions of Windows Defender and other common antivirus programs in the system registry,T1562.001
Microsoft Windows Defender AntiVirus Protection disabled,T1562.001
Microsoft Windows Defender AntiSpyware Protection disabled,T1562.001
remove all existing shadow copies via vssadmin on command line,T1059.003
This could cause the file to run when double-clicked instead of opening it with a PDF viewer.,T1204.002
and then downloads a second-stage backdoor from the OpenDrive cloud service.,T1105
The decryption routine shared between the BADCALL for Linux and targeted destructive malware for Windows from 2014,T1140
uses the same type of strong encryption – AES-GCM,T1027
creates a scheduled task on the system that provides persistence.,T1053.005
creates a scheduled task on the system that provides persistence.,T1053.005
creates a scheduled task on the system that provides persistence.,T1053.005
establishes persistence by creating an autostart service that allows it to run whenever the machine boots.,T1543.003
establishes persistence by creating an autostart service that allows it to run whenever the machine boots.,T1543.003
decodes the configuration data and modules.,T1140
injects into the svchost.exe process.,T1055
injects into the svchost.exe process,T1055
malicious actors spread primarily by spearphishing campaigns using tailored emails that contain malicious attachments,T1566.001
has used an email with an Excel sheet containing a malicious macro to deploy the malware.,T1566.001
compromised server that prompts the victim to click,T1204.002
"In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that",T1204.002
has attempted to get users to launch malicious documents to deliver its payload.,T1204.002
spread the malware laterally across a network by abusing the Server Message Block (SMB) Protocol.,T1570
modules spread the malware laterally across a network by abusing the SMB Protocol.,T1570
data exfiltration over a hardcoded C2 server,T1041
can send information about the compromised host to a hardcoded C2 server.,T1041
"uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow.",T1106
by capturing the CredEnumerateA API.,T1106
by capturing the CredEnumerateA API.,T1106
leveraging Microsoft’s CryptoAPI,T1106
uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.,T1027
leverages a custom packer to obfuscate its functionality.,T1027
can modify registry entries,T1112
can disable Windows Defender.,T1562.001
"can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP.",T1552.001
it searches for the .vnc.lnk affix to steal VNC credentials.,T1552.001
can obtain passwords stored in files,T1552.001
by querying the Software\SimonTatham\Putty\Sessions registry key.,T1012
"obtains the IP address, location, and other relevant network information from the victim’s machine.",T1016
can identify the user and groups the user belongs to on a compromised host.,T1033
"gathers the OS version, machine name, CPU type, amount of RAM available from the victim’s machine",T1082
"searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.",T1083
collects local files and information from the victim’s local machine.,T1005
uses HTTPS to communicate with its C2 servers,T1071.001
samples have used HTTP over ports 447 and 8082 for C2.,T1071.001
downloads several additional files and saves them to the victim's machine.,T1105
uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic.,T1573.001
